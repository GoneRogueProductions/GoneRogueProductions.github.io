(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B,q={}.hasOwnProperty,U=[].slice,A=function(t,e){for(var r in e)q.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};e=10,t="inputmemory_keys",dayjs.extend(window.dayjs_plugin_duration),dayjs.extend(window.dayjs_plugin_calendar),dayjs.extend(window.dayjs_plugin_advancedFormat),dayjs.extend(window.dayjs_plugin_relativeTime),window.I={libs:{react:$.Deferred((r=this,function(t){if("undefined"!=typeof React&&null!==React)return t.resolve(React)})),selectize:$.Deferred((n=this,function(t){var e;if("undefined"!=typeof $&&null!==$&&null!=(e=$.fn)?e.selectize:void 0)return t.resolve($.fn.selectize)})),redactor:$.Deferred((i=this,function(t){var e;if("undefined"!=typeof $&&null!==$&&null!=(e=$.fn)?e.redactor:void 0)return t.resolve($.fn.redactor)}))},setup_page:function(){var t;return I.setup_register_referrers($(document.body)),_.defer((t=this,function(){return I.setup_affiliate_code()}))},root_url:(o=null,function(t){return!o&&""!==(o=$("body").data("host")||"")&&(o=window.location.protocol+"//"+o,window.location.port&&"80"!==window.location.port&&(o+=":"+window.location.port)),o+"/"+t}),page_name:function(){return $(document.body).data("page_name")||"unknown"},sort_keys:function(t){var e,r;return r=[],(e=function(t){var n,i,o;for(n in i=[],t)q.call(t,n)&&(o=t[n],r.push(n),"object"==typeof o?i.push(e(o)):i.push(void 0));return i})(t),r.sort()},get_csrf:function(){return this._csrf_token||(this._csrf_token=$("meta[name='csrf_token']").attr("value"))},with_csrf:function(t){var e;return(null==t&&(t={}),e={csrf_token:I.get_csrf()},"string"==typeof t)?t+"&"+$.param(e):$.extend(t,e)},add_params:(s=this,function(t,e){var r;return(r=$.param(e),t.match(/\?/))?t+"&"+r:t+"?"+r}),flash:function(t,e){return null==e&&(e="notice"),this.flasher||(this.flasher=new I.Flasher),t.match(/^error:/)&&(t=t.replace(/^error:/,"Error: "),e="error"),this.flasher.show(e,t)},slugify:function(t,e){return t=t.replace(/\s+/g,"-"),(t=(null!=e?e.for_tags:void 0)?t.replace(/[^\w_.-]/g,"").replace(/^[_.-]+/,"").replace(/[_.-]+$/,""):t.replace(/[^\w_-]/g,"")).toLowerCase()},truncate:function(t,e,r){return(null==e&&(e=30),null==r&&(r="..."),t)?t.length>e+r.length?""+t.slice(0,e)+r:t:""},number_format:function(t,e,r,n){var i,o,s;return(null==r&&(r="."),null==n&&(n=","),isNaN(t)||null===t)?"":(o=(s=(t=t.toFixed(~~e)).split("."))[0],i=s[1]?r+s[1]:"",o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+n)+i)},format_bytes:(a=[["gb",1073741824],["mb",1048576],["kb",1024]],function(t){var e,r,n,i,o;for(e=0,n=a.length;e<n;e++)if(r=(o=a[e])[0],t>=(i=o[1]))return""+I.number_format(t/i)+r;return I.number_format(t)+" bytes"}),ecommerce_event:function(t){return window.ga?(ga("ecommerce:addTransaction",t.transaction),ga("ecommerce:addItem",t.item),ga("ecommerce:send")):console.log("ecommerce event:",t)},event:function(t,e,r,n,i){var o;return null==i&&(i=!0),o={hitType:"event",eventCategory:t,eventAction:e,eventLabel:r,eventValue:n},i||(o.nonInteraction=1),I.event_with_opts(o)},event_with_opts:function(t){try{if("undefined"!=typeof ga&&null!==ga)return ga("send",t);return console.log("event:",t),"function"==typeof t.hitCallback?t.hitCallback():void 0}catch(e){}},event2:function(){var t;t=1<=arguments.length?U.call(arguments,0):[]},parse_money:function(t){var e;return(e=t&&parseInt(t.replace(/[^\d]/g,""),10))||0},currency_symbols:{USD:"$",GBP:"\xa3",EUR:"€",JPY:"\xa5"},currency_formats:{USD:{prefix:"$"},GBP:{prefix:"\xa3"},JPY:{prefix:"\xa5"},EUR:{suffix:"€"}},format_money:function(t,e){var r,n;return(null==e&&(e="USD"),t<0)?"-"+I.format_money(-t,e):(n=I.currency_symbols[e]||"$","JPY"===e)?n+t:(r=I.number_format(t/100,2),"EUR"===e)?""+r+n:""+n+r},money_input:function(t,e){var r,n;return null==e&&(e={}),t=$(t),r=e.currency||t.data("currency"),n=I.currency_formats[r]||{prefix:"$"},t.maskMoney($.extend({affixesStay:!0,precision:"JPY"===r?0:2},n,e))},plural:function(t,e){return 1===e?e+" "+t:e+" "+t+"s"},default_redactor_opts:{plugins:["source","table","alignment","video","addimage"],toolbarFixed:!1,buttons:["format","bold","italic","deleted","lists","link"],minHeight:250,linkSize:80},add_recaptcha_if_necessary:function(t,e){if("recaptcha"===e[0]){if(!t.data("adding_recaptcha")){var r;t.data("adding_recaptcha",!0),I.with_recaptcha((r=this,function(){var e;return e=t.find(".g-recaptcha"),I.event("recaptcha","show",I.page_name()),grecaptcha.render(e[0],{sitekey:e.data("sitekey")})}))}return t.set_form_errors(["Please fill out the CAPTCHA to continue"]),!0}},with_recaptcha:(l=this,function(t){var e;return window.grecaptcha?t(l):l.recaptcha_deferred?l.recaptcha_deferred.done(t):(l.recaptcha_deferred=$.Deferred().done(t),window._itch_recaptcha_loaded=function(){return this.recaptcha_deferred.resolve()},e="https://www.google.com/recaptcha/api.js?onload=_itch_recaptcha_loaded&render=explicit",$('<script type="text/javascript">').attr("src",e).appendTo("head"))}),wait_for_object:(u=this,function(t,e,r){var n,i,o;return i=1,n=10,(o=function(){return t[e]?"function"==typeof r?r():void 0:(i+=n,setTimeout(o,i=Math.min(500,i)))})()}),with_redactor:(c=this,function(t){return I.wait_for_object($.fn,"redactor",t)}),with_selectize:(p=this,function(t){return I.libs.selectize.done(t)}),redactor:(h=this,function(t,e){var r,n;if(null==e&&(e={}),!window.location.href.match(/\bredactor=0\b/)){if(!$.fn.redactor){console.warn("tried to create redactor text element without redactor on page",t[0]);return}!1===(e=$.extend({},I.default_redactor_opts,e)).source&&(delete e.source,e.plugins=function(){var t,r,i,o;for(t=0,i=e.plugins,o=[],r=i.length;t<r;t++)"source"!==(n=i[t])&&o.push(n);return o}());try{return t.redactor(e)}catch(i){return r=i,I.event("error","redactor","invalid_content"),t.parent().replaceWith(t).end().val("").redactor(e)}}}),get_template:function(t){return _.template($("#"+t+"_tpl").html())},lazy_template:function(t,e){return function(){var r,n;return r=1<=arguments.length?U.call(arguments,0):[],n=I.get_template(e),t.prototype.template=n,n.apply(null,r)}},setup_sticky_bar:function(t){var e,r,n,i;return n=$(window),e=$(document.body),t=$(t),r=!1,n.on("scroll",(i=this,function(i){if(n.scrollTop()>t.offset().top+t.outerHeight()){if(!r)return e.addClass("show_sticky_bar"),r=!0}else if(r)return e.removeClass("show_sticky_bar"),r=!1}))},setup_selectize:function(t){return t.find(".selectize_input").each(function(t,e){var r,n,i,o,s,a,l;if(!(r=$(e)).hasClass("selectized"))return s={plugins:[],persist:!1},r.is("select")&&(n={},r.find("option").each(function(t,e){var r;return n[(r=$(e)).val()]=r.data("extra")}),l=function(t,e){var r,i;return r=e(t.text),(i=n[t.value])&&(r=r+" <span class='sub'>— "+i+"</span>"),"<div class='option'>"+r+"</div>"},s.render={item:l,option:l}),(a=r.data("placeholder"))&&(s.placeholder=a),r.hasClass("dropdown")&&(s.maxItems=1),(o=r.data("options"))&&(r.hasClass("options_object")?(s.options=o,s.searchField=["text","keywords"]):s.options=o.map(function(t){return{value:t[0],text:t[1]}}),s.plugins.push("remove_button"),s.delimiter=",",s.persist=!1),(i=r.data("optgroups"))&&(s.optgroups=i),r.selectize(s)})},format_duration:function(t,e,r){var n,i,o,s,a,l,u,c,p;for(null==e&&(e=null),null==r&&(r=!0),"number"==typeof t&&(t=dayjs.duration(t)),a=[],i=0,s=(u=[["y","years","a year"],["m","months","a month"],["d","days","a day"],["h","hours","an hour"],["m","minutes","a minute"],["s","seconds","a second"]]).length;i<s&&(l=u[i],!e||a.length!==e);i++)o=l[0],n=l[1],c=l[2],(p=t[n]())>0&&(p>1?"seconds"===n&&r?a.push("a few seconds"):a.push(p+" "+n):a.push(c));return a.length>1&&(a[a.length-1]="and "+a[a.length-1]),a.join(", ")},format_filesize:function(t,e){var r,n,i,o,s;for(null==e&&(e=".file_size_value"),o=t.find(e),s=[],n=0,i=o.length;n<i;n++)r=$(r=o[n]),s.push(r.html(I.format_bytes(parseInt(r.html()))));return s},adjust_font_size_to_fit:(d=this,function(t,e){var r,n,i;if(null==e&&(e=16),t.length){for(n=parseInt((n=t.css("font-size")).match(/\d+/),10),r=t[0],i=[];r.offsetWidth<r.scrollWidth&&!((n-=2)<e);)i.push(t.css("font-size",n+"px"));return i}}),date_format:"yy-mm-dd",time_format:"HH:mm:ss",format_date_time:function(t){var e,r;return r=$.datepicker.formatTime(this.time_format,{hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),(e=$.datepicker.formatDate(this.date_format,new Date(t)))+" "+r},format_date:function(t){return $.datepicker.formatDate(this.date_format,new Date(t))},datetimepicker:function(t,e){var r,n,i,o,s,a;for(r=0,n=t.length;r<n;r++)(s=(o=$(i=t[r])).attr("value"))&&o.val(this.format_date_time(I.parse_timestamp(s)));return t.datetimepicker($.extend({timeFormat:this.time_format,dateFormat:this.date_format,beforeShow:(a=this,function(){_.defer(function(){return $("#ui-datepicker-div").css("z-index",100)})})},e))},datepicker:function(t,e){var r;return t.datepicker($.extend({dateFormat:this.date_format,beforeShow:(r=this,function(){_.defer(function(){return $("#ui-datepicker-div").css("z-index",100)})})},e))},slug_input:(f=this,function(t,e){var r;if(r=/[a-z_0-9_-]/g,t.on("keypress",function(t){var e;if(t.keyCode>=32&&!(e=String.fromCharCode(t.keyCode)).match(r))return!1}),e&&e.length)return t.on("change",function(r){var n;if(n=I.slugify(e.val()),t.val().match(/^\s*$/)&&""!==n)return t.val(n)}),e.on("change",function(e){if(t.val().match(/^\s*$/))return t.val(I.slugify($(e.currentTarget).val()))})}),deferred_links:function(t,e,r){return r||(r=I.delegate_tracking),t.on("mouseup",e,function(t){var e;if(2===t.which)return r(e=$(t.currentTarget),t)}),t.on("click",e,function(t){var e,n,i,o,s,a;if(1===t.which&&(o=$(t.currentTarget),n=t.metaKey||t.ctrlKey||t.shiftKey||"_blank"===o.attr("target"),e=null,!n&&(e=(s=this,function(){if(e)return e=null,window.location=o.attr("href")}),setTimeout((a=this,function(){return"function"==typeof e?e():void 0}),200)),null!=(i=r(o,t))&&i.done(e),!n))return!1})},delegate_tracking:(m=this,function(t){var e;return e=[],t.trigger("i:delegate_tracking",[function(t){return e.push(t)}]),$.when.apply($,e)}),ga_tracker:(g=this,function(t,e,r,n){return function(i){var o,s,a,l,u,c;return o={hitType:"event",eventCategory:null!=(s=i.data("category"))?s:t,eventAction:null!=(a=i.data("action"))?a:e,eventLabel:null!=(l=i.data("label"))?l:r,eventValue:null!=(u=i.data("value"))?u:n},$.Deferred((c=this,function(t){return o.hitCallback=function(){return t.resolve()},I.event_with_opts(o)}))}}),tracked_links:function(){var t,e,r,n,i,o,s;return r=arguments[0],i=2<=arguments.length?U.call(arguments,1):[],e=i[0],t=i[1],n=i[2],s=i[3],o=I.ga_tracker(e,t,n,s),I.deferred_links(r,"a[data-label]",o),r.on("i:track_link",function(r,i){var o;return i&&(o=i[0]),I.ga_tracker(e,t,null!=o?o:n,s)($(r.target))})},set_cookie:function(t,e,r){return null==r&&(r={}),I.in_dev&&console.log("set cookie:",[t,e],r),Cookies.set(t,e,$.extend({path:"/",domain:"."+$(document.body).data("host")},r))},set_register_referrer:(v=this,function(t){var e;if(null!=(e=I.page_name())&&I.set_cookie("ref:register:page_params",e),null!=t)return I.set_cookie("ref:register:action",t)}),setup_register_referrers:(y=this,function(t){if(!I.current_user)return t.on("mouseup","[data-register_action]",function(t){var e;return e=$(t.currentTarget).data("register_action"),I.set_register_referrer(e)})}),setup_affiliate_code:(b=this,function(t,e){var r,n;if(null==e&&(e=!1),null==t&&(t=null!=(n=window.location.search.match(/\bac=([\w\d]+(?:\-[\.:_\w\d]+)?)/))?n[1]:void 0),t&&(e||t!==Cookies.get("acode")))return I.set_cookie("acode",t,{expires:1}),document.referrer&&I.set_cookie("acode:ref",document.referrer.substring(0,180),{expires:1}),r=window.location.href.replace(/\?.*$/,"").substring(0,180),I.set_cookie("acode:land",r,{expires:1})}),setup_grid_referrers:(w=this,function(t,e){var r;return r=function(t){var r,n,i,o;if(!t.closest(".game_author").length&&(r=t.closest("[data-game_id]").data("game_id"))&&I.ReferrerTracker.push("game",r,e(t)),!t.closest(".sale_author").length&&(i=(n=t.closest("[data-sale_id]")).data("sale_id")))return o=n.data("sale_type"),I.ReferrerTracker.push(o,i,e(t))},t.on("mouseup",".game_cell a, .sale_row a, .leader_game a",function(t){if(!(t.which>3))return r($(t.currentTarget))}),t.on("i:track_link",function(t){return r($(t.target))})}),bind_checkbox_to_input:(k=this,function(t,e,r){var n;return n=function(){var n;return n=t.prop("checked"),e.prop("disabled",n),"function"==typeof r?r(n):void 0},t.on("change",n),n()}),add_facebook:(x=this,function(t){var e,r,n;if(!window.FB){if(x.add_facebook=function(){},$('<div id="fb-root"></div>').appendTo(document.body),r="facebook-jssdk",!document.getElementById(r))return null!=t&&(window.fbAsyncInit=t),e=document.getElementsByTagName("script")[0],(n=document.createElement("script")).id=r,n.src="//connect.facebook.net/en_GB/sdk.js#xfbml=1&appId=537395183072744&version=v2.0",e.parentNode.insertBefore(n,e)}}),add_twitter:(C=this,function(){var t,e,r;if(e="twitter-wjs",!document.getElementById(e))return C.add_twitter=function(){},t=document.getElementsByTagName("script")[0],(r=document.createElement("script")).id="twitter-wjs",r.src="//platform.twitter.com/widgets.js",t.parentNode.insertBefore(r,t)}),add_react:function(){var t,e,r;return t=$.Deferred(),I.add_react=function(){return t},I.libs.react.done((r=this,function(){return t.resolve()})),(e=$("#lib_react_src")).replaceWith($('<script type="text/javascript">').attr("src",e.data("src"))),t},has_follow_button:(S=this,function(t,e){var r,n,i,o,s,a,l;return null==e&&(e={}),t=$(t),i=null!=(s=e.cls)?s:"follow_button_widget",r=null!=(a=e.animate_follow)?a:"animate_bounce",n=null!=(l=e.animate_unfollow)?l:"animate_drop_down",(o={})[i]=function(t){var e,i,o,s;return I.current_user?t.is(".loading")?void 0:(t.removeClass(r+" "+n),o=$.Deferred(function(t){return setTimeout(function(){return t.resolve()},500)}),s=(i=t.is(".is_following"))?(_.defer(function(){return t.addClass(n)}),t.data("unfollow_url")):(_.defer(function(){return t.addClass(r)}),t.data("follow_url")),t.addClass("loading").trigger("i:track_link",["follow_btn"]),e=t.data("follow_data")||{},$.when($.post(s,I.with_csrf(e)),o).done(function(e){var i;if(i=e[0],t.removeClass("loading "+r+" "+n),i.errors){I.flash(i.errors.join(", "));return}return t.toggleClass("is_following",i.following).trigger("i:follow_updated",[{user_id:t.data("user_id"),following:i.following,btn:t}])})):"continue"},t.dispatch("click",o),$(document.body).on("i:follow_updated",function(e,r){var n,o,s;return s=r.user_id,o=r.following,n=r.btn,t.find("."+i+"[data-user_id="+s+"]").not(n).toggleClass("is_following",o)})}),is_mobile:(z=this,function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}),is_ios:(T=this,function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}),strip_css:(N=this,function(t){return t.replace(/<\s*\/\s*style\s*>/i,"")}),request_fullscreen:(L=this,function(t,e){var r,n,i;return(r=t.requestFullscreen?(t.requestFullscreen(),!0):t.msRequestFullscreen?(t.msRequestFullscreen(),!0):t.mozRequestFullScreen?(t.mozRequestFullScreen(),!0):!!t.webkitRequestFullscreen&&(t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0))&&e&&null!=(n=window.screen)&&null!=(i=n.orientation)&&"function"==typeof i.lock&&i.lock(e),r}),is_fullscreen:(E=this,function(){return!(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement)}),exit_fullscreen:(F=this,function(){return document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():void 0}),toggle_fullscreen:(D=this,function(t,e){return I.is_fullscreen()?(I.exit_fullscreen(),!1):!!I.request_fullscreen(t,e)||"failed"}),setup_dirty_warning:(j=this,function(t,e){return e||(e=function(){return t.data("dirty")}),t.data("dirty",!1),$(window).on("beforeunload",function(){var t;if(t=e())return"string"==typeof t?t:"You've made modifications to this page."}),t.on("i:after_submit",function(){return t.data("dirty",!1)}),_.defer(function(){return t.on("change","input, select, textarea",function(e){return t.data("dirty",!0)}),t.on("keydown, mousedown",".redactor-editor",function(){return t.data("dirty",!0)})})}),remote_submit:(P=this,function(t,e,r){var n,i;return null==r&&(r={}),t.trigger("i:before_submit"),i=t.serializeArray(),n=r.loading_lock?t.addClass("loading").find("button, input[type='submit']").prop("disabled",!0).addClass("disabled"):void 0,$.when(e).then(function(e){var o;return e&&(i=i.concat(e)),$.ajax({data:i,type:null!=(o=t.attr("method"))?o:"POST",dataType:"json",url:t.attr("action"),xhrFields:{withCredentials:!0},error:function(t){var e;return(null!=(e=function(){try{return JSON.parse(t.responseText)}catch(e){}}())?e.errors:void 0)?I.flash(e.errors.join(", ")):I.flash("We seem to be having server problems right now! Please try again later.")},complete:function(){return r.loading_lock&&(n.prop("disabled",!1).removeClass("disabled"),t.removeClass("loading")),t.trigger("i:after_submit")}}).then(null,function(t){try{return JSON.parse(t.responseText)}catch(e){throw t}})})}),is_middle_click:(M=this,function(t){return 2===t.which||t.metaKey||t.ctrlKey}),escape_regex:(B=this,function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}),move:function(t,e,r){var n,i,o,s;if(-1===(i=t.indexOf(e)))throw"Failed to find object in array";if((s=i+r)<0||s>=t.length)throw"Movement is outside of array ("+s+") [0, "+(t.length-1)+"]";return(n=function(){var r,n,i;for(r=0,i=[],n=t.length;r<n;r++)(o=t[r])!==e&&i.push(o);return i}()).splice(s,0,e),n},format_integer:function(t){return t>1e7?Math.floor(t/1e6)+"m":t>=1e6?Math.floor(t/1e5)/10+"m":t>1e4?Math.floor(t/1e3)+"k":t>=1e3?Math.floor(t/100)/10+"k":""+t},coerce_timestamp:function(t){var e;return(e="string"==typeof t&&t.match(/(^\d{4}\-\d{1,2}\-\d{1,2}) (\d{1,2}:\d{1,2}:\d{1,2})$/))?e[1]+"T"+e[2]+"Z":t},parse_timestamp:function(t){return dayjs(I.coerce_timestamp(t)).toDate()},format_timestamp:function(){var t,e,r,n;switch(n=arguments[0],e=arguments[1],t=3<=arguments.length?U.call(arguments,2):[],null==e&&(e="fromNow"),n=I.coerce_timestamp(n),e){case"fromNow":return dayjs(n).fromNow();case"calendar":return dayjs(n).calendar(null,{sameElse:"MMMM Do YYYY"});case"format":return(r=dayjs(n)).format.apply(r,t);default:throw Error("unknown method for format_timestamp: "+e)}},store_memory:function(r,n){var i,o,s,a;if(window.localStorage){if((s=function(){try{return JSON.parse(localStorage.getItem(t))}catch(e){}}())||(s=[]),s[0]!==r){for(s=[r].concat(o=function(){var t,e,n;for(t=0,n=[],e=s.length;t<e;t++)r!==(i=s[t])&&n.push(i);return n}());s.length>e;)a=s.pop(),"undefined"!=typeof localStorage&&null!==localStorage&&localStorage.removeItem(a);localStorage.setItem(t,JSON.stringify(s))}return localStorage.setItem(r,n)}},clear_memory:function(e){var r,n;if(window.localStorage){(n=function(){try{return JSON.parse(localStorage.getItem(t))}catch(e){}}())&&localStorage.setItem(t,JSON.stringify(function(){var t,i,o;for(t=0,o=[],i=n.length;t<i;t++)e!==(r=n[t])&&o.push(r);return o}()));try{return localStorage.removeItem(e)}catch(i){}}}},$(function(){var t;if((t=window.location.hash.match(/\bflash=([^&]*)/))&&(I.flash(t[1]),window.location.hash=window.location.hash.replace(/\bflash=([^&]*)/,"")),I.ie)return $(document.body).addClass("ie")}),I.Flasher=function(){function t(){var t;$(document).on("click",".global_flash",(t=this,function(){return t.dismiss()}))}return t.prototype.duration=1e4,t.prototype.animation_duration=250,t.prototype.clipping="-7px",t.prototype.dismiss=function(){var t,e;if(t=this.current_flash)return this.timeout&&(clearTimeout(this.timeout),this.timeout=null),t.css({"margin-top":"-"+(t.outerHeight()+4)+"px"}),setTimeout((e=this,function(){return t.remove()}),2*this.animation_duration)},t.prototype.show=function(t,e){var r,n;return this.dismiss(),(r=$("<div class='global_flash "+t+"' role='alert' aria-live='polite'>").text(e).appendTo("body")).css({"margin-left":"-"+r.width()/2+"px","margin-top":"-"+(r.outerHeight()+4)+"px"}),this.timeout=setTimeout((n=this,function(){return r.addClass("animated"),r.css({"margin-top":n.clipping}),setTimeout(function(){return n.dismiss()},n.duration)}),100),this.current_flash=r},t}(),I.InfiniteScroll=function(){function t(t,e){this.opts=null!=e?e:{},this.el=$(t),this.setup_loading()}return t.prototype.loading_element=".grid_loader",t.prototype.get_next_page=function(){return alert("override me")},t.prototype.setup_loading=function(){var t,e,r;if(!this.opts.disable_infinite_scroll){if(this.loading_row=this.el.find(this.loading_element),this.loading_row.length)return e=$(window),t=(r=this,function(){if(!r.el.is(".loading")&&e.scrollTop()+e.height()>=r.loading_row.offset().top)return r.get_next_page()}),e.on("scroll.browse_loader",t),t()}},t.prototype.remove_loader=function(){return $(window).off("scroll.browse_loader"),this.loading_row.remove()},t}(),I.InfiniteGameGrid=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return A(e,t),e.prototype.method="post",e.prototype.current_page=1,e.prototype.get_next_page=function(){var t;return this.current_page+=1,this.el.addClass("loading"),$[this.method]("",{page:this.current_page,format:"json"},(t=this,function(e){return(t.el.removeClass("loading"),e.num_items>0)?t.grid.add_image_loading($(e.content).appendTo(t.grid.el).hide().fadeIn()):t.remove_loader()}))},e}(I.InfiniteScroll),_.templateSettings={escape:/\{\{(?![&])(.+?)\}\}/g,interpolate:/\{\{&(.+?)\}\}/g,evaluate:/<%([\s\S]+?)%>/g},$.easing.smoothstep=function(t){return t*t*t*(t*(6*t-15)+10)}}).call(this),(function(){var t;$.fn.dispatch=function(t,e){var r;return this.on(t,(r=this,function(t){var r,n,i,o;for(i in e)if(n=e[i],(r=$(t.target).closest("."+i)).length){if(r.is(".disabled"))return!1;if(r.is("a")&&t.ctrlKey||"continue"===(o=n(r,t)))return;return!1}return null})),this},$.fn.exists=function(){return this.length>0&&this},$.fn.format_timestamps=function(t){var e,r,n,i,o;for(null==t&&(t="calendar"),o=this.find(".date_format"),r=function(e){var r,n,i;return r=e.data("format"),n=e.html(),i=r?I.format_timestamp(n,"format",r):I.format_timestamp(n,t),e.html(i).attr("title",n+" UTC")},n=0,i=o.length;n<i;n++)r($(e=o[n]));return this},$.fn.has_tooltips=function(t){var e,r,n,i,o,s,a,l,u;if(null==t&&(t={}),!I.is_mobile())return o=function(){var t;return t=$('<div class="tooltip_drop"></div>'),$(document.body).append(t),o=function(){return t},t},s=_.template('<div class="tooltip">{{ label }}</div>'),i=function(e,r){var n,i,a,l,u;return(null==r&&(r=!1),(n=e.data("tooltip_el"))||(n=$(s({label:e.attr("aria-label")||e.data("tooltip")})),e.data("tooltip_el",n)),n.removeClass("visible"),o().empty().append(n),a=e.offset(),i=n.outerHeight(),l=n.outerWidth(),n.css({position:"absolute",top:t.below?a.top+e.outerHeight()+10:a.top-i-10,left:Math.floor(a.left+(e.outerWidth()-l)/2)}),n.toggleClass("below",!!t.below),r)?n.addClass("visible"):setTimeout((u=this,function(){return n.addClass("visible")}),10)},r=(a=this,function(t){var e,r;if(e=(r=$(t.currentTarget)).data("tooltip_el"),r.removeData("tooltip_el"),e&&e.is(":visible"))return i(r,!0)}),n=(l=this,function(t){var e;if(!(e=$(t.currentTarget)).closest(".redactor-box").length)return i(e)}),e=(u=this,function(t){var e,r;if(e=(r=$(t.currentTarget)).data("tooltip_el"))return e.remove()}),this.is("[data-tooltip]")?(this.on("i:refresh_tooltip",r),this.on("mouseenter focus",n),this.on("mouseleave blur i:hide_tooltip",e)):(this.on("i:refresh_tooltip","[data-tooltip], [aria-label]",r),this.on("i:clear_tooltips",function(){return o().empty()}),this.on("mouseenter focus","[data-tooltip], [aria-label]",n),this.on("mouseleave blur i:hide_tooltip","[data-tooltip], [aria-label]",e)),this},$.fn.inline_edit=function(t){var e,r,n,i,o,s,a;if(null==t&&(t={}),this.is(".inline_editing")){this.data("finished_editing")();return}return this.addClass("inline_editing"),r=$('<input type="text" class="inline_edit_input" />').attr("placeholder",this.data("placeholder")).val(("function"==typeof t.get_val?t.get_val(this):void 0)||this.text()).insertAfter(this.hide()).select(),e=(i=this,function(){return r.remove(),i.show(),$(document).off("click.inline_editing"),i.removeClass("inline_editing")}),this.data("finished_editing",e),n=(o=this,function(){return(r.prop("disabled",!0),t.set_val)?t.set_val(o,r.val(),e):(o.text(r.val()),e())}),$(document).on("click.edit_title",(s=this,function(t){if(!$(t.target).closest(".inline_edit_input").length)return n()})),r.on("keydown",(a=this,function(t){switch(t.keyCode){case 9:return _.defer(function(){return n()});case 13:return n();case 27:return e()}}))},I.support_passive_scroll=function(){var t,e,r;e=!1;try{t=Object.defineProperty({},"passive",{get:(r=this,function(){return e=!0})}),window.addEventListener("test",null,t)}catch(n){}return e},I.support_intersection_observer=function(){return"IntersectionObserver"in window},t=function(t,e){var r,n,i,o,s,a,l,u;for(t.removeClass("lazy_images"),n=t.find("[data-background_image]").addBack("[data-background_image]"),o=function(){var t,i,o;for(t=0,o=[],i=n.length;t<i;t++)r=n[t],o.push(function(t){var r,n;if(r=(t=$(t)).data("background_image"),t.css({backgroundImage:"url("+r+")"}),e)return $.Deferred((n=this,function(t){return $("<img />").attr("src",r).on("load",function(){return t.resolve()})}))}(r));return o}(),u=t.find("img[data-lazy_src]").addBack("img[data-lazy_src]"),i=function(t){var r,n,i;if(r=(t=$(t)).data("lazy_src"),t.attr("src",r),(n=t.data("lazy_srcset"))&&t.attr("srcset",n),e)return $.Deferred((i=this,function(e){return t.on("load",function(){return e.resolve()})}))},a=0,l=u.length;a<l;a++)i(s=u[a]);if(e)return 1===o.length?o[0]:$.when.apply($,o)},$.fn.lazy_images=function(e){var r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b;if(h=this.data("lazy_images"))return h();if(u=(null!=e?e.elements:void 0)?function(){var t,r,n,o;for(t=0,n=e.elements,o=[],r=n.length;t<r;t++)i=n[t],o.push($(i));return o}():(d=(null!=e?e.selector:void 0)||".lazy_images",(function(){var t,e,r,n;for(t=0,r=this.find(d),n=[],e=r.length;t<e;t++)i=r[t],n.push($(i));return n}).call(this)),r=null!=(p=null!=e?e.show_images:void 0)?p:t,I.support_intersection_observer()){for(l=0,o=function(t){var n,o,s,l,u,c;for(s=0,c=[],l=t.length;s<l;s++)(o=t[s]).isIntersecting?(i=o.target,a.unobserve(i),n=r(i=$(i),!!(u=null!=e?e.show_item:void 0)),c.push("function"==typeof u?u(i,n):void 0)):c.push(void 0);return c},a=new IntersectionObserver(o,{}),c=u.length;l<c;l++)i=u[l],a.observe(i[0]);return function(){return a.disconnect()}}return v=$(window),f=null!=e?e.target:void 0,s=null!=e?e.horizontal:void 0,g=null,n=(y=this,function(){var t,n,o,a,l,c,p,h,d;for(t=function(){if(!f)return v.scrollTop()+v.height();if(s)return f.outerWidth()+f.position().left;throw Error("not yet")}(),o=0,a=c=0,p=u.length;c<p;a=++c){if(l=u[a]){if(!document.body.contains(l[0])){u[a]=null,o+=1;continue}d=function(){if(!f)return l.offset().top;if(s)return l.position().left;throw Error("not yet")}(),l[0].offsetParent&&d<t&&(n=r(l,!!(h=null!=e?e.show_item:void 0)),"function"==typeof h&&h(l,n),o+=1,u[a]=null)}}if(o>0)return u=function(){var t,e,r;for(t=0,r=[],e=u.length;t<e;t++)(i=u[t])&&r.push(i);return r}()}),m=_.throttle(n,100),f?(f.on("scroll",m),v.on("resize",m),g=function(){return f.off("scroll",m),v.off("resize","throttled")}):I.support_passive_scroll()?(window.addEventListener("scroll",m,{passive:!0}),v.on("resize i:reshape",m),g=function(){return window.removeEventListener("scroll",m,{passive:!0}),v.off("resize",m)}):(v.on("scroll resize i:reshape",m),g=function(){return v.off("scroll resize i:reshape",m)}),this.data("lazy_images",(b=this,function(){return u=(null!=e?e.elements:void 0)?function(){var t,r,n,o;for(t=0,n=e.elements,o=[],r=n.length;t<r;t++)i=n[t],o.push($(i));return o}():(d=(null!=e?e.selector:void 0)||".lazy_images",(function(){var t,e,r,n;for(t=0,r=this.find(d),n=[],e=r.length;t<e;t++)i=r[t],n.push($(i));return n}).call(b)),n()})),n(),g},$.fn.max_height=function(t){var e,r,n,i;return null==t&&(t=0),n=$(window),e=this.outerHeight(!0)-this.height(),r=(i=this,function(){return i.css("min-height",n.height()-e-t+"px")}),n.on("resize",r),r()},$.fn.remote_link=function(t){var e;return this.on("click","[data-remote]",(e=this,function(e){var r,n,i,o,s;if(e.preventDefault(),!(n=$(e.currentTarget)).is(".loading")){if(o=n.data("method")||"POST",s=I.with_csrf($.extend({},n.data("params"))),i=n.data("href")||n.attr("href"),!(r=n.data("confirm"))||confirm(r))return n.addClass("loading").prop("disabled",!0),$.ajax({type:o,url:i,data:s,xhrFields:{withCredentials:!0}}).done(function(e){return n.removeClass("loading").prop("disabled",!1),"function"==typeof t?t(e,n):void 0}),null}}))},$.fn.remote_submit=function(t,e,r){var n,i,o;return n=null,this.on("click","button[name], input[type='submit'][name]",(i=this,function(t){var e;return e=$(t.currentTarget),null!=n&&n.remove(),n=$("<input type='hidden' />").attr("name",e.attr("name")).val(e.attr("value")).prependTo(i)})),this.on("submit",(o=this,function(n,i){var o;if(n.preventDefault(),o=$(n.currentTarget),!e||("function"==typeof e?e(o):void 0))return I.remote_submit(o,r,{loading_lock:!0}).done(function(e){return(o.data("dirty",!1),null!=i)?i(e,o):t(e,o)}),null}))},$.fn.remote_table=function(){var t,e,r,n,i,o,s,a;return r=this.data("max_page"),t=(i=this,function(){return i.data("page")||1}),n={},e=(o=this,function(t){var e,i;if(!o.is(".loading")&&1<=t&&t<=r)return e=o.find("table"),o.addClass("loading").data("page",t).toggleClass("first_page",1===t).toggleClass("last_page",t===r).find(".current_page").text(t),(i=n[t]||(n[t]=$.get(o.data("remote_url")+"?"+$.param({page:t})))).done(function(t){return o.removeClass("loading"),e.html(t.content)})}),this.dispatch("click",{next_page_btn:(s=this,function(){return e(t()+1)}),prev_page_btn:(a=this,function(){return e(t()-1)})})},$.fn.set_form_errors=function(t,e,r){var n,i,o,s,a,l,u,c;if(null==e&&(e=!0),null==r&&(r="Errors"),this.find(".form_errors").remove(),a=!!(null!=t?t.length:void 0),this.toggleClass("has_errors",a),a){for(l=0,s=(o=$(_.template('<div class="form_errors">\n  <div>{{ msg }}:</div>\n  <ul></ul>\n</div>')({msg:r}))).find("ul"),u=t.length;l<u;l++)i=t[l],s.append($("<li></li>").text(i));this.prepend(o),e&&((c=this.closest(".lightbox")).length||this.offset().top>$(window).height()/2?"function"==typeof(n=this[0]).scrollIntoView&&n.scrollIntoView():$("html, body").animate({scrollTop:0},"fast"))}return this},$.fn.swap_with=function(t){var e,r,n,i,o,s,a,l,u;if(t=$(t),this.length&&t.length)return r=this.offset(),i=t.offset(),l=this.prop("tagName"),s=t.prop("tagName"),a=$("<"+l+"></"+l+">").insertAfter(this),o=$("<"+s+"></"+s+">").insertAfter(t),a.after(t),o.after(this),e=this.offset(),n=t.offset(),o.replaceWith(this.detach().css({position:"relative",top:r.top-e.top+"px",left:r.left-e.left+"px"})),a.replaceWith(t.detach().css({position:"relative",top:i.top-n.top+"px",left:i.left-n.left+"px"})),_.defer((u=this,function(){return u.css({top:"",left:""}),t.css({top:"",left:""})}))},$.fn.track_input=function(t,e){var r,n,i;return r=this.find(t),n=(i=this,function(){var t,n,o;return o=function(){var t,i,o;for(t=0,o=[],i=r.length;t<i;t++)n=r[t],o.push(e+"_"+$(n).attr("value"));return o}(),i.removeClass(o.join(" ")),t=r.serializeArray().map(function(t){return e+"_"+t.value}),i.addClass(t.join(" "))}),r.on("change",function(t){return n()}),n()}}).call(this),(function(){var t,e,r,n,i={}.hasOwnProperty,o=[].slice;!window.R&&(e={},r=function(t,e){var r;for(r in t)if(i.call(t,r)&&t[r]!==e[r])return!0;for(r in e)if(i.call(e,r)&&!(r in t))return!0;return!1},n={},window.R=function(t,i,s,a){var l,u,c,p,h;return(null==s&&(s=R),null==a&&(a=""),s[t])?s[t]._class:(i.trigger=function(){var t;t=$(ReactDOM.findDOMNode(this)),R.trigger.apply(R,[t].concat(o.call(arguments)))},i.dispatch=function(){var t;t=$(ReactDOM.findDOMNode(this)),R.dispatch.apply(R,[t].concat(o.call(arguments)))},i.container=function(){return $(ReactDOM.findDOMNode(this))},i.extend_props=function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],$.extend.apply($,[{},this.props].concat(o.call(t)))},i.tt=function(t,r){var i;return(null==r&&(r=e),(i=I.i18n.fetch_key_sync(t))&&_.isString(i))?i:(n[t]||(n[t]=I.i18n.react_class(t)),React.createElement(n[t],r))},i.t=function(t,e){var r;return I.i18n.fetch_key_sync(t)?I.i18n.t_sync(t,e):(I.i18n.fetch_key(t).done((r=this,function(){if(r.isMounted())return r.forceUpdate()})),"…")},u=_.once(function(){return(""+a+t).replace(/[A-Z]/g,"_$&").replace(/\./g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").toLowerCase()+"_widget"}),i.enclosing_class_name=u,i.enclose=function(){var t,e,r;return r=arguments[0],t=2<=arguments.length?o.call(arguments,1):[],e=r.component||"div",delete r.component,React.createElement.apply(React,[e,$.extend({},r,{className:classNames(u(),r.className)})].concat(o.call(t)))},i.displayName=""+a+t,i.pure&&(i.shouldComponentUpdate=function(t,n){return r(this.props||e,t)||r(this.state||e,n)}),c=i.getDefaultProps,delete i.getDefaultProps,h=i.propTypes,delete i.propTypes,l=createReactClass(i),c&&(l.defaultProps=c()),h&&(l.propTypes=h),(p=React.createElement.bind(null,l)).type=l,s[t]=p)},R.scope_event_name=function(t){return"itch:"+t},R.trigger=function(){var t,e,r;return r=arguments[0],e=arguments[1],t=3<=arguments.length?o.call(arguments,2):[],r.trigger(R.scope_event_name(e),o.call(t))},R.dispatch=function(t,e,r){var n,o,s;for(n in"object"==typeof e&&(r=e,e=!1),s=[],r)i.call(r,n)&&(o=r[n],e&&(n=e+":"+n),s.push(t.on(R.scope_event_name(n),o)));return s},R.component=function(){return R.apply(null,arguments)},R.is_different=r,R.package=(t=this,function(t){var e;return(e=R[t]||(R[t]=function(r,n){return n.Package=e,R.component(r,n,e,t+".")})).component=function(){return e.apply(null,arguments)},e}))}).call(this),(function(){var slice=[].slice,extend=function(t,e){for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;I.Lightbox=function(){function Lightbox(){var t,e,r,n;t=arguments[0],e=arguments[1],r=3<=arguments.length?slice.call(arguments,2):[],this.parent=e,this.el=$(t),this.el.on("click",".close_button, .close_btn",(n=this,function(t){return I.Lightbox.close(),!1})),this.init.apply(this,r)}return Lightbox.include_dependencies=function(t){var e;return t?(e=[],t.redactor&&!$.fn.redactor&&($("head").append(t.redactor),e.push(I.libs.redactor)),t.selectize&&!$.fn.selectize&&($("head").append(t.selectize),e.push(I.libs.selectize)),e):[]},Lightbox.lightbox_container=function(){return this._container||(this._container=$("#lightbox_container").exists()||$('<div id="lightbox_container"></div>').appendTo("body"))},Lightbox.shroud_container=function(){return this._shroud||(this._shroud=$("#lightbox_shroud").exists()||$('<div id="lightbox_shroud"></div>').appendTo("body"))},Lightbox.show_shroud=function(){var t,e,r,n,i,o;if(!this.shroud_visible)return!this._shroud&&(t=this.shroud_container(),this.lightbox_container().on("click",(e=this,function(t){if(!$(t.target).closest(".lightbox").length&&"javascript:void(0)"!==$(t.target).attr("href"))return e.close()})),t.on("click",(r=this,function(){return r.close()})),$(document.body).on("keydown",(n=this,function(t){return 27===t.keyCode?(t.preventDefault(),t.stopPropagation(),n.close()):n.on_keydown(t)})),$(window).on("resize",(i=this,function(t){return i.on_resize(t)}))),this.shroud_visible=!0,this.shroud_container().addClass("invisible").show(),_.defer((o=this,function(){return o.shroud_container().removeClass("invisible")}))},Lightbox.hide_shroud=function(){return this.shroud_visible=!1,this.shroud_container().hide()},Lightbox.open_loading=function(){return this.open_tpl("loading_lightbox",I.Lightbox)},Lightbox.open_remote_react=function(t,e){var r,n;return this.open_loading(),$.when(I.add_react(),$.ajax({dataType:"json",url:t,data:{props:!0},xhrFields:{withCredentials:!0},error:(r=this,function(t,e,n){var i,o,s;return(i=null!=(o=null!=(s=function(){try{return JSON.parse(t.responseText)}catch(e){}}())?s.errors:void 0)?o:["Something went wrong. Please try again later and contact support if it persists."],R.ErrorLightbox)?I.Lightbox.open(R.ErrorLightbox({errors:i})):(alert(props.errors.join(",")),r.close())})})).done((n=this,function(t,r){var i,o;if((o=r[0]).errors){R.ErrorLightbox?I.Lightbox.open(R.ErrorLightbox(o)):(alert(o.errors.join(",")),n.close());return}return i=I.Lightbox.include_dependencies(o._dependencies),$.when.apply($,[e(o)].concat(slice.call(i))).then(function(t){return t?I.Lightbox.open(t):n.close()})}))},Lightbox.open_remote=function(){var t,e,r,n,i;return r=arguments[0],t=arguments[1],e=3<=arguments.length?slice.call(arguments,2):[],null==t&&(t=I.Lightbox),this.open_loading(),$.ajax({dataType:"json",url:r,data:{lightbox:!0},xhrFields:{withCredentials:!0},success:(n=this,function(r){if(r.errors){alert(r.errors.join(",")),n.close();return}return n.open.apply(n,[r.content,t].concat(slice.call(e)))}),error:(i=this,function(t,e,r){return alert("Something went wrong. Please try again later and contact support if it persists."),i.close()})})},Lightbox.open_tpl=function(){var t,e,r;if(r=arguments[0],t=2<=arguments.length?slice.call(arguments,1):[],!(e=$("#"+r+"_tpl")).length)throw"missing template for lightbox: "+r;return this.open.apply(this,[e.html()].concat(slice.call(t)))},Lightbox.open_tpl_with_params=function(){var t,e,r,n,i;if(i=arguments[0],n=arguments[1],t=3<=arguments.length?slice.call(arguments,2):[],!(e=$("#"+i+"_tpl")).length)throw"missing template for lightbox: "+i;return r=_.template(e.html())(n),this.open.apply(this,[r].concat(slice.call(t)))},Lightbox.open=function(){var t,e,r,n,i,o,s,a,l,u,c;return(r=arguments[0],t=arguments[1],e=3<=arguments.length?slice.call(arguments,2):[],null==t&&(t=I.Lightbox),this.current_lightbox&&(this.current_lightbox.close(),this.current_lightbox=null),o=!1,r.$$typeof)?(o=!0,n=new I.ReactLightbox(r,this)):("string"==typeof r&&(r=$.trim(r)),!(n=(i=$(r)).data("object"))&&(o=!0,n=(s=t,a=[i,this].concat(slice.call(e)),(l=function(){}).prototype=s.prototype,u=new l,Object(c=s.apply(u,a))===c?c:u),i.data("object",n))),$(document.body).addClass("lightbox_open"),this.show_shroud(),n.show(o),this.current_lightbox=n,n},Lightbox.close=function(){var t;if(!(this.current_lightbox&&!this.current_lightbox.is_closable()||this.current_lightbox&&this.current_lightbox.el.is(".has_changes")&&!confirm("You've have unsaved changes in this dialog. Are you sure you want to close it?")))return this.hide_shroud(),null!=(t=this.current_lightbox)&&t.close(),this.current_lightbox=null,$(document.body).removeClass("lightbox_open")},Lightbox.on_keydown=function(t){var e,r;return null!=(e=this.current_lightbox)&&null!=(r=e.el)?r.trigger("i:lightbox_keydown",t):void 0},Lightbox.on_resize=function(t){var e,r;return null!=(e=this.current_lightbox)&&null!=(r=e.el)?r.trigger("i:lightbox_resize",t):void 0},Lightbox.prototype.lightbox_hidden=function(t){},Lightbox.prototype.init=function(){},Lightbox.prototype.first_show=function(){},Lightbox.prototype.with_selectize=function(t){var e;if(!$.fn.selectize){if(!(e=this.el.data().selectize))throw"missing selectize include in lightbox";$("head").append(e)}return I.with_selectize(t)},Lightbox.prototype.with_redactor=function(t){var e;if(!$.fn.redactor){if(!(e=this.el.data().redactor))throw"missing redactor include in lightbox";$("head").append(e)}return I.with_redactor(t)},Lightbox.prototype.show=function(first_time){var el,i,len,ref;if(this.el.appendTo(this.parent.lightbox_container()).addClass("animated").show().trigger("i:lightbox_open"),this.position(),first_time){for(i=0,len=(ref=this.el.find("[data-js_init]")).length;i<len;i++)eval($(el=ref[i]).data("js_init"));return this.first_show()}},Lightbox.prototype.close=function(){return this.el.removeClass("animated").hide().trigger("i:lightbox_close").remove()},Lightbox.prototype.position=function(){var t;return t="fixed"===this.parent.lightbox_container().css("position")?"":$(window).scrollTop()+"px",this.el.css({top:t})},Lightbox.prototype.closable=!0,Lightbox.prototype.is_closable=function(){return this.closable},Lightbox}(),I.ReactLightbox=function(t){function e(){var t,r,n,i,o,s;t=arguments[0],n=arguments[1],o=3<=arguments.length?slice.call(arguments,2):[],s=$('<div class="react_lightbox"></div>').appendTo(n.lightbox_container()),i=ReactDOM.render(t,s[0]),r=ReactDOM.findDOMNode(i),e.__super__.constructor.apply(this,[r,n].concat(slice.call(o)))}return extend(e,t),e.prototype.show=function(t){return this.el.addClass("animated"),this.position()},e.prototype.close=function(){var t;return this.el.trigger("i:lightbox_close"),t=this.el.parent(),ReactDOM.unmountComponentAtNode(t[0]),t.remove()},e}(I.Lightbox)}).call(this),(function(){var t=function(t,r){for(var n in r)e.call(r,n)&&(t[n]=r[n]);function i(){this.constructor=t}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t},e={}.hasOwnProperty;I.CollectionLightbox=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.init=function(){var t,e,r,n,i;return I.has_follow_button(this.el),I.event2("view add to collection lightbox"),this.el.find("input[type='radio']:first").prop("checked",!0),this.el.on("click change",".collection_option",(e=this,function(t){var e;return(e=$(t.currentTarget)).find("input[type='radio']").prop("checked",!0)})),t=this.el.find("form").remote_submit((r=this,function(e){if(e.errors){if(I.add_recaptcha_if_necessary(t,e.errors))return;t.set_form_errors(e.errors);return}return r.el.addClass("is_complete"),r.el.find(".after_submit .collection_name").text(e.title).attr("href",e.url)})),this.with_redactor((n=this,function(){return I.redactor(n.el.find("textarea"),{minHeight:40,source:!1,buttons:["bold","italic","deleted","lists","link"]})})),this.with_selectize((i=this,function(){return i.el.find("select.collection_input").selectize()}))},r}(I.Lightbox)}).call(this),(function(){var t=function(t,r){for(var n in r)e.call(r,n)&&(t[n]=r[n]);function i(){this.constructor=t}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t},e={}.hasOwnProperty;I.AfterDownloadLightbox=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.init=function(t,e){var r,n;return this.game=t,null==e&&(e={}),I.event(e.page_name||"view_game","after_download_lb",""+this.game.id),r=this.el.find(".game_grid_widget"),new I.GameGrid(r,{expected_size:240}),I.setup_grid_referrers(this.el,(n=this,function(){return"after_download:"+n.game.id})),I.tracked_links(this.el,"after_download_lb"),I.has_follow_button(this.el)},r}(I.Lightbox)}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;I.BaseBuyForm=function(){function e(e,r){var n,i,o,s,a,l,u,c,p,h;this.opts=null!=r?r:{},this.billing_address_valid=t(this.billing_address_valid,this),this.show_billing_address_form=t(this.show_billing_address_form,this),this.show_vat_form=t(this.show_vat_form,this),this.submit_handler=t(this.submit_handler,this),this.checkout_btn_handler=t(this.checkout_btn_handler,this),this.set_fingerprint=t(this.set_fingerprint,this),this.el=$(e),this.el.find("input[name=csrf_token][value='']").val($("meta[name=csrf_token]").attr("value")),this.form=this.el.find("form"),this.opts=$.extend({},this.form.data("opts"),this.opts),this.set_fingerprint(),this.input=this.form.find("input.money_input"),this.input.length&&I.money_input(this.input),this.form.on("submit",(o=this,function(){return o.submit_handler.apply(o,arguments)})),this.el.dispatch("click",{add_btn:(s=this,function(t){var e;return e=+t.attr("data-amount"),s.track_add_btn(e),s.input.val(I.format_money(s.get_value()+e,s.get_currency())),s.update_items()}),billing_back_btn:(a=this,function(){return a.form.find(".checkout_btn").prop("disabled",!1),a.form.removeClass("show_billing_address_form")}),vat_back_btn:(l=this,function(){return l.form.removeClass("show_vat_confirm"),l.show_billing_address_form()}),direct_download_btn:(u=this,function(){return u.direct_download()}),save_billing_btn:(c=this,function(t){return c.billing_address_valid()?c.opts.collect_vat?c.show_vat_form():c.form.submit():void 0}),confirm_vat_btn:(p=this,function(t){return p.form.submit()})}),this.el.on("click",".checkout_btn",(h=this,function(t){return h.checkout_btn_handler(t)})),this.el.format_timestamps(),(i=this.opts.pick_source)&&(n=this.opts.pick_medium||"default",this.el.find("[data-source='"+i+"'][data-medium='"+n+"']").click())}return e.prototype.event_category="buy_form",e.prototype.pay_in_popup=!1,e.prototype.min_price=100,e.prototype.set_fingerprint=function(){var t;return!!window.Fingerprint2&&(this.set_fingerprint=function(){},(new Fingerprint2).get((t=this,function(e){if(e)return t.form.find(".bp_input").val(e)})))},e.prototype.checkout_btn_handler=function(t){var e;if(e=this.set_source(t),this.opts.collect_billing_address)return this.is_valid()&&this.show_billing_address_form(),!1},e.prototype.submit_handler=function(){return!!this.is_valid()&&("_blank"===this.form.attr("target")?this.form.removeClass("show_vat_confirm show_billing_address_form").addClass("show_purchase_complete"):void 0)},e.prototype.show_vat_form=function(){var t,e,r,n;if(!this.form.is(".show_billing_address_form"))throw"billing form not visible";return(e=this.form.addClass("loading").find(".billing_address_view").find("input[type='text'], select, button")).prop("disabled",!0),r=this.form.find("[name='price']").val(),t=this.form.find("[name='address[country]']").val(),$.ajax({type:"GET",url:this.opts.tax_preview_url,data:{sub_product_id:this.opts.sub_product_id,price:r,country:t},async:!1}).then((n=this,function(t){var r,i,o,s,a,l,u;if(e.prop("disabled",!1),n.form.removeClass("loading has_vat_error"),t.errors){"country mismatch"===(r=t.errors[0])?(I.event(n.event_category,"vat","country_mismatch"),n.form.removeClass("show_billing_address_form").addClass("show_vat_confirm has_vat_error")):(I.event(n.event_category,"error",JSON.stringify(t.errors)),n.form.find(".generic_error_description").text(t.errors[0]),n.form.removeClass("show_billing_address_form").addClass("show_vat_confirm has_generic_error"));return}if(!t.rate||0===t.tax){n.form.submit();return}for(n.form.removeClass("show_billing_address_form").addClass("show_vat_confirm"),n._seen_vat||(I.event(n.event_category,"vat","show_tax_preview"),n._seen_vat=!0),l=(u=n.form.find(".vat_view")).find("[data-field]"),s=0,a=l.length;s<a;s++)(i=$(o=l[s])).text(t[i.data("field")]||"");return u.toggleClass("no_tip",!t.tip||0===t.tip)}))},e.prototype.show_billing_address_form=function(){return this._seen_billing||(I.event(this.event_category,"vat","show_billing"),this._seen_billing=!0),this.form.find(".checkout_btn").prop("disabled",!0),this.form.addClass("show_billing_address_form")},e.prototype.set_source=function(t){var e,r,n;return(e=$(t.currentTarget).closest(".checkout_btn")).length||(e=(this._checkout_btns||(this._checkout_btns=this.form.find(".checkout_btn"))).first()),n=e.data("source"),(this._source_input||(this._source_input=this.form.find(".source_input"))).val(n),r=e.data("medium"),(this._medium_input||(this._medium_input=this.form.find(".medium_input"))).val(r||""),n},e.prototype.set_loading=function(t){return this.form.toggleClass("loading",t),this.el.toggleClass("loading",t),this.input.prop("disabled",t),(this.add_buttons||(this.add_buttons=this.form.find(".add_btn"))).toggleClass("disabled",t),this.el.triggerHandler("i:loading",t)},e.prototype.has_money_input=function(){return!!this.input.length},e.prototype.get_value=function(){return I.parse_money(this.input.val())},e.prototype.get_currency=function(){return this.input.data("currency")},e.prototype._clean_error_message=function(t){return"paypal failed"===t&&(t="Failed to create PayPal transaction, please try again later."),t},e.prototype.set_error=function(t){return(t=this._clean_error_message(t),this.error_text||(this.error_text=this.el.find(".error_text")),t)?(this.form.addClass("has_error"),this.error_text.text(t)):this.form.removeClass("has_error")},e.prototype.remote_submit=function(t){var e,r,n,i,o;return!!this.is_valid()&&((e=this.form.serializeArray()).push({name:"json",value:"true"}),this.set_loading(!0),this.track_remote_submit(),this.pay_in_popup&&(null!=(n=(r=window.open()).document)&&n.write("Loading..."),_.defer((i=this,function(){var t;return null!=(t=r.document)?t.title="Loading...":void 0}))),this.el.trigger("i:buy_start",[e]),$.ajax({url:this.form.attr("action"),type:"POST",data:e,xhrFields:{withCredentials:!0},success:(o=this,function(t){return t.url?(r?(r.location=t.url,o.set_loading(!1)):window.top.location=t.url,o.el.trigger("i:buy_complete",[t])):(r&&r.close(),o.form.removeClass("show_billing_address_form show_vat_confirm"),o.set_error(t.errors.join(",")),o.set_loading(!1))})}),!1)},e.prototype.is_valid=function(){var t;return this.has_money_input()&&(t=this.get_value())<this.min_price?(this.set_error("Due to processing fees the minimum amount is 100 cents."),!1):(this.set_error(),!0)},e.prototype.billing_address_valid=function(){return this.el.find(".billing_address_form_widget").data("object").check_valid()},e.prototype.track_add_btn=function(t){},e.prototype.track_remote_submit=function(){},e.prototype.update_items=function(){},e}(),I.BuyForm=function(r){function n(e,r,i){var o;this.game=r,this.setup_filelist=t(this.setup_filelist,this),this.download_url=t(this.download_url,this),n.__super__.constructor.call(this,e,i),this.setup_filelist(),this.pay_in_popup=null!=(o=null!=i?i.pay_in_popup:void 0)?o:"default"!==this.game.type_name,this.pay_in_popup||(this.pay_in_popup="_blank"===$("base[target]").attr("target"))}return e(n,r),n.prototype.download_url=function(){return I.subdomain?"/"+this.game.slug+"/download_url":"/game/download_url/"+this.game.id},n.prototype.track_add_btn=function(t){return I.event(this.event_category,"add_"+t,""+this.game.id)},n.prototype.track_remote_submit=function(){return I.event(this.event_category,"purchase",""+this.game.id,this.get_value())},n.prototype.update_items=function(){var t,e,r,n,i,o,s,a;if(null!=(o=this.file_list)?o.length:void 0){for(r=0,a=a||this.get_value(),e=this.file_list.find(".file_row"),s=[],n=e.length;r<n;r++)i=(t=$(t=e[r])).data("min_price"),s.push(t.toggleClass("inactive",!!(i&&a<i)));return s}},n.prototype.setup_filelist=function(){var t,e;if(this.file_list=this.el.find(".file_list"),this.file_list.length)return this.el.on("keyup blur",".money_input",(t=this,function(){return t.update_items()})),this.file_list.on("click",".inactive",(e=this,function(t){var r,n;if(I.event(e.event_category,"pick_file",""+e.game.id),r=(n=$(t.currentTarget)).data("min_price"))return e.el.trigger("i:show_checkout"),e.input.val(I.format_money(r,e.get_currency())),e.update_items()})),this.el.find(".file_size_value").html(function(){return I.format_bytes(parseInt($(this).html(),10))}),this.update_items()},n.prototype.direct_download=function(){var t,e,r;return I.event(this.event_category,"skip_buy",""+this.game.id),this.set_loading(!0),this.pay_in_popup&&((t=window.open()).document.write("Loading..."),_.defer((e=this,function(){return t.document.title="Loading..."}))),$.ajax({url:this.download_url(),type:"POST",xhrFields:{withCredentials:!0},data:I.with_csrf({reward_id:this.opts.reward_id}),success:(r=this,function(e){return e.url?t?(t.location=e.url,r.set_loading(!1)):window.top.location=e.url:(r.set_error("There was an error generating the download URL, please try again."),r.set_loading(!1))})})},n.prototype.is_valid=function(){var t,e;if(this.has_money_input()&&(e=this.get_value(),!this.opts.is_donate)){if(0===e&&0===this.game.actual_price)return this.set_error(),this.direct_download(),!1;if(e<this.game.actual_price)return t=I.format_money(this.game.actual_price,this.get_currency()),this.set_error("You must pay at least "+t+"."),!1}if(n.__super__.is_valid.call(this))return!0},n}(I.BaseBuyForm),I.BundleBuyForm=function(r){function n(e,r,i){this.bundle=r,this.setup_gamelist=t(this.setup_gamelist,this),this.download_url=t(this.download_url,this),n.__super__.constructor.call(this,e,i),this.setup_gamelist()}return e(n,r),n.prototype.event_category="bundle_buy_form",n.prototype.download_url=function(){return"/bundle/"+this.bundle.id+"/download_url"},n.prototype.direct_download=function(){var t;return I.event(this.event_category,"skip_buy",""+this.bundle.id),this.set_loading(!0),$.ajax({url:this.download_url(),type:"POST",xhrFields:{withCredentials:!0},data:I.with_csrf(),success:(t=this,function(e){return e.url?window.top.location=e.url:(t.set_error("There was an error generating the download URL, please try again."),t.set_loading(!1))})})},n.prototype.setup_gamelist=function(){var t,e;if(this.game_list=this.el.find(".game_list"),this.game_list.length)return this.el.on("keyup blur",".money_input",(t=this,function(){return t.update_items()})),this.game_list.on("click",".inactive",(e=this,function(t){var r,n;if(I.event(e.event_category,"pick_game",""+e.bundle.id),r=(n=$(t.currentTarget)).data("min_price"))return e.el.trigger("i:show_checkout"),e.input.val(I.format_money(r,e.get_currency())),e.update_items()})),this.update_items()},n.prototype.update_items=function(){var t,e,r,n,i,o,s,a,l,u;if(null!=(l=this.game_list)?l.length:void 0){for(o=0,u=this.get_value(),n=this.game_list.find(".game_row"),e=0,s=n.length;o<s;o++)t=!((a=(r=$(r=n[o])).data("min_price"))&&u<a),r.toggleClass("inactive",!t),t&&(e+=1);if(i=this.el.find(".game_list_header_drop")[0])return ReactDOM.render(R.BundleBuyForm.AvailableItems({tiers:this.bundle.tiers,group_noun:this.bundle.group_noun,price:u,currency:this.get_currency()}),i)}},n.prototype.is_valid=function(){var t,e;return(e=this.get_value())<this.bundle.actual_price?(t=I.format_money(this.bundle.actual_price,this.get_currency()),this.set_error("You must pay at least "+t+"."),!1):!!n.__super__.is_valid.call(this)||void 0},n}(I.BaseBuyForm),I.BuyPopup=function(t){function r(){r.__super__.constructor.apply(this,arguments),this.check_height(),this.pay_in_popup=!1}return e(r,t),r.prototype.check_height=function(){var t,e,r;if(e=32,r=$(window),(t=$(document.body).height()+e-$(window).height())>0)return window.resizeTo(window.outerWidth,window.outerHeight+t)},r}(I.BuyForm),I.BillingAddressForm=function(){function e(e){var r,n;this.check_valid=t(this.check_valid,this),this.el=$(e),this.el.data("object",this),(r=this.el.find("[data-country_value]")).length&&(n=r.find("select")).find("[value='"+r.data("country_value")+"']").prop("selected",!0)}return e.prototype.check_valid=function(){var t,e,r,n,i,o,s,a;for(t=0,r=(o=this.el.find("input[required]")).length;t<r;t++)s=(e=$(e=o[t])).val(),e.toggleClass("has_error",!!s.match(/^\s*$/)),(i=e.attr("pattern"))&&(n=RegExp("^"+i+"$"),e.toggleClass("has_error",!s.match(n)));return a=0===this.el.find(".has_error").length,this.el.toggleClass("has_errors",!a),a},e}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};I.GameCarousel=function(){function e(e,r){var n,i,o,s,a,l;this.add_image_loading=t(this.add_image_loading,this),this.el=$(e),$.extend(this,r),this.scroll_outer=this.el.find(".scrolling_outer"),this.scroll_inner=this.el.find(".scrolling_inner"),this.paddles=this.el.find(".paddle_next, .paddle_prev"),I.is_mobile()?(this.el.find(".scrollbar_outer").remove(),this.paddles.remove()):this.setup_scrollbar(),new I.GameCells(this.el),_.defer((n=this,function(){return n.add_image_loading()})),this.el.dispatch("click",{paddle_next:(i=this,function(t){return i.scroll_to(i.cell_offset(i.current_cell()+3)),t.trigger("i:track_link")}),paddle_prev:(o=this,function(t){return o.scroll_to(o.cell_offset(o.current_cell()-3)),t.trigger("i:track_link")})}),this.update_height(),$(window).on("resize",_.debounce((s=this,function(){return s.update_scrollbar()}),100)),this.el.on("i:carousel:update_scrollbar",(a=this,function(){return a.update_scrollbar()})),_.defer((l=this,function(){return l.el.addClass("ready"),l.update_height()}))}return e.prototype.edge_threshold=5,e.prototype.margin=20,e.prototype.inner_padding=10,e.prototype.paddle_margin_bottom=30,e.prototype.cell_class=".game_cell",e.prototype.add_image_loading=function(){var t;return this.el.lazy_images({show_item:(t=this,function(t){return t.trigger("i:impression"),t.find(".image_loading").addBack(".image_loading").removeClass("image_loading")})})},e.prototype.tallest_child=function(){var t,e,r,n,i,o,s,a;for(s=null,a=null,o=this.scroll_inner.children(),r=n=0,i=o.length;n<i;r=++n)t=$(t=o[r]),s?(e=t.outerHeight(!0))>a&&(s=t,a=e):(s=t,a=t.outerHeight(!0));return s},e.prototype.update_height=function(){var t,e;return t=(e=this.tallest_child()).outerHeight(!0),t+=2*this.inner_padding,this.scroll_outer.css({height:t+"px"}),this.paddles.css({height:t-this.paddle_margin_bottom+"px"}),this.update_scrollbar()},e.prototype.setup_scrollbar=function(){var t,e;return this.have_scrollbar=!0,this.scrollbar_outer=this.el.find(".scrollbar_outer"),this.scrollbar_inner=this.el.find(".scrollbar_inner"),this.scroll_inner.on("scroll",(t=this,function(){return t.update_scrollbar()})),this.scrollbar_inner.draggable({move:(e=this,function(t,r){if(e.unit_scroll)return e.scroll_inner[0].scrollLeft+=t*e.unit_scroll})}),this.update_scrollbar()},e.prototype.current_cell=function(){var t,e,r,n,i,o;for(r=Math.floor((e=this.el.find(this.cell_class)).width()/2),n=i=0,o=e.length;i<o;n=++i)if($(t=e[n]).position().left+r>=0)return n;return 0},e.prototype.cell_offset=function(t){var e,r,n;return t=Math.max(0,t),e=this.el.find(this.cell_class+":eq("+t+")"),r=this.max_scroll(),Math.min(n=e.length?e.position().left+this.scroll_pos()-this.margin:r,r)},e.prototype.scroll_to=function(t){var e,r;if(!this.scroll_inner.is(":animated"))return r=Math.abs((e=this.scroll_pos())-t),this.scroll_inner.animate({scrollLeft:t},r/2)},e.prototype.scroll_pos=function(){return this.scroll_inner[0].scrollLeft},e.prototype.max_scroll=function(){return this.scroll_inner[0].scrollWidth-this.scroll_outer.innerWidth()},e.prototype.update_scrollbar=function(){var t,e,r,n;return this.have_scrollbar?(r=this.scroll_outer.innerWidth(),t=(e=this.scroll_inner[0].scrollWidth)-r>this.edge_threshold,this.el.toggleClass("no_scrollbar",!t),t)?(n=this.scroll_pos(),this.scrollbar_inner.css({width:100*r/e+"%",left:100*n/e+"%"}),this.unit_scroll=e/this.scroll_outer.width(),this.el.toggleClass("on_left",n<=this.edge_threshold),this.el.toggleClass("on_right",n>=this.max_scroll()-this.edge_threshold)):this.el.removeClass("on_left on_right"):void 0},e}()}).call(this),(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g=[].slice;u=function(t,e,r){return(t<0?t+=1:t>1&&(t-=1),6*t<1)?e+(r-e)*6*t:2*t<1?r:3*t<2?e+(r-e)*(2/3-t)*6:e},r=function(t,e,r){var n,i,o,s,a;return t/=360,r/=100,0==(e/=100)?(o=r,i=r,n=r):(a=r<.5?r*(1+e):r+e-r*e,o=u(t+1/3,s=2*r-a,a),i=u(t,s,a),n=u(t-1/3,s,a)),[255*o,255*i,255*n]},c=function(t,e,r){var n,i,o,s,a;return t/=255,e/=255,r/=255,a=0,n=0,i=((s=Math.min(t,e,r))+(o=Math.max(t,e,r)))/2,s!==o&&(a=i<.5?(o-s)/(o+s):(o-s)/(2-o-s),n=function(){switch(o){case t:return(e-r)/(o-s);case e:return 2+(r-t)/(o-s);case r:return 4+(t-e)/(o-s)}}()),n<0&&(n+=6),[60*n,100*a,100*i]},o=function(){var t,e,r,n,i,o,s,a,l,u,c;if(u=arguments[0],a=2<=arguments.length?g.call(arguments,1):[],i=(n="[a-fA-f0-9]")+n,c="^#("+n+")("+n+")("+n+")$",l="^#("+i+")("+i+")("+i+")$",o=u.match(RegExp(c)))t=o[0],s=o[1],r=o[2],e=o[3],s+=s,r+=r,e+=e;else{if(!(o=u.match(RegExp(l))))return null;t=o[0],s=o[1],r=o[2],e=o[3]}return[parseInt(s,16),parseInt(r,16),parseInt(e,16)]},s=function(){var t;return t=o.apply(null,arguments),t||[0,0,0]},t=function(t){var e;return 1===(e=Math.floor(t).toString(16)).length?"0"+e:e},e=function(e,r,n){return e=Math.min(255,Math.max(0,e)),r=Math.min(255,Math.max(0,r)),n=Math.min(255,Math.max(0,n)),"#"+t(e)+t(r)+t(n)},d=function(t,n,i){var o,a,l,u,p;return null==n&&(n=15),null==i&&(i=.8),o=(u=c.apply(null,s(t)))[0],p=u[1],l=Math.max(0,Math.min(100,l=(a=u[2])>50?a-n:a+n)),e.apply(null,r(o,p*i,l))},n=function(t,e,r){return(.299*t+.587*e+.114*r)/255},l=function(t,e,r){return t/=255,e/=255,r/=255,t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),.2126*t+.7152*(e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(r=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},p=function(t,e,r){var n,i,o;return o=.299*t+.587*e+.114*r,n=(r-o)*.565,i=(t-o)*.713,[o,n,i]},m=function(t,e,r){var n,i,o;return o=t+1.403*r,[o,i=t-.344*e-.714*r,n=t+1.77*e]},h=function(t,e,r,n){var i,o,s,a;return null==n&&(n=.1),a=(i=p(t,e,r))[0],o=i[1],s=i[2],n<0?a+=n*a:a+=n*(255-a),m(a,o,s)},a=function(t,r,n){var o,a;return("string"==typeof t&&(t=(o=s(t))[0],r=o[1],n=o[2]),(a=l(t,r,n))>=.45)?i(e(t,r,n),"#000000",.2):"#ffffff"},f=function(t,r,i){var o,a,l,u,c;return(null==r&&(r=.15),null==i&&(i=.5),u=(c=s(t))[0],(l=n(u,a=c[1],o=c[2]))<i)?e.apply(null,h(u,a,o,r)):e.apply(null,h(u,a,o,-r))},i=function(t,r,n){var i,o,a,l,u,c,p,h,d;return 1===n?t:0===n?r:(c=(h=s(t))[0],l=h[1],o=h[2],p=(d=s(r))[0],u=d[1],a=d[2],i=1-n,e(c*n+p*i,l*n+u*i,o*n+a*i))},I.Color={hsl_to_rgb:r,rgb_to_hsl:c,parse_color:o,parse_color_safe:s,hex_color:e,sub_color:d,luma:n,relative_luma:l,rgb_to_yuv:p,yuv_to_rgb:m,scale_luma:h,readable_text_color:a,sub_color2:f,mix_color:i}}).call(this),(function(){I.ContentWarning=function(){function t(t,e){this.opts=e,this.el=$(t),this.setup_forms()}return t.prototype.setup_forms=function(){var t,e;return(t=this.el.find("form")).remote_submit((e=this,function(r){if(r.errors){t.set_form_errors(r.errors);return}return e.el.addClass("hidden"),setTimeout(function(){return e.el.remove()},300),t.set_form_errors([])}))},t}()}).call(this),(function(){var t=[].slice;I.ConversionTracker=function(){function e(){}return e.types={impression:1,click:2,purchase:3,download:4,join:5},e.buffer=[],e.find_click=function(t){var e,r,n,i,o,s;for(n=0,s=RegExp(":"+t+"$"),o=(e=this.get_cookie()).length;n<o;n++)if(i=e[n],(r=_.isArray(i)?i[0]:i).match(s))return i},e.strip_click=function(t){var e,r,n,i,o,s;return(o=RegExp(":"+t+"$"),e=this.get_cookie(),s=0,(i=function(){var t,i,a;for(t=0,a=[],i=e.length;t<i;t++){if(n=e[t],(r=_.isArray(n)?n[0]:n).match(o)){s+=1;continue}a.push(n)}return a}()).length===e.length)?0:(this.write_cookie(i),s)},e.after_click_action=function(t,e){var r,n,i,o;if(r=this.find_click(e))return o=null,n=(i=_.isArray(r)?(o=r[1],r[0]):r).replace(/^\d+/,this.types[t]),this.strip_click(e),this.push(n,o),!0},e.download=function(t){return this.after_click_action("download",t)},e.purchase=function(t){return this.after_click_action("purchase",t)},e.join=function(t){return this.after_click_action("join",t)},e.click=function(t){var e,r,n,i,o,s;n=this.types.click+":"+t,i=(s=this.get_active_splits())?[n,s]:n,this.push(n);try{for((r=(function(){var t,r,i,s;for(t=0,i=this.get_cookie(),s=[],r=i.length;t<r;t++)e=i[t],(o=_.isArray(e)?e[0]:e)!==n&&s.push(e);return s}).call(this)).push(i);r.length>100;)r.shift();return this.write_cookie(r),!0}catch(a){}},e.write_cookie=function(t){return I.set_cookie("itchio_ca",JSON.stringify(t),{expires:1})},e.get_cookie=function(){var t;if(!(t=Cookies.get("itchio_ca")))return[];try{return JSON.parse(t)||[]}catch(e){try{return JSON.parse(decodeURIComponent(t))||[]}catch(r){return[]}}},e.flush_later=function(){var t;return this.flush_later=_.throttle(this.flush_now,2e3,{leading:!1}),$(window).on("beforeunload",(t=this,function(){t.flush_now()})),this.flush_later()},e.encode_buffer=function(e){var r,n,i,o,s,a,l,u,c,p,h,d,f,m,g;for(null==e&&(e=t.call(this.buffer)),e.sort(),h=[],l=null,a=null,s=null,i=0,u=e.length;i<u;i++)r=(f=(n=e[i]).match(/^(\d+):(\d+):(\d+):(\d+)$/))[0],g=f[1],m=f[2],p=f[3],c=f[4],g&&(g!==l&&(h.push("t"+g),l=g),m!==a&&(h.push("s"+m),a=m),p!==s&&(h.push("o"+p),s=p),d=String.fromCharCode(65+(o=(+c).toString(36)).length),h.push(""+d+o));return h.join("")},e.get_active_splits=function(){return I.active_splits},e.flush_url=function(t){var e,r,n;return e=[{name:"x",value:n=this.encode_buffer()}],(r=t||this.get_active_splits())&&e.push({name:"s",value:r.join(",")}),I.root_url("ca.gif")+"?"+$.param(e)},e.flush_now_beacon=function(e){var r;if(null==navigator.sendBeacon)return this.flush_now(e);if(this.buffer.length){if(I.in_dev&&console.debug.apply(console,["ca(beacon)"].concat(t.call(_.compact([this.buffer,e])))),r=this.flush_url(e),!navigator.sendBeacon(r))return this.flush_now();this.buffer=[]}return $.when()},e.flush_now=function(e){var r,n;return this.buffer.length?(I.in_dev&&console.debug.apply(console,["ca"].concat(t.call(_.compact([this.buffer,e])))),r=this.flush_url(e),this.buffer=[],$.Deferred((n=this,function(t){var e,n;return(n=new Image).src=r,e=function(){return t.resolve()},n.onerror=e,n.onload=e}))):$.when()},e.push=function(t,e){var r;return(this.buffer=(function(){var e,n,i,o;for(e=0,i=this.buffer,o=[],n=i.length;e<n;e++)(r=i[e])!==t&&o.push(r);return o}).call(this),this.buffer.push(t),this.buffer.length>50||e)?this.flush_now(e):this.flush_later()},e}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;I.Countdown=function(){function t(t,e,r){var n;this.date=e,this.opts=null!=r?r:{},this.opts.max_blocks&&(this.max_blocks=this.opts.max_blocks),this.el=$(t),this.update_countdown(),window.setInterval((n=this,function(){return n.update_countdown()}),1e3)}return t.prototype.max_blocks=4,t.prototype.update_countdown=function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v;for(r=0,c=["years","months","days","hours","minutes","seconds"],t=dayjs.duration(I.parse_timestamp(this.date)-new Date),e=!0,g=(g=function(){var r,n,i;for(r=0,i=[],n=c.length;r<n;r++)(0!==(v=t[l=c[r]]())||!e)&&(v>0&&(e=!1),i.push([l,v]));return i}()).slice(0,this.max_blocks),h={},s=g.length;r<s;r++)l=(p=g[r])[0],m=p[1],h[l]=m;for(n=0,d=[],a=c.length;n<a;n++)l=c[n],u=this.el.find("[data-name='"+l+"']"),v=h[l]||0,(f=null==h[l])||(o=(i=u.find(".block_label")).text(),i.text(o.replace(/s$/,"")+(1===v?"":"s"))),d.push(u.toggleClass("hidden",f).find(".block_value").text(v));return d},t}(),I.TimestampCountdown=function(r){function n(){return this.update_countdown=t(this.update_countdown,this),n.__super__.constructor.apply(this,arguments)}return e(n,r),n.prototype.update_countdown=function(){var t;return(t=I.parse_timestamp(this.date)-new Date)<0&&(t=-t),this.el.text(I.format_duration(t,1,!1))},n}(I.Countdown)}).call(this),(function(){$.fn.draggable=function(t){var e,r,n,i,o,s,a,l,u,c,p,h,d;return(null==t&&(t={}),l="ontouchstart"in document,!1===t.mobile&&(l=!1),e=$(document.body),o=$("html"),s=0,a=0,i=(u=this,function(n){return e.removeClass("dragging"),u.removeClass("dragging"),o.off("mousemove touchmove",r),"function"==typeof t.stop?t.stop():void 0}),r=(c=this,function(e,r,n){var i,o;return i=r-s,o=n-a,s+=i,a+=o,"function"==typeof t.move?t.move(i,o):void 0}),n=(p=this,function(r,n,i){if(!(e.is(".dragging")||("function"==typeof t.skip_drag?t.skip_drag(r):void 0)))return e.addClass("dragging"),p.addClass("dragging"),s=n,a=i,"function"==typeof t.start&&t.start(),!0}),l)?this.on("touchstart",(h=this,function(t){var e,s,a,l;s=(e=t.originalEvent.targetTouches[0]).pageX,n(t,s,a=e.pageY)&&(o.one("touchend",i),r=(l=r,function(t){var e;return s=(e=t.originalEvent.targetTouches[0]).pageX,l(t,s,a=e.pageY)}),o.on("touchmove",r))})):this.on("mousedown",(d=this,function(t){if(n(t,t.pageX,t.pageY)){var e;return o.one("mouseup",i),r=(e=r,function(t){return e(t,t.pageX,t.pageY)}),o.on("mousemove",r)}}))}}).call(this),(function(){var t=function(t,r){for(var n in r)e.call(r,n)&&(t[n]=r[n]);function i(){this.constructor=t}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t},e={}.hasOwnProperty;I.FeedbackLightbox=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.init=function(){var t;return this.el.find("form").remote_submit((t=this,function(e){if(e.errors){alert(e.errors.join(", "));return}return t.el.addClass("is_complete")}))},r}(I.Lightbox),I.FeedbackWidget=function(){function t(t){var e;this.el=$(t),this.el.on("click",(e=this,function(t){var e;return e=$(t.target).data("url")+"?"+$.param({url:window.location.href}),I.Lightbox.open_remote(e,I.FeedbackLightbox)}))}return t}()}).call(this),(function(){I.FilterPickers=function(){function t(t,e){var r,n,i,o,s;this.opts=null!=e?e:{},this.el=$(t),r=this.el.find(".filter_picker_widget"),this.opts.label_padding&&(this.label_padding=this.opts.label_padding),n=(i=this,function(){return r.removeClass("open popup_visible").find(".filter_options").css({marginTop:""})}),$(window).on("click",(o=this,function(t){if(!$(t.target).closest(".filter_picker_widget").length)return n()})),this.el.on("i:close_filter_pickers",n),this.el.on("click",".filter_picker_widget .filter_value",(s=this,function(t){var e,n,i;return t.preventDefault(),(n=$(t.currentTarget).closest(".filter_picker_widget")).trigger("i:track_link"),r.not(n).removeClass("open popup_visible"),n.toggleClass("open"),e=n.find(".filter_value").height(),n.find(".filter_options").css({marginTop:e+2*s.label_padding,minWidth:n.width()+30+"px"}),i=$(window).width()-n.position().left+n.width(),n.toggleClass("popup_left",i<200),_.defer(function(){return n.toggleClass("popup_visible",n.is(".open"))})}))}return t.prototype.label_padding=10,t}()}).call(this),(function(){var t,e,r=function(t,e){return function(){return t.apply(e,arguments)}};t=0,e=function(){return"game_grid_"+t++},I.GameGridSizer=function(){function t(t){var e,r;null==t&&(t={}),$.extend(this,t),this.size_callbacks=[],this.constructor.initialize(),$(window).on("resize",_.debounce((e=this,function(){return e.resize_cells()}),200)),this.resize_cells(),!I.in_test&&_.defer((r=this,function(){return r.resize_cells()}))}return t.prototype.container_selector=!1,t.prototype.expected_size=315,t.prototype.aspect_ratio=1.26,t.prototype.cell_margin=10,t.prototype.min_columns=1,t.initialize=_.once(function(){var t,e,r;return t=$(document.body),e=_.debounce(function(){return t.addClass("disable_hover")},200,!0),r=_.debounce(function(){return t.removeClass("disable_hover")},200),$(window).on("scroll resize",function(){e(),r()})}),t.prototype.get_cell_margin=function(){return"function"==typeof this.cell_margin?this.cell_margin():this.cell_margin},t.prototype.get_expected_size=function(){return"function"==typeof this.expected_size?this.expected_size():this.expected_size},t.prototype.on_size=function(t){return this.size_callbacks.push(t)},t.prototype.available_width=function(){var t,e,r,n;return this.el?(r=(t=null!=(n=this.el[0])?n.getBoundingClientRect().width:void 0)-Math.floor(t),e=Math.floor(this.el.width()),r>0&&(e-=1),e):$(window).width()},t.prototype.resize_cells=function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d;for(p=(n=this.get_expected_size())+(e=this.get_cell_margin()),(c=Math.ceil(l=(u=this.available_width()+e)/p))<this.min_columns&&(c=this.min_columns),s=(a=u/c-e)/this.aspect_ratio,a=Math.floor(a),s=Math.floor(s),this.cells_per_row=c,this._style&&(this._style.remove(),this._style=null),r="",this.container_selector&&(r+=this.container_selector+" {\n  --itchio_grid_gap: "+e+"px;\n  --itchio_grid_cell_width: "+a+"px;\n  --itchio_grid_cell_columns: "+c+";\n  grid-template-columns: repeat("+c+", "+a+"px);\n}"),""!==r&&(this._style=$("<style itchio-grid-sizer type='text/css'>"+r+"</style>").appendTo($("head"))),h=this.size_callbacks,d=[],i=0,o=h.length;i<o;i++)t=h[i],d.push(t(this,a,s));return d},t}(),I.GameCells=function(){function t(t){this.setup_game_tools=r(this.setup_game_tools,this),this.el=$(t),this.setup_game_tools(),this.setup_gifs()}return t.prototype.setup_game_tools=function(){var t;return this.el.dispatch("click",{add_to_collection_btn:(t=this,function(t){return(I.event("grid",I.page_name(),"add_to_collection"),I.current_user)?I.Lightbox.open_remote(t.attr("href"),I.CollectionLightbox):"continue"})})},t.prototype.setup_gifs=function(){var t;return this.el.on("mouseenter",".game_cell",(t=this,function(t){var e,r;if(!(e=$(t.currentTarget)).data("grid_hovered")){if(e.data("grid_hovered",!0),(r=e.find(".gif_overlay")).length)return r.css("background-image","url("+r.data("gif")+")")}}))},t}(),I.GameGrid=function(){function t(t,n){var i,o,s,a,l,u;if(null==n&&(n={}),this.refresh_images=r(this.refresh_images,this),this.add_image_loading=r(this.add_image_loading,this),this.setup_conversion_tracking=r(this.setup_conversion_tracking,this),this.el=$(t),$.extend(this,n),this.setup_lazy_images(),!1!==this.show_popups&&new I.GamePopups(this.el),new I.GameCells(this.el),!this.sizer&&!1!==this.sizer){for(i=["container_selector","expected_size","min_columns","cell_margin"],this.el[0]&&!this.el[0].id&&(this.el[0].id=e()),l={el:this.el,container_selector:"#"+this.el[0].id},s=0,a=i.length;s<a;s++)(o=i[s])in n&&(l[o]=n[o]);this.sizer=new I.GameGridSizer(l),this.sizer.on_size((u=this,function(){return u.el.trigger("i:grid_resize"),u.el.lazy_images()}))}}return t.prototype.setup_lazy_images=function(){var t;return _.defer((t=this,function(){return t.add_image_loading()}))},t.prototype.setup_conversion_tracking=function(t){var e,r;return this.el.on("i:impression",(e=this,function(e){var r,n;if(n=(r=$(e.target).closest("[data-game_id]")).data("game_id"))return I.ConversionTracker.push("1:"+t+":1:"+n)})),this.el.on("i:delegate_tracking",(r=this,function(e,r){var n;if(n=$(e.target).closest("[data-game_id]").data("game_id"))return I.ConversionTracker.click(t+":1:"+n),r(I.ConversionTracker.flush_now())}))},t.prototype.add_image_loading=function(){var t;return this.el.lazy_images({show_item:(t=this,function(t){return t.trigger("i:impression"),t.find(".image_loading").addBack(".image_loading").removeClass("image_loading")})})},t.prototype.refresh_images=function(){var t;return"function"==typeof(t=this.el.data("lazy_images"))?t():void 0},t}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};I.Header=function(){function e(e){var r;this.setup_browse_menu=t(this.setup_browse_menu,this),this.el=$(e),I.tracked_links(this.el,this.track_category,"click"),this.el.on("click",".menu_tick",(r=this,function(t){var e,r,n;return $(t.target).closest(".drop_menu").length?void 0:(r=(n=$(t.currentTarget)).closest(".drop_menu_wrap").toggleClass("open"),e=$(document.body),r.is(".open"))?(n.trigger("i:track_link"),e.on("click.drop_menu",function(t){if(!$(t.target).closest(r).length)return r.removeClass("open"),e.off("click.drop_menu")})):e.off("click.drop_menu")})),this.setup_browse_menu()}return e.prototype.track_category="header",e.prototype.setup_browse_menu=function(){var t,e,r,n,i,o;return t=this.el.find(".browse_btn"),this.browse_menu=new I.HoverManager({timeout:750,enter_timeout:100,show:(e=this,function(){return e.el.addClass("hover_menu_open"),t.addClass("open"),setTimeout(function(){return e.el.addClass("hover_menu_visible")},0)}),hide:(r=this,function(){return t.removeClass("open"),r.el.removeClass("hover_menu_visible")}),after_fade:(n=this,function(){return n.el.removeClass("hover_menu_open")})}),$(document.body).on("click",(i=this,function(t){var e;!(e=$(t.target).closest(".browse_btn, .header_dropdown")).length&&i.browse_menu.hide()})),this.el.on("mouseenter mouseleave",".browse_btn, .header_dropdown",(o=this,function(t){return"mouseenter"===t.type?o.browse_menu.enter():o.browse_menu.leave()}))},e}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};I.HoverManager=function(){function e(e){this._clear_enter_timeout=t(this._clear_enter_timeout,this),this._clear_fade_timeout=t(this._clear_fade_timeout,this),this._clear_leave_timeout=t(this._clear_leave_timeout,this),this.opts=$.extend({},this.default_opts,e),this.open=!1}return e.prototype.default_opts={timeout:1e3,enter_timeout:150,fade_timeout:400,show:function(){},hide:function(){},after_fade:function(){}},e.prototype.enter=function(){var t;if(!this.enter_timeout)return this._clear_leave_timeout(),this._clear_fade_timeout(),this.enter_timeout=window.setTimeout((t=this,function(){var e;return delete t.enter_timeout,t.open||"function"!=typeof(e=t.opts).show||e.show(),t.open=!0}),this.opts.enter_timeout)},e.prototype.leave=function(){var t;if(!this.leave_timeout)return this._clear_enter_timeout(),this.leave_timeout=window.setTimeout((t=this,function(){return delete t.leave_timeout,t.hide()}),this.opts.timeout)},e.prototype.hide=function(){var t,e;return this._clear_enter_timeout(),this._clear_leave_timeout(),this.open&&"function"==typeof(t=this.opts).hide&&t.hide(),this.open=!1,this.hiding=!0,this.fade_timeout=window.setTimeout((e=this,function(){var t;return"function"==typeof(t=e.opts).after_fade&&t.after_fade(),e.hiding=!1}),this.opts.fade_timeout)},e.prototype.show=function(){var t;return"function"==typeof(t=this.opts).show?t.show():void 0},e.prototype._clear_leave_timeout=function(){if(this.leave_timeout)return window.clearTimeout(this.leave_timeout),delete this.leave_timeout},e.prototype._clear_fade_timeout=function(){if(this.fade_timeout)return window.clearTimeout(this.fade_timeout),delete this.fade_timeout},e.prototype._clear_enter_timeout=function(){if(this.enter_timeout)return window.clearTimeout(this.enter_timeout),delete this.enter_timeout},e}()}).call(this),(function(){var t,e,r,n,i,o,s,a,l,u,c=[].slice,p={}.hasOwnProperty;l={},s={},t="en",r=null!=(a=window.itchio_locale)?a:t,n=window.requestAnimationFrame||_.defer,i=function(t,e,r){var n,o,s,a,l,u,c;for(s=0,a=e.length;s<a;s++)if(l=e[s],_.isString(l))t.push(l);else if("v"===l[0])(c=r[l[1]])||console.warn("i18n: failed to find value for variable "+l[1]),t.push(c);else if("t"===l[0]){if("function"!=typeof(o=r[l[1]]))throw Error("i18n: tried to interpolate tag without function: "+l[1]);i(u=[],(n=l[2])||[],r),t.push(o(u.join("")))}else throw Error("i18n: unknown interpolation node: "+JSON.stringify(l));return t},o=function(t,e){var r,n,i,s;return _.isString(t)?t:(n=function(){var n,a,l;for(n=0,l=[],a=t.length;n<a;n++)if(i=t[n],_.isString(i))l.push(i);else if("v"===i[0])(s=e[i[1]])||console.warn("i18n: failed to find value for variable "+i[1]),l.push(s);else if("t"===i[0]){if("function"!=typeof(r=e[i[1]]))throw Error("i18n: tried to interpolate tag without function: "+i[1]);l.push(r(o(i[2],e)))}else throw Error("i18n: unknown interpolation node: "+JSON.stringify(i));return l}()).length>1?React.createElement.apply(React,[React.Fragment,{}].concat(c.call(n))):0===n.length?null:n},e=function(){function t(t){this.locale=t,this.last_fetch=null,this.next_fetch=null}return t._cache={},t.for_locale=function(e){var r;return(r=this._cache)[e]||(r[e]=new t(e))},t.prototype.fetch=function(t,e){var r;return this.next_fetch?(this.next_fetch=this.next_fetch.concat(t),this.last_fetch):(this.next_fetch=t,this.last_fetch=$.Deferred((r=this,function(t){return n(function(){var n,i;if(!window.itchio_translations_url){console.error("missing translations url: itchio_translations_url");return}return n=r.next_fetch,i=$.get(window.itchio_translations_url,{locale:r.locale,prefixes:r.next_fetch.join(",")}),r.next_fetch=null,i.done(function(r){var n,i;for(n in r)if(p.call(r,n)){if(i=r[n],e[n])continue;e[n]=i}return t.resolve()})})})))},t}(),I.i18n={Preloader:e,get_translations:function(){return l},get_cache:function(){return s},get_locale:function(){return r},locale_is_english:function(){return"en"===r},insert:function(t){var e,r,n;for(e in r=[],t)if(p.call(t,e)){if(n=t[e],l[e])continue;r.push(l[e]=n)}return r},set_locale:function(t){return r=t,l={},s={}},render_string:function(t,e,r){var n;if(_.isString(e))return r&&console.warn("i18n: provided variables to translation string with no interpolation: "+t),e;if(n=[],!r)throw Error("i18n: tried to interpolate "+t+" without variables");return i(n,e,r),n.join("")},t:function(t,e){var r;return I.i18n.fetch_key(t).then((r=this,function(r){return I.i18n.render_string(t,r,e)}))},t_sync:(u=this,function(t,e){var r;if(!(r=I.i18n.fetch_key_sync(t)))throw Error("i18n: failed to fetch key sync: "+t);return I.i18n.render_string(t,r,e)}),fetch_key_sync:function(t){return"debug"===r?"[["+t+"]]":l[t]},fetch_key:function(e){var n,i,o;if("debug"===r)return $.when("[["+e+"]]");if((n=e.split(".")).pop(),!n.length)throw Error("i18n: empty prefix");return i=n.join("."),I.i18n.preload(i).then((o=this,function(){var n;if(n=l[e])return n;if(r===t)throw Error("i18n: failed to find key: "+e);return I.i18n.preload(i,t).then(function(){if(!(n=l[e]))throw Error("i18n: failed to find key: "+e);return n})}))},preload:function(t,n){var i,o,a,u,p,h,d;if(null==n&&(n=r),"debug"!==n){if(i=s,_.isString(t)&&(t=[t]),d=function(){var e,r,o;for(e=0,o=[],r=t.length;e<r;e++)h=t[e],i[n]||(i[n]={}),!i[n][h]&&o.push(h);return o}(),o=function(){var e,r,o,s;for(e=0,s=[],r=t.length;e<r;e++)h=t[e],(null!=(o=i[n][h])?o.state():void 0)==="pending"&&s.push(i[n][h]);return s}(),!d.length)return $.when.apply($,o);for(u=0,a=e.for_locale(n).fetch(d,l),p=d.length;u<p;u++)h=d[u],i[n][h]||(i[n][h]=a);return o.length?$.when.apply($,[a].concat(c.call(o))):a}},react_class:function(t){var e;return createReactClass({displayName:"i18n:"+t,getInitialState:((e=function(){var e;return(e=I.i18n.fetch_key_sync(t))?{text:e}:null}).isReactClassApproved=!0,e),componentWillUnmount:function(){return this.unmounted=!0},componentDidMount:function(){if(!(this.state&&this.state.text)){var e;return I.i18n.fetch_key(t).done((e=this,function(t){if(!e.unmounted)return e.setState({text:t})}))}},render:function(){return this.state?_.isString(this.state.text)?this.state.text:o(this.state.text,this.props):"…"}})}}}).call(this),(function(){var t;t=function(t){var e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g;return u=ReactDOMFactories.table,h=ReactDOMFactories.thead,c=ReactDOMFactories.tbody,m=ReactDOMFactories.tr,p=ReactDOMFactories.td,e=ReactDOMFactories.abbr,n=ReactDOMFactories.details,l=ReactDOMFactories.summary,i=ReactDOMFactories.div,o=ReactDOMFactories.h2,r=ReactDOMFactories.code,a=ReactDOMFactories.pre,s=ReactDOMFactories.p,d=t.query_log.length,f=t.query_log.reduce(function(t,e){return t+e[1]},0),R.Lightbox({className:"compact perf_query_log_widget",style:{width:"100%",maxWidth:"800px"}},o({},"Query log"),s({style:{margin:"0 10px"}},"Queries: ",r({},d),", Time: ",r({},(1e3*f).toFixed(2)+"ms")),i({style:{padding:"10px"}},u({className:"nice_table",style:{width:"100%"}},h({},m({},p({},"Query"),p({},"Timing"))),c({},t.query_log.map((g=this,function(t,e){var i,o,s;return i=t[0],o=1e3*(s=t[1]),m({key:e},p({},n({},l({},r({style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"600px"}},i)),a({style:{whiteSpace:"pre-wrap"}},i))),p({},r({style:{fontWeight:o>10?"bold":void 0,color:o>100?"white":o>50?"red":void 0,backgroundColor:o>100?"red":void 0}},o.toFixed(2)+"ms")))}))))))},I.PerfPanel=function(){function e(t){var e,r;t.layout_time||(t.layout_time=0),t.view_time||(t.view_time=0),t.db_time||(t.db_time=0),t.db_count||(t.db_count=0),e=_.template('<div class="perf_panel">\n  <div class="stat_row">\n    <strong>Queries:</strong> {{ db_count }}\n  </div>\n\n  <div class="stat_row">\n    <strong>Query time:</strong> {{ Math.floor(db_time * 1000) }}ms\n  </div>\n\n  <div class="stat_row">\n    <strong>View time:</strong> {{ Math.floor((view_time + layout_time) * 1000) }}ms\n  </div>\n\n  <div class="stat_row">\n    <strong>Rest:</strong> {{ Math.floor((total_time - (view_time + layout_time + db_time)) * 1000) }}ms\n  </div>\n\n</div>'),this.data=t,this.el=$(e(t)).appendTo(document.body),this.el.on("click",(r=this,function(){return r.render_queries()}))}return e.prototype.render_queries=function(){var e,r,n,i;if(this.data.query_log)return r=(function(){var t,r,i,o,s;for(t=0,i=this.data.query_log,s=[],r=i.length;t<r;t++)e=(o=i[t])[0],n=o[1],s.push({query:e,time:1e3*n});return s}).call(this),console.table(r),I.add_react().done((i=this,function(){if("undefined"!=typeof R&&null!==R?R.Lightbox:void 0)return I.Lightbox.open(t({query_log:i.data.query_log}))}))},e}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};I.GamePopups=function(){function e(e,r){var n,i,o,s;null==r&&(r={}),this.deferred_for_el=t(this.deferred_for_el,this),!I.is_mobile()&&(this.el=$(e),$.extend(this,r),n=$(document.body),this.el.on("mouseenter mouseleave",this.trigger_selector,(i=this,function(t){return(e=$(t.currentTarget)).closest(".jam_cell").length||e.closest(".disable_hover").length?void 0:"mouseenter"===t.type?i.enter(e):i.leave(e)})),n.on("i:hide_popups",(o=this,function(t,e){return o.close_popup()})),n.on("i:hide_other_popups",(s=this,function(t,e){if(e!==s)return s.close_popup()})))}return e.prototype.trigger_selector=".game_thumb",e.prototype.popup_selector=".popup_details",e.prototype.hover_delay=250,e.prototype.close_timeout=200,e.prototype.x_offset=0,e.prototype.deferred_for_el=function(t){var e,r,n,i;if(!(e=t.data("i:popup_defer"))){if(r=t.closest("[data-game_id]").data("game_id"),e=$.Deferred(),t.data("i:popup_defer",e),!r)return;n=I.subdomain?"/-/game/popup/"+r:"/game/popup/"+r,$.get(n,(i=this,function(t){var n;if(!_.isObject(t)||!t.errors)return(n=$(t)).data("object_id",r),I.tracked_links(n,"popups",I.page_name(),"click"),n.find("a").on("click",function(){var t;if(t=n.data("trigger_el"))return t.trigger("i:track_link")}),e.resolve(n)}))}return e},e.prototype.enter=function(t){var e,r,n,i;return t.data("i:inside",!0),r=_.debounce((n=this,function(){if(t.data("i:inside"))return n.deferred_for_el(t).then(function(e){return n.show_popup(t,e)})}),this.hover_delay),e=_.debounce((i=this,function(){var e;if(t.data("i:inside"))return e=new Date,i.deferred_for_el(t)}),this.hover_delay/2),t.on("mousemove.hover_manager",function(){return r(),e()})},e.prototype.leave=function(t){return t.data("i:inside",!1),t.off("mousemove.hover_manager")},e.prototype.show_popup=function(t,e){var r,n,i,o,s,a,l,u,c,p;if(("function"==typeof(r=document.body).contains?r.contains(t[0]):void 0)&&this.current_popup!==e){for(this.el.trigger("i:hide_other_popups",[this]),null!=(a=this.current_popup)&&a.stop().remove(),this.current_popup=e.css({left:"0px",top:"0px"}).removeClass("visible"),u=e.find(".popup_screenshot").removeClass("visible"),$(document.body).append(e),this.position_popup(t,e),_.defer((c=this,function(){return e.addClass("visible")})),e.data("trigger_el",t),n=(p=this,function(t){return setTimeout(function(){return t.addClass("visible")},100*i)}),i=o=0,s=u.length;o<s;i=++o)n($(l=u[i]));return e.hide().css({opacity:""}).fadeIn("fast"),this.watch_for_popup_close()}},e.prototype.watch_for_popup_close=function(){var t,e,r,n;return e=this.trigger_selector+", "+this.popup_selector,t=null,$(document.body).on("click.hover_manager",(r=this,function(t){var n;if(!(n=$(t.target)).closest(e).length)return r.close_popup()})),$(window).on("mousemove.hover_manager",_.throttle((n=this,function(r){var i;if((i=$(r.target).closest(e)).length){t&&(window.clearTimeout(t),t=null);return}if(!t)return t=window.setTimeout(function(){return n.close_popup()},n.close_timeout)}),50))},e.prototype.position_popup=function(t,e){var r,n,i,o,s,a,l;return i=t.offset(),l=e.outerWidth(!0),r=e.outerHeight(!0),e.removeClass("on_right"),o=t.outerHeight(),s=t.outerWidth(),a=i.top+(o-r)/2,(n=i.left-l)<0?(n=i.left+s,n+=this.x_offset,e.addClass("on_right")):n-=this.x_offset,e.css({top:Math.floor(a)+"px",left:Math.floor(n)+"px"})},e.prototype.close_popup=function(){var t;return $(window).off("mousemove.hover_manager"),$(document.body).off("click.hover_manager"),null!=(t=this.current_popup)&&t.stop(!0).remove(),this.current_popup=null},e}(),I.GamePopup=function(){function t(t){this.el=$(t),this.el.dispatch("click",{watch_trailer_btn:function(t){return I.event("grid",I.page_name(),"watch_trailer"),I.Lightbox.open_remote(t.data("lightbox_url"))}})}return t}(),I.WatchTrailerLightbox=function(){function t(t){var e;this.el=$(t),this.el.dispatch("click",{add_to_collection_btn:(e=this,function(t){return(I.event("grid","trailer","add_to_collection"),I.current_user)?I.Lightbox.open_remote(t.attr("href"),I.CollectionLightbox):"continue"})})}return t}()}).call(this),(function(){I.ReferrerTracker=function(){function t(){}return t.MAX_ITEMS=20,t.get_cookie=function(){return Cookies.getJSON("itchio_refs")||[]},t.write_cookie=function(t){return I.set_cookie("itchio_refs",t,{expires:14})},t.has_ref=function(e,r){var n,i,o,s,a,l;for(o=0,r=+r,s=(a=t.get_cookie()).length;o<s;o++)if(i=(l=a[o])[0],n=l[1],i===e&&n===r)return!0;return!1},t.push=function(e,r,n){var i,o;if(n&&n.length>0){for(r=+r,o=(function(){var t,n,o,s;for(t=0,o=this.get_cookie(),s=[],n=o.length;t<n;t++)((i=o[t])[0]!==e||i[1]!==r)&&s.push(i);return s}).call(t),I.in_dev&&console.log("pushing referrer",[e,r,n]),o.unshift([e,r,n]);o.length>t.MAX_ITEMS;)o.pop();return t.write_cookie(o)}},t}()}).call(this),(function(){I.SaleList=function(){function t(t){this.el=$(t),this.el.lazy_images({})}return t}()}).call(this),(function(){var t,e,r,n,i=function(t,e){return function(){return t.apply(e,arguments)}},o=[].slice,s=function(t,e){for(var r in e)a.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;I.prepare_upload=function(t,e,r,n){var i,o;return $.ajax({url:t+"/upload/prepare",type:"post",data:I.with_csrf(e),success:(i=this,function(t){return t.errors?"function"==typeof n?n(t.errors.join(",")):void 0:"function"==typeof r?r(t):void 0}),error:(o=this,function(t){return"function"==typeof n?n("Server error"):void 0})})},e=function(t){var e,r,n,i,o;return n=(e=new DataView(t,0,5)).getUint8(0,!0),i=e.getUint8(1,!0),r=n.toString(16)+i.toString(16),(o={8950:"image/png",4749:"image/gif","424d":"image/bmp",ffd8:"image/jpeg"})[r]},t="You selected an image type we don't recognize. It's possible it has the wrong file extension for the format it is saved as. Please use an image editing program to convert it to a PNG, JPEG, or GIF.",I.test_image_format=function(r){var n;return $.Deferred((n=this,function(n){var i;return window.FileReader?((i=new FileReader).readAsArrayBuffer(r),i.onerror=function(){return n.reject("Failed to read image from disk")},i.onload=function(){var r;return"image/bmp"===(r=e(i.result))?n.reject("You selected a BMP file that has a wrong extension. Please use an image editing program to convert it to a PNG, JPEG, or GIF."):r?n.resolve():n.reject(t)}):n.resolve()}))},I.image_dimensions=function(e){return $.Deferred(function(r){var n,i;return(i="undefined"!=typeof URL&&null!==URL&&"function"==typeof URL.createObjectURL?URL.createObjectURL(e):void 0)?((n=new Image).src=i,n.onload=function(){return r.resolve([n.width,n.height])},n.onerror=function(){return r.reject(t)}):r.reject(t)})},I.video_dimensions=function(t){return $.Deferred(function(e){var r,n;return(n=document.createElement("video"),r="undefined"!=typeof URL&&null!==URL&&"function"==typeof URL.createObjectURL?URL.createObjectURL(t):void 0)?(n.src=r,n.onloadedmetadata=function(){return e.resolve([n.videoWidth,n.videoHeight])},n.onerror=function(){return e.reject("Invalid video file")}):e.reject("Invalid video file")})},I.test_image_dimensions=function(t,e,r){var n;return null==e&&(e=3840),null==r&&(r=2160),I.image_dimensions(t).then((n=this,function(t){var n,i;return i=t[0],n=t[1],$.Deferred(function(t){return i>e||n>r?t.reject("Image is greater than the maximum dimensions of "+e+"x"+r+" (you selected a "+i+"x"+n+" image)"):t.resolve()})}))},I.Upload=function(){function t(t,e,r){this.editor=t,this.file=e,this.opts=r,this.start_xhr_upload=i(this.start_xhr_upload,this),this.decrement=i(this.decrement,this),this.increment=i(this.increment,this),this.save_upload=i(this.save_upload,this)}return t.prototype.error_message="There was a problem completing your upload. Try again. If the problem persists contact support.",t.prototype.label="file",t.prototype.kind="upload",t.prototype.upload_params=function(){return{kind:this.kind,filename:this.file.name}},t.prototype.save_upload=function(t){throw"override `save_upload`"},t.prototype.increment=function(){var t,e;if((t=this.constructor).active_uploads||(t.active_uploads=0),this.constructor.active_uploads++,1===this.constructor.active_uploads)return"function"==typeof(e=this.opts).start_uploading?e.start_uploading():void 0},t.prototype.decrement=function(){var t;if(this.constructor.active_uploads--,0===this.constructor.active_uploads)return"function"==typeof(t=this.opts).stop_uploading?t.stop_uploading():void 0},t.prototype.start_xhr_upload=function(t){var e,r,n,i,o,s,a,l,u;if(!this.upload_data)throw"missing upload data";for(r in this.increment(),e=new FormData,n=this.upload_data.post_params)i=n[r],e.append(r,i);return e.append("file",this.file),(o=new XMLHttpRequest).upload.addEventListener("progress",(s=this,function(t){if(t.lengthComputable)return"function"==typeof s.progress?s.progress(t.loaded,t.total):void 0})),o.upload.addEventListener("error",(a=this,function(t){return I.event("upload","xhr error",a.kind)})),o.upload.addEventListener("abort",(l=this,function(t){return I.event("upload","xhr abort",l.kind)})),o.addEventListener("readystatechange",(u=this,function(e){var r;if(4===o.readyState){if(u.decrement(),2===Math.floor(o.status/100))return I.event("upload","save",u.kind),"function"==typeof u.save_upload?u.save_upload(u.opts.finish_upload):void 0;if(r="Failed upload.",o.responseXML)try{r=o.responseXML.querySelector("Error Message").innerHTML}catch(n){e=n}else r=o.responseText;return I.event("upload_error","server error "+o.status+": "+r,u.kind),t("error: "+r)}})),o.open("POST",this.upload_data.action),o.send(e)},t.prototype.start_upload=function(t,e){var r,n,i;if(!this.upload_data)return r=(n=this,function(t){return n.error_message=t,"function"==typeof n.cancel_upload&&n.cancel_upload.apply(n,[n].concat(o.call(arguments))),"function"==typeof e?e.apply(null,[n].concat(o.call(arguments))):void 0}),this.editor.prepare_upload((i=this,function(){return I.prepare_upload(i.editor.upload_prefix(),i.upload_params(),function(t){return i.upload_data=t,"function"==typeof i.have_upload_data&&i.have_upload_data(),i.start_xhr_upload(r)},r)}),r)},t}(),I.ImageUpload=function(t){function e(){return this.save_url=i(this.save_url,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.success_params={},e.prototype.kind="image",e.prototype.label="image",e.prototype.save_url=function(){return this.editor.upload_prefix()+"/image/success/"+this.upload_data.upload_id},e.prototype.save_upload=function(t){var e;if(this.upload_data)return $.ajax({url:this.save_url()+"?"+$.param(this.success_params),type:"post",data:I.with_csrf(),success:(e=this,function(r){var n;if(n=e.success_params.type||e.kind,r.errors){I.event("upload_error",n,r.errors.join(", ")),e.cancel_upload?e.cancel_upload():alert(e.error_message);return}return t.apply(null,[e].concat(o.call(arguments)))})})},e.delete_image=function(t,e,r){return $.ajax({url:t.upload_prefix()+"/image/delete/"+e,type:"post",data:I.with_csrf(),success:r})},e}(I.Upload),I.pick_files=function(t){var e,r;return null==t&&(t={}),e=t.input?$(t.input):($("input.pick_files_input").remove(),$("<input type='file' class='pick_files_input' />").hide().insertAfter("body")),$.Deferred((r=this,function(r){return t.multiple&&e.attr("multiple",!0),t.accept&&e.attr("accept",t.accept),e.on("change",function(e){var n,i,o,s,a,l,u;for(a=function(){var t,r,n,i;for(t=0,n=e.target.files,i=[],r=n.length;t<r;t++)o=n[t],i.push(o);return i}(),i=[],"function"==typeof t.on_pick_files&&t.on_pick_files(a),l=0,u=a.length;l<u;l++)s=a[l],t.max_size&&s.size>t.max_size&&i.push(["You selected an image greater than the max size "+I.format_bytes(t.max_size)+" (you selected a "+I.format_bytes(s.size)+" file)",s]);if(i.length){r.reject(i,a);return}return t.test_file?(n=a.map(function(e){return $.Deferred(function(n){return t.test_file(e,n),setTimeout(function(){if("pending"===r.state())return n.reject("Timed out checking file, are you sure it was an image file?")},1e3)}).catch(function(t){throw[t,e]})}),$.when.apply($,n).done(function(t){return r.resolve(a)}).fail(function(t){return r.reject([t])})):r.resolve(a)}),e.click()}))},I.xhr_upload=(r=this,function(t,e){return $.Deferred(function(r){var n,i,o,s,a;for(i in n=new FormData,o=e.post_params)s=o[i],n.append(i,s);return n.append("file",t),(a=new XMLHttpRequest).upload.addEventListener("progress",function(t){if(t.lengthComputable)return r.notify("progress",t.loaded,t.total)}),a.upload.addEventListener("error",function(t){return r.reject("xhr error")}),a.upload.addEventListener("abort",function(t){return r.reject("xhr aborted")}),a.addEventListener("readystatechange",function(t){var e;if(4===a.readyState){if(2===Math.floor(a.status/100))return r.resolve();if(e="Failed upload.",a.responseXML)try{e=a.responseXML.querySelector("Error Message").innerHTML}catch(n){t=n}else e=a.responseText;return r.reject(e)}}),a.open("POST",e.action),a.send(n)})}),I.upload_image=function(t){return null==t&&(t={}),t.accept||(t.accept="image/png,image/jpeg,image/gif"),t.file_params=function(t){var e,r;return"video/mp4"===t.type?I.video_dimensions(t).then((e=this,function(t){var e,r;return{width:r=t[0],height:e=t[1]}})):I.image_dimensions(t).then((r=this,function(t){var e,r;return{width:r=t[0],height:e=t[1]}}))},I.upload_file(t)},I.upload_file=(n=this,function(t){var e,r,n,i,o,s;if(null==t&&(t={}),!t.url)throw Error("missing url for upload image");return e=t.accept,r=t.max_size,n=t.multiple,i=t.on_pick_files,o=t.on_start_upload,s=t.test_file,I.pick_files({accept:e,max_size:r,multiple:n,test_file:s,on_pick_files:i}).then(function(e){var r,i;if(!n&&e.length>1)throw"Got multiple files for single upload";return(i=function(){var n,i,s,a;for(n=0,s=e.slice(0,6),a=[],i=s.length;n<i;n++)r=s[n],a.push(function(e){var r,n;return r=t.file_params?t.file_params(e):{},$.when(r).then((n=this,function(r){return $.ajax({url:t.url,type:"post",xhrFields:{withCredentials:!0},data:I.with_csrf($.extend({filename:e.name,thumb_size:t.thumb_size,action:"prepare"},r))}).then(function(t){var r;return t.errors?$.Deferred().reject(t.errors):(r=I.xhr_upload(e,t).then(function(){return $.ajax({url:t.success_url,type:"post",xhrFields:{withCredentials:!0},data:I.with_csrf()})}),"function"==typeof o&&o(e,t,r),r)})}))}(r));return a}(),n)?$.when.apply($,i):i[0]})}),I.make_upload_button=function(t,e,r,n){var i,o,s;return null==n&&(n={}),i=null,o=e.data("max_size"),e.on("click",(s=this,function(s){var a,l;return i&&i.remove(),i=$("<input type='file' multiple />").hide().insertAfter(e),(a=e.data("accept"))&&i.attr("accept",a),l=r.prototype.kind,I.event("upload","open",l),i.on("change",function(){var e,s,a,u,c,p;for(a=0,c=i[0].files,p=[],u=c.length;a<u;a++){if(e=c[a],null!=o&&e.size>o){I.flash(e.name+" is greater than max size of "+I.format_bytes(o),"error");continue}s=new r(t,e,n),n.cancel_upload&&(s.cancel_upload=n.cancel_upload),s.start_upload(),"function"==typeof n.queue_upload&&n.queue_upload(s),p.push(I.event("upload","start",l))}return p}),i.insertAfter(e),i.click()}))},I.make_fake_upload_button=function(t,e,r,n){return null==n&&(n={}),e.on("click",function(e){var i;return(i=new r(t,{size:851520,name:"The file that I am uploading.zip",type:".zip"},n)).save_upload=function(t){return i.after_save(),"function"==typeof t?t(this):void 0},i.start_upload=function(t,e){var r,o;return i.upload_data={upload_id:-1},"function"==typeof i.have_upload_data&&i.have_upload_data(),o=0,(r=function(){return(o+=Math.floor(2e4*Math.random())+500)>=i.file.size?"function"==typeof i.save_upload?i.save_upload(n.finish_upload):void 0:(i.progress(o,i.file.size),setTimeout(r,50))})()},"function"==typeof n.queue_upload&&n.queue_upload(i),i.start_upload()})},I.make_popup_upload_button=function(t,e,r,n){var i,o,s,a;if(!t.upload_prefix)throw"Upload button parent must have `upload_prefix` method";return o=0,s=function(t){return 0===(o+=t)?"function"==typeof n.stop_uploading?n.stop_uploading():void 0:"function"==typeof n.start_uploading?n.start_uploading():void 0},i=function(e){var i,o,a,l,u,c,p,h,d;return e.preventDefault(),"image"===(u=r.prototype.kind)&&(u=(null!=(o=r.prototype.success_params)?o.type:void 0)||u),c=t.upload_prefix()+"/upload?type="+u,(l=null!=(a=r.prototype.success_params)?a.thumb_size:void 0)&&(c+="&thumb_size="+l),i=I.Lightbox.open_tpl("upload_lightbox",I.UploadLightbox,c,r.prototype.label),p=null,I.event("upload","open",u),i.el.on("i:lightbox_close",(h=this,function(){return $(document).off("i:upload_popup_msg")})),$(document).on("i:upload_popup_msg",(d=this,function(e,o){switch(o.type){case"save_upload":if(!p)throw"no uploader";return $(document).off("i:upload_popup_msg"),I.event("upload","save",u),s(-1),"function"==typeof n.finish_upload&&n.finish_upload(p,o.data),"function"==typeof p.after_save&&p.after_save(),p=null,i.closable=!0,I.Lightbox.close();case"start_upload":if(p)throw"upload already started";return I.event("upload","start",u),i.closable=!1,i.el.addClass("not_closable"),(p=new r(t,{size:o.size,name:o.name},{})).upload_data=o.data,"function"==typeof p.have_upload_data&&p.have_upload_data(),"function"==typeof n.queue_upload&&n.queue_upload(p),s(1),"function"==typeof p.progress&&p.progress(1,1),p.start_upload=function(){},p.save_upload=function(){}}}))},e.on("click",(a=this,function(e){return t.prepare_upload?t.prepare_upload(function(){return i(e)}):i(e)}))},I.prepare_download=function(t,e,r,n,i){var o;return null==i&&(i={}),r&&(i.key=r),I.add_react(),I.proxy_downloads&&(i.proxy=!0),$.ajax({url:"/"+t+"/file/"+e+"?"+$.param(i),type:"post",data:I.with_csrf(),success:(o=this,function(t){var e;if(t.errors){e=t.errors.join(","),I.event("game_download","error",e),R.ErrorLightbox?I.Lightbox.open(R.ErrorLightbox({errors:t.errors})):alert(e);return}return"function"==typeof n?n(t.url,t):void 0})})},I.start_download=function(t){var e;return!!t.url&&(_.defer((e=this,function(){var e,r;if(t.external){window.open(t.url);return}return(r=(e=window.location.protocol.match("/^https\b"))&&!url.match(/^https\b/))?window.location=t.url:I.is_ios()?window.open(t.url):$('<iframe frameborder="0" style="width: 0; height: 0; visibility: hidden;"></iframe>').attr("src",t.url).appendTo(document.body)})),!0)},I.UploadLightbox=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.init=function(t,e){if(this.iframe=this.el.find("iframe").attr("src",t),e)return this.el.find(".label").text(e)},e}(I.Lightbox)}).call(this),(function(){I.VideoEmbed=function(){function t(t){var e;this.el=$(t),this.el.lazy_images({selector:".video_drop",show_item:(e=this,function(t){return t.replaceWith(t.data("template"))})})}return t}()}).call(this),(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;I.BuyGameLightbox=function(r){function n(){return this.load_fingerprint=t(this.load_fingerprint,this),n.__super__.constructor.apply(this,arguments)}return e(n,r),n.prototype.init=function(t,e){var r,n,i,o;return this.game=t,this.buy=new I.BuyForm(this.el,this.game,e),this.buy.event_category=e.event_category||"view_game",this.buy.submit_handler=this.buy.remote_submit,this.load_fingerprint((r=this,function(){return r.buy.set_fingerprint()})),this.el.on("i:loading",(n=this,function(t,e){return n.closable=!e})),this.el.on("i:buy_start",(i=this,function(t,e){var r,n,i,o,s,a,l,u;for(n=0,l=null,r=null,a=[],i=e.length;n<i;n++)switch(o=(s=e[n]).name,u=s.value,o){case"source":a.push(l=u);break;case"price":a.push(r=u);break;default:a.push(void 0)}return a})),this.el.on("i:buy_complete",(o=this,function(t){return o.closable=!0,I.Lightbox.close()}))},n.prototype.load_fingerprint=function(t){var e;if(window.Fingerprint2){"function"==typeof t&&t();return}if(e=this.el.data("checkout"))return $(document.body).append(e),I.wait_for_object(window,"Fingerprint2",t)},n}(I.Lightbox)}).call(this),(function(){var t=function(t,r){for(var n in r)e.call(r,n)&&(t[n]=r[n]);function i(){this.constructor=t}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t},e={}.hasOwnProperty;I.PickImageLightbox=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.init=function(t){var e,r,n;return this.el.dispatch("click",{tab_btn:(e=this,function(t){var r;return r=t.data("tab"),e.el.find(".tab_content").hide().filter("[data-tab="+r+"]").show(),e.el.find(".tab_btn").removeClass("selected").filter(t).addClass("selected")}),pick_image_btn:(r=this,function(e){return"function"==typeof t?t(e.data("url")):void 0}),upload_image_btn:(n=this,function(e){return I.upload_image({url:I.root_url("dashboard/upload-image"),thumb_size:"original"}).progress(function(){if(!e.prop("disabled"))return e.prop("disabled",!0).addClass("disabled"),e.data("original_text",e.text()),e.text("Uploading...")}).fail(function(){return e.prop("disabled",!1).removeClass("disabled"),e.text(e.data("original_text"))}).done(function(r){var n,i;return(e.prop("disabled",!1).removeClass("disabled"),e.text(e.data("original_text")),r.success)?"function"==typeof t?t(r.upload.thumb_url):void 0:(n=(null!=(i=r.errors)?i[0]:void 0)||"Image upload failed",I.flash(n,"error"))})})})},r}(I.Lightbox)}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B=[].slice;s=(e=ReactDOMFactories).div,F=e.span,r=e.a,n=e.br,T=e.p,C=e.ol,M=e.ul,x=e.li,D=e.strong,a=e.em,y=e.img,u=e.form,w=e.label,b=e.input,j=e.textarea,i=e.button,v=e.iframe,p=e.h1,h=e.h2,d=e.h3,f=e.h4,m=e.h5,g=e.h6,N=e.pre,o=e.code,E=e.select,z=e.option,L=e.section,S=e.optgroup,l=e.fieldset,k=e.legend,(c=React.createElement.bind(null,React.Fragment)).type=React.fragment,(t=R.package("Forms"))("FileUploader",{propTypes:{label:(P=PropTypes).string,upload:P.shape({id:P.number,url:P.string}),upload_func:P.func},getInitialState:function(){return{upload:this.props.upload}},componentDidMount:function(){var t,e;return this.dispatch({delete_upload:(t=this,function(e){return t.setState({loading:!0}),$.ajax({url:t.state.upload.url,type:"post",data:I.with_csrf({action:"delete",upload_id:t.state.upload.id})}).done(function(e){if(e.errors){alert(e.errors.join());return}return t.setState({loading:!1,upload:null})})}),pick_file:(e=this,function(t){if(!e.state.uploading&&!e.state.loading)return(e.props.upload_func||I.upload_file)({url:e.props.upload_url,on_start_upload:function(){if(!e.state.uploading)return e.setState({uploading:!0})}}).progress(function(t,r,n){if(console.warn.apply(console,arguments),"progress"===t)return e.setState({progress:r/n})}).fail(function(){return e.setState({uploading:!1}),console.error.apply(console,["upload failed"].concat(B.call(arguments)))}).done(function(t){return e.setState({uploading:!1,upload:t.upload})})})})},render_preview_upload:function(){return this.props.render_preview_upload?this.props.render_preview_upload():F({className:"upload_filename"},this.state.upload.filename)},render:function(){var t,e,n,o;return e=this.state.uploading?"Uploading"+(this.state.progress&&" ("+Math.floor(100*this.state.progress)+"%)"||""):this.state.loading?"Loading...":this.props.label?this.props.label:this.state.upload?"Replace upload":"Upload",s({className:"file_uploader"},i({className:classNames("button",{disabled:t=this.state.uploading||this.state.loading}),disabled:t,onClick:(n=this,function(t){return t.preventDefault(),n.trigger("pick_file")})},e)," ",this.state.upload?b({type:"hidden",name:this.props.name,value:this.state.upload.id}):void 0,this.state.upload&&!this.state.loading?r({href:"#",onClick:(o=this,function(t){return t.preventDefault(),o.trigger("delete_upload")})},"Remove upload"):void 0,this.state.upload?this.render_preview_upload():void 0)}})})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P;o=(t=ReactDOMFactories).div,E=t.span,e=t.a,r=t.br,z=t.p,x=t.ol,P=t.ul,k=t.li,F=t.strong,s=t.em,v=t.img,l=t.form,b=t.label,y=t.input,D=t.textarea,n=t.button,g=t.iframe,c=t.h1,p=t.h2,h=t.h3,d=t.h4,f=t.h5,m=t.h6,T=t.pre,i=t.code,L=t.select,S=t.option,N=t.section,C=t.optgroup,a=t.fieldset,w=t.legend,(u=React.createElement.bind(null,React.Fragment)).type=React.fragment,R("FollowButton",{propTypes:{following:(j=PropTypes).bool,show_name:j.bool,name:j.string,login_url:j.string,user_id:j.number,follow_data:j.object,follow_url:j.string.isRequired,unfollow_url:j.string.isRequired},getInitialState:function(){return{following:this.props.following}},getDefaultProps:function(){return{show_name:!0}},componentDidUpdate:function(t,e){if(!e.animate_class&&this.state.animate_class){var r;return this.timer&&(window.clearTimeout(this.timer),delete this.timer),this.timer=setTimeout((r=this,function(){return r.setState({animate_class:null})}),500)}},componentWillUnmount:function(){if(this.timer)return window.clearTimeout(this.timer),delete this.timer},render:function(){var t,e,r,n;return t=this.state.following?this.state.hovering?this.props.show_name?this.tt("misc.follow_button.unfollow_username",{username:this.props.name}):this.tt("misc.follow_button.unfollow"):React.createElement(React.Fragment,{},E({className:"icon icon-checkmark","aria-hidden":!0,role:"img"}),this.props.show_name?this.tt("misc.follow_button.following_username",{username:this.props.name}):this.tt("misc.follow_button.following")):React.createElement(React.Fragment,{},E({className:"icon icon-plus","aria-hidden":!0,role:"img"}),this.props.show_name?this.tt("misc.follow_button.follow_username",{username:this.props.name}):this.tt("misc.follow_button.follow")),this.enclose({component:this.props.login_url?"a":"button",href:this.props.login_url,"data-label":"follow_btn",className:classNames("button",{is_following:this.state.following,disabled:this.state.loading},this.state.animate_class,this.props.className),onMouseEnter:(e=this,function(){return e.setState({hovering:!0})}),onMouseLeave:(r=this,function(){return r.setState({hovering:!1})}),target:this.props.target,onClick:(n=this,function(t){var e,r;if(!n.props.login_url&&!n.state.loading)return t.preventDefault(),e=$(t.target),n.setState({loading:!0,animate_class:null}),n.container().trigger("i:track_link"),r=n.state.following?n.props.unfollow_url:n.props.follow_url,$.post(r,I.with_csrf(n.props.follow_data),function(t){if(t.errors){I.flash(t.errors.join(", ")),n.setState({loading:!1});return}return e.trigger("i:follow_updated",[{user_id:n.props.user_id,following:t.following,btn:e}]),n.setState({following:t.following,animate_class:t.following?"animate_bounce":"animate_drop_down",loading:!1},function(){var t;return"function"==typeof(t=n.props).on_follow_change?t.on_follow_change(n.state.following):void 0})})})},t)}})})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B,q,U=[].slice;l=(r=ReactDOMFactories).div,j=r.span,n=r.a,i=r.br,L=r.p,z=r.ol,q=r.ul,S=r.li,P=r.strong,u=r.em,w=r.img,p=r.form,x=r.label,k=r.input,M=r.textarea,o=r.button,b=r.iframe,d=r.h1,f=r.h2,m=r.h3,g=r.h4,v=r.h5,y=r.h6,E=r.pre,a=r.code,D=r.select,N=r.option,F=r.section,T=r.optgroup,c=r.fieldset,C=r.legend,(h=React.createElement.bind(null,React.Fragment)).type=React.fragment,!R.Redactor&&(s=(t=this,function(){return R.component.apply(R,arguments)}),B=PropTypes,s("Redactor",{pure:!0,componentDidMount:function(){var t,e;return(t=$.extend({minHeight:80,source:!1},this.props.redactor_opts)).callbacks||(t.callbacks={}),t.callbacks.change=(e=this,function(t){var r;if("function"==typeof(r=e.props).on_change&&r.on_change(t),e.props.remember_key)return e.set_memory||(e.set_memory=_.throttle(function(t){return I.store_memory(this.remember_key(),t)},500)),e.set_memory(t)}),I.redactor($(ReactDOM.findDOMNode(this)),t)},remember_key:function(){return"inputmemory:"+this.props.remember_key},clear_memory:function(){return I.clear_memory(this.remember_key())},get_default_value:function(){var t;if((t=this.props.defaultValue)||this.props.remember_key&&(t="undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem(this.remember_key()):void 0))return t},render:function(){return M({name:this.props.name,value:this.props.value,defaultValue:this.get_default_value(),placeholder:this.props.placeholder,required:this.props.required,autoFocus:this.props.autofocus})}}),s("CSRF",{pure:!0,render:function(){return k({type:"hidden",name:"csrf_token",value:$("meta[name=csrf_token]").attr("value")})}}),R.DownTickIcon=React.createElement("svg",{className:"svgicon icon_down_tick2",strokeLinecap:"round",stroke:"currentColor",role:"img",version:"1.1",viewBox:"0 0 24 24",strokeWidth:"2",width:"22",height:"22",strokeLinejoin:"round","aria-hidden":!0,fill:"none"},React.createElement("polyline",{points:"6 9 12 15 18 9"})),(e=R.package("Forms"))("InputRow",{pure:!0,propTypes:{title:B.string,sub:B.any},render:function(){var t;return t=React.createElement(React.Fragment,{},l({className:"label",key:"label"},this.props.title,this.props.sub?j({className:"sub"}," — ",this.props.sub):void 0),this.props.children),this.props.multi||(t=x({children:t})),l({className:classNames("input_row",this.props.className),id:this.props.id},t)}}),e("TextInputRow",{pure:!0,propTypes:{title:B.string,sub:B.any,name:B.string.isRequired,value:B.any},focus:function(){return this.input_ref.current.focus()},get_input_el:function(){return this.input_ref.current},get_value:function(){return this.input_ref.current.value},componentDidMount:function(){var t,e;if(this.props.money_input){if(!this.props.currency)throw Error("missing currency");I.money_input(this.input_ref.current,{currency:this.props.currency})}if(this.props.slug_input&&I.slug_input($(this.input_ref.current)),this.props.integer_input)return t=/[0-9]/g,$(this.input_ref.current).on("keypress",(e=this,function(e){var r;if(e.keyCode>=32&&!(r=String.fromCharCode(e.keyCode)).match(t))return!1}))},render:function(){var t;return t=[l({className:"label",key:"label"},this.props.title,this.props.sub?j({className:"sub"}," — ",this.props.sub):void 0),k({type:"text",key:"input",name:this.props.name,ref:this.input_ref||(this.input_ref=React.createRef()),value:this.props.value,defaultValue:this.props.defaultValue,onChange:this.props.onChange,onKeyUp:this.props.onKeyUp,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onClick:this.props.onClick,readOnly:this.props.readonly,className:classNames({has_error:this.props.has_error}),required:this.props.required,placeholder:this.props.placeholder,disabled:this.props.disabled,pattern:this.props.pattern}),this.props.error_message?L({key:"error",className:"input_error"},this.props.error_message):void 0],this.props.multi||(t=x({children:t})),l({className:classNames("input_row",this.props.className)},t)}}),e("SimpleSelect",{pure:!0,propTypes:{options:B.array.isRequired,name:B.string},getInitialState:function(){return{value:this.props.defaultValue?this.props.defaultValue:void 0}},render:function(){var t,e,r,n,i,o,s,a,u;return e=this.current_option(),(i=this.props.render_current_option)||(i=(o=this,function(t){return t.short_name||t.name})),t=[],r=null,n=function(){if(r)return t.push(T.apply(null,[{label:r.label,key:"group-"+t.length}].concat(U.call(r.children)))),r=null},this.props.options.map((s=this,function(e,i){var o;return(o=N({key:""+i,value:e.value},e.name),e.group)?((null!=r?r.label:void 0)!==e.group&&n(),r||(r={label:e.group,children:[]}),r.children.push(o)):(n(),t.push(o))})),n(),this.enclose({className:classNames({focused:this.state.focused,disabled:this.props.disabled,has_value:e!==this.props.options[0]})},l({className:"selected_option"},j({className:"selected_option_name"},i(e)),R.DownTickIcon),D({ref:this.select_ref||(this.select_ref=React.createRef()),disabled:this.props.disabled,value:e.value,name:this.props.name,onFocus:(a=this,function(t){return a.setState({focused:!0})}),onBlur:(u=this,function(t){return u.setState({focused:!1})}),onChange:this.on_change,children:t}))},on_change:function(t){var e;if(e=t.target.value,this.props.onChange){if(e===this.props.value)return;return this.props.onChange(e)}if(e!==this.state.value)return this.setState({value:e})},find_option:function(t){var e,r,n,i;for(e=0,r=(i=this.props.options).length;e<r;e++)if((n=i[e]).value===t)return n},current_option:function(){var t,e;return(t=null!=(e=this.props.value||this.state.value)?this.find_option(e):void 0)||this.props.options[0]}}),e("Select",{propTypes:{name:B.string.isRequired,value:B.any,options:B.array.isRequired},componentDidMount:function(){var t,e,r;if(this.props.selectize&&(e=!0===this.props.selectize?{}:this.props.selectize,(t=$(this.refs.input)).selectize(e),this.props.onChange))return t.on("change",(r=this,function(t){return r.props.onChange(t)}))},render:function(){var t;return D({ref:"input",name:this.props.name,onChange:this.props.onChange,value:this.props.value,defaultValue:this.props.defaultValue,children:this.props.options.map((t=this,function(t){var e,r;return N({key:r=t[0],value:r},(e=t[1])||r)}))})}}),e("RadioButtons",{propTypes:{name:B.string.isRequired,value:B.any,options:B.array.isRequired},getValue:function(){var t,e,r,n,i,o;for(t=0,e=(n=this.container().find("input").serializeArray()).length;t<e;t++)return r=(i=n[t]).name,o=i.value},render:function(){var t;return q({className:"radio_list",children:this.props.options.map((t=this,function(e,r){var n,i,o,s;return s=e[0],n=e[1],o=e[2],S({key:null!=s?s:r,className:classNames({disabled:null!=(i=e[3])?i.disabled:void 0})},x({},k($.extend({type:"radio",name:t.props.name,value:s,defaultChecked:t.props.defaultValue?s===t.props.defaultValue:void 0,checked:null!=t.props.value?s===t.props.value:void 0,onChange:t.props.onChange},i)),j({className:"radio_label"},n),o?j({className:"sub"}," — ",o):void 0))}))})}}),e("Slider",{pure:!0,propTypes:{min:B.number,max:B.number,value:B.number,onChange:B.func,disabled:B.bool},getInitialState:function(){return{}},on_change:function(t){if(t=Math.round(t),this.props.onChange){if(this.props.value===t)return;return this.props.onChange(t)}if(this.state.value!==t)return this.setState({value:t})},start_drag:function(t,e){var r,n,i,o,s,a;if(!this.props.disabled)return o=this.refs.track.clientWidth,n=this.current_value(),this.setState({dragging:!0}),r=(s=this,function(e){var r,a,l,u;if(e.preventDefault(),0===e.buttons){i();return}if(l=e.pageX,u=e.pageX,a=(r=l-t)/o*(s.props.max-s.props.min)+n,(a=Math.min(s.props.max,Math.max(s.props.min,a)))!==s.current_value())return s.on_change(a)}),i=(a=this,function(t){return null!=t&&t.preventDefault(),a.setState({dragging:!1}),document.body.removeEventListener("mousemove",r),document.body.removeEventListener("mouseup",i),delete a.up_listener}),document.body.addEventListener("mousemove",r),document.body.addEventListener("mouseup",i),this.up_listener=i},current_value:function(){return"value"in this.state?this.state.value||this.props.min:this.props.value||this.props.min},percent:function(){return(this.current_value()-this.props.min)/(this.props.max-this.props.min)},componentWillUnmount:function(){if(this.up_listener)return this.up_listener()},render:function(){var t,e,r,n,i,s;return t={left:100*this.percent()+"%"},this.enclose({className:classNames("slider_input",{disabled:this.props.disabled}),onClick:(e=this,function(t){var r,n;if(t.target!==e.refs.slider_nub&&(L=Math.min((n=e.refs.track.getBoundingClientRect()).width,Math.max(0,t.pageX-n.left))/n.width,r=e.props.min+L*(e.props.max-e.props.min),(r=Math.min(e.props.max,Math.max(e.props.min,r)))!==e.current_value()))return e.on_change(r)})},this.props.name?k({type:"hidden",name:this.props.name,value:this.current_value()}):void 0,l({ref:"track",className:"slider_track"},l({className:"slider_fill",style:{width:100*this.percent()+"%"}}),this.state.focused&&this.props.show_tooltip?l({style:t,className:"value_tooltip"},this.current_value()):void 0,o({type:"button",ref:"slider_nub",className:"slider_nub",onFocus:(r=this,function(){return r.setState({focused:!0})}),onBlur:(n=this,function(){return n.setState({focused:!1})}),onMouseDown:(i=this,function(t){return i.start_drag(t.pageX,t.pageY)}),onKeyDown:(s=this,function(t){switch(t.keyCode){case 37:s.on_change(Math.max(s.props.min,s.current_value()-1));break;case 39:s.on_change(Math.min(s.props.max,s.current_value()+1));break;default:return}return t.preventDefault()}),style:t})))}}),e("FilterPicker",{pure:!0,componentWillUnmount:function(){return $(window).off("click",this.window_click_listener)},getDefaultProps:function(){return{label_padding:3}},getInitialState:function(){return{open:!1}},close_picker:function(){if(this.state.open)return this.setState({open:!1,popup_visible:!1}),$(window).off("click",this.window_click_listener)},open_picker:function(){var t,e,r,n;return e=(t=this.open_button_ref.current).getBoundingClientRect(),this.window_click_listener&&$(window).off("click",this.window_click_listener),this.window_click_listener=(r=this,function(t){if(!(s=$(t.target).closest(r.container())).length)return r.close_picker()}),$(window).on("click",this.window_click_listener),this.setState({open:!0,top:-this.props.label_padding,left:-this.props.label_padding,height:e.height+2*this.props.label_padding},(n=this,function(){return n.filter_popup_ref.current.focus(),_.defer(function(){if(n.window_click_listener&&n.state.open)return n.setState({popup_visible:!0})})}))},render:function(){var t;return this.enclose({className:classNames("filter_picker_widget",{open:this.state.open,popup_visible:this.state.popup_visible}),onKeyDown:this.state.open?(t=this,function(e){if(27===e.keyCode)return t.close_picker()}):void 0},o({type:"button",className:"filter_value",ref:this.open_button_ref||(this.open_button_ref=React.createRef()),onClick:this.state.open?this.close_picker:this.open_picker},j({className:"value_label"},this.props.label),R.DownTickIcon),l({tabIndex:-1,ref:this.filter_popup_ref||(this.filter_popup_ref=React.createRef()),className:"filter_popup",style:{top:(this.state.top||0)+"px",left:(this.state.left||0)+"px"}},l({style:{marginTop:(this.state.height||0)+"px"},className:"filter_options"},this.props.render_children?this.state.open?this.props.render_children():void 0:this.props.children)))}}),e("StarPicker",{pure:!0,getDefaultProps:function(){return{total_stars:5,star_filled:"icon-star",star_empty:"icon-star2"}},getInitialState:function(){return{}},set_value:function(t){var e;return this.props.set_value?this.props.set_value(t):this.setState({value:t}),"function"==typeof(e=this.props).on_change?e.on_change(t):void 0},render:function(){var t,e,r,n,i,s,a;return a=null!=(r=null!=(n=null!=(i=this.props.value)?i:this.state.value)?n:this.props.defaultValue)?r:0,t=this.state.preview_value||a,s=(function(){var r,n,i;for(i=[],e=r=1,n=this.props.total_stars;1<=n?r<=n:r>=n;e=1<=n?++r:--r)i.push((function(e){return function(r){var n,i,s;return n=r>t?"star icon "+e.props.star_empty:"star icon "+e.props.star_filled,i=a===r,s=r+" Star"+(1===r?"":"s"),o({key:"star-"+r,type:"button",title:s,role:"radio","aria-describedby":e.props["aria-describedby"],"aria-label":s,"aria-checked":i?"true":"false",onMouseEnter:function(){return e.setState({preview_value:r})},onMouseLeave:function(){return e.setState({preview_value:null})},onClick:function(){return e.set_value(r)}},j({className:n}))}})(this)(e));return i}).call(this),this.enclose({"aria-labelledby":this.props["aria-labelledby"],role:"radiogroup",className:classNames(this.props.className,{interactive:!0,previewing:null!=this.state.preview_value,has_value:a>0})},this.props.name?k({type:"hidden",name:this.props.name,value:a>0?a:""}):void 0,s)}}),e("EditableInput",{getInitialState:function(){return{value:null,edit_value:null}},componentDidUpdate:function(t){var e;if(e=this.state.value?this.state.value:this.props.value,this.props.value!==e)return this.setState({value:this.props.value,edit_value:null})},confirm_edit:function(){if(this.state.edit_value)return this.setValue(this.state.edit_value)},cancel_edit:function(){return this.setState({edit_value:null})},setValue:function(t){var e;return this.setState({value:t,edit_value:null}),"function"==typeof(e=this.props).onUpdate?e.onUpdate(t):void 0},render:function(){var t,e,r,n,i;return k({type:null!=(t=this.props.type)?t:"text",className:this.props.className,name:this.props.name,title:this.props.title,readOnly:this.props.readonly,required:this.props.required,placeholder:this.props.placeholder,disabled:this.props.disabled,pattern:this.props.pattern,value:null!==this.state.edit_value?this.state.edit_value:null!==this.state.value?this.state.value:this.props.value,onKeyDown:(e=this,function(t){if(27===t.keyCode&&(e.cancel_edit(),t.stopPropagation()),13===t.keyCode)return e.confirm_edit(),t.stopPropagation()}),onFocus:(r=this,function(t){return t.target.select()}),onBlur:(n=this,function(t){return n.confirm_edit()}),onChange:(i=this,function(t){return i.setState({edit_value:t.target.value})})})}}),e("FocusButton",{pure:!0,getInitialState:function(){return{focused:!1}},componentWillUnmount:function(){var t;if(this.state.focused)return"function"==typeof(t=this.props).on_decrement_focus?t.on_decrement_focus():void 0},on_focus:function(){var t;return this.setState({focused:!0}),"function"==typeof(t=this.props).on_increment_focus?t.on_increment_focus():void 0},on_blur:function(){var t;return this.setState({focused:!1}),"function"==typeof(t=this.props).on_decrement_focus?t.on_decrement_focus():void 0},render:function(){var t;return delete(t=$.extend({onFocus:this.on_focus,onBlur:this.on_blur},this.props)).on_increment_focus,delete t.on_decrement_focus,o(t)}}),e("FormErrors",{pure:!0,getDefaultProps:function(){return{animated:!1,scroll_into_view:!1}},propTypes:{title:B.string,errors:B.array.isRequired},render:function(){var t,e;return(t=(function(){if(!this.props.animated)return F;if(!R.SlideDown)throw Error("Attempted to render animated errors without R.SlideDown");return R.SlideDown}).call(this))({className:classNames(this.enclosing_class_name(),"form_errors"),role:"alert"},l({ref:this.props.scroll_into_view?function(t){if(t)return"function"==typeof t.scrollIntoView?t.scrollIntoView():void 0}:void 0},!1!==this.props.title?L({},P({},this.props.title||this.tt("misc.forms.form_errors"))):void 0,q({},this.props.errors.map((e=this,function(t){var e;return e="recaptcha"===t?"Please complete the CAPTCHA to continue":t,S({key:t},e)}))),this.props.children))}}),e("RecaptchaInput",{propTypes:{sitekey:B.string.isRequired},componentDidMount:function(){var t;return I.with_recaptcha((t=this,function(){var e;return I.event("recaptcha","show",I.page_name()),e=ReactDOM.findDOMNode(t),grecaptcha.render(e,{sitekey:t.props.sitekey})}))},render:function(){return l({className:"g-recaptcha"})}}))})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B;s=(e=ReactDOMFactories).div,D=e.span,r=e.a,n=e.br,T=e.p,C=e.ol,B=e.ul,x=e.li,j=e.strong,a=e.em,y=e.img,u=e.form,w=e.label,b=e.input,P=e.textarea,i=e.button,v=e.iframe,p=e.h1,h=e.h2,d=e.h3,f=e.h4,m=e.h5,g=e.h6,N=e.pre,o=e.code,F=e.select,z=e.option,E=e.section,S=e.optgroup,l=e.fieldset,k=e.legend,(c=React.createElement.bind(null,React.Fragment)).type=React.fragment,(null==(L=R.Forms)||!L.ColorWheel)&&(t=R.package("Forms"),M=PropTypes,t("PortalElement",{getInitialState:function(){return this.el=document.createElement("div"),$(this.el).addClass("portal_element"),{}},componentDidMount:function(){return this.props.container_el.appendChild(this.el)},componentWillUnmount:function(){return this.props.container_el.removeChild(this.el)},render:function(){return ReactDOM.createPortal(this.props.children,this.el)}}),t("ColorWheel",{render:function(){var t,e,r,n,i,o,a,l,u,c,p;return(null!=(n=this.state)?n.color:void 0)&&!this.props.onChange?(t=(i=this.state.color)[0],a=i[1],e=i[2]):this.props.color&&(t=(o=this.props.color)[0],a=o[1],e=o[2]),null==t&&(t=0),null==a&&(a=50),null==e&&(e=100),l=Math.cos(r=(t-90)/180*Math.PI),u=Math.sin(r),this.enclose({},s({className:"color_block",style:{background:"hsl("+t+", 100%, 50%)",width:"101px",height:"101px"}}),s({className:"wheel",style:{width:"195px",height:"195px"},onMouseDown:(c=this,function(t){return t.preventDefault(),c.start_drag(t,t.target,function(t,r){var n,i;return l=(t-.5)*2,i=((n=Math.atan2(u=(r-.5)*2,l)/Math.PI*180)+360+90)%360,c.update_color(i,a,e)})})}),s({className:"mask",style:{width:"101px",height:"101px"},onMouseDown:(p=this,function(e){return e.preventDefault(),p.start_drag(e,e.target,function(e,r){var n,i;return i=(1-e)*100,n=(1-r)*100,p.update_color(t,i,n)})})}),s({className:"marker h-marker",style:{left:97+84*l+"px",top:97+84*u+"px"}}),s({className:"marker sl-marker",style:{left:47+101*(100-a)/100+"px",top:47+101*(100-e)/100+"px"}}))},set_hex_color:function(t){var e,r,n,i;try{return n=(i=I.Color.parse_color(t))[0],r=i[1],e=i[2],this.setState({color:I.Color.rgb_to_hsl(n,r,e)})}catch(o){}},update_color:function(t,e,r){return null!=this.props.onChange?this.props.onChange([t,e,r]):this.setState({color:[t,e,r]})},start_drag:function(t,e,r){var n,i,o,s;if(null==(i=this.state)||!i.dragging)return this.setState({dragging:!0}),n=function(t){var n,i,s,a,l;if(t.preventDefault(),0===t.buttons){o();return}return s=e.getBoundingClientRect(),a=t.clientX,l=t.clientY,n=(a-s.left)/(s.right-s.left),i=(l-s.top)/(s.bottom-s.top),n=Math.min(1,Math.max(0,n)),i=Math.min(1,Math.max(0,i)),"function"==typeof r?r(n,i):void 0},o=(s=this,function(t){return null!=t&&t.preventDefault(),document.body.removeEventListener("mousemove",n),document.body.removeEventListener("mouseup",o),delete s.up_listener,s.setState({dragging:!1})}),document.body.addEventListener("mousemove",n),document.body.addEventListener("mouseup",o),n(t),this.up_listener=o}}),t("ColorInputPopup",{palette:["#193d3f","#3f2832","#743f39","#9e2835","#b86f50","#327345","#e53b44","#4f6781","#0484d1","#fb922b","#afbfd2","#63c64d","#e4a672","#2ce8f4","#ffe762"],set_wheel_color:function(t){var e,r,n,i;try{return n=(i=I.Color.parse_color(t))[0],r=i[1],e=i[2],this.setState({wheel_color:I.Color.rgb_to_hsl(n,r,e)})}catch(o){}},componentDidMount:function(){var t;if(!(null!=(t=this.state)?t.wheel_color:void 0)&&this.props.color)return this.set_wheel_color(this.props.color)},render:function(){var t,e,r,n,o,a,l;return this.wheel_ref||(this.wheel_ref=React.createRef()),t=this.props.palette||this.palette,(e=this.props.position)&&(n={left:e.left+"px",top:e.top+"px"}),this.enclose({className:"color_popout",style:n},this.props.allow_empty&&this.props.color?i({type:"button",className:"clear_color_btn",onClick:(o=this,function(){var t;return"function"==typeof(t=o.props).set_color?t.set_color(""):void 0})},"Clear"):void 0,R.Forms.ColorWheel({ref:this.wheel_ref,color:null!=(r=this.state)?r.wheel_color:void 0,onChange:(a=this,function(t){var e,r,n;return"function"==typeof(e=a.props).set_color&&e.set_color((n=I.Color).hex_color.apply(n,(r=I.Color).hsl_to_rgb.apply(r,t))),a.setState({wheel_color:t})})}),t?s({className:"palette_options"},t.map((l=this,function(t){return i({key:t,type:"button",style:{backgroundColor:t},onClick:function(e){var r;return"function"==typeof(r=l.props).set_color&&r.set_color(t),l.set_wheel_color(t)}},t)}))):void 0)}}),t("ColorInput",{pure:!0,propTypes:{name:M.string,value:M.any,defaultValue:M.any,allow_empty:M.bool,popout_portal_target:M.object},componentDidMount:function(){var t;return(t=R.Forms.ColorInput).active_inputs||(t.active_inputs=[]),R.Forms.ColorInput.active_inputs.push(this)},componentWillUnmount:function(){var t;return R.Forms.ColorInput.active_inputs=(function(){var e,r,n,i;for(e=0,n=R.Forms.ColorInput.active_inputs,i=[],r=n.length;e<r;e++)(t=n[e])!==this&&i.push(t);return i}).call(this)},componentDidUpdate:function(t,e){var r,n,i;if((n=t.value||"")!==(i=this.props.value||"")&&(r=this.set_color(i)))return this.refs.input.value=r},getInitialState:function(){return{open:!1,last_value:this.props.value||this.props.defaultValue||""}},on_blur:function(){if(!this.set_color_from_input())return this.input_ref.current.value=this.state.last_value,this.set_color(this.state.last_value)},set_color_from_input:function(){var t,e,r;return""===(e=this.input_ref.current.value)&&this.props.allow_empty?(this.setState({has_error:!1,last_value:""}),!0):(""===e||e.match("^#")||(e="#"+e,this.input_ref.current.value=e),t=I.Color.parse_color(e))?(this.set_color(e),null!=(r=this.popout_ref.current)&&r.set_wheel_color(e),!0):(this.setState({has_error:!0}),!1)},set_color:function(t){var e;return this.input_ref.current.value=t,this.setState({last_value:t,has_error:!1}),"function"==typeof(e=this.props).onChange?e.onChange(t):void 0},open:function(){var t;if(!this.state.open)return this.setState({open:!0,on_left:this.popout_on_left(),popout_position:this.popout_position()}),this.click_outside_handler||(this.click_outside_handler=(t=this,function(e){var r,n,i;if(i=ReactDOM.findDOMNode(t),!$(e.target).closest(i).length&&(!(n=t.popout_ref.current)||(r=ReactDOM.findDOMNode(n),!$(e.target).closest(r).length)))return t.close()})),$(document.body).on("mousedown",this.click_outside_handler)},componentWillUnmount:function(){if(this.click_outside_handler)return $(document.body).off("mousedown",this.click_outside_handler)},close:function(){if(this.state.open)return this.setState({open:!1}),$("document.body").off("mousedown",this.click_outside_handler)},popout_position:function(){var t,e;if(this.props.popout_portal_target)return{left:Math.trunc((e=(t=ReactDOM.findDOMNode(this)).getBoundingClientRect()).right+window.scrollX),top:Math.trunc(e.top+window.scrollY)}},popout_on_left:function(){var t,e;return(e=(t=$(ReactDOM.findDOMNode(this))).offset().left+t.width()+250)>$(window).width()+$(window).scrollLeft()},render_color_popout:function(){var e,r;return this.popout_ref||(this.popout_ref=React.createRef()),r=R.Forms.ColorInputPopup({ref:this.popout_ref,palette:this.props.palette,color:this.state.last_value,allow_empty:this.props.allow_empty,set_color:this.set_color,position:this.state.popout_position}),(e=this.props.popout_portal_target)&&(r=t.PortalElement({container_el:e},r)),r},render:function(){var t,e,r;return t=this.state.last_value||"#ffffff",this.input_ref||(this.input_ref=React.createRef()),this.enclose({className:classNames(this.props.className,{picker_open:this.state.open,picker_left:this.state.on_left,color_error:this.state.has_error})},b({ref:this.input_ref,type:"text",className:"color_text_input",name:this.props.name,defaultValue:this.props.value||this.props.defaultValue,placeholder:this.props.defaultValue||"Color",onBlur:this.on_blur,onFocus:this.open,onKeyDown:(e=this,function(t){if(9===t.keyCode)return e.close()}),onKeyUp:(r=this,function(t){return r.set_color_from_input()})}),s({className:"color_swatch",onClick:this.open,style:{backgroundColor:t}}),this.state.open?this.render_color_popout():void 0)}}))})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B,q,U,A,O,W,V,H,G,Y=[].slice,K={}.hasOwnProperty;l=(r=ReactDOMFactories).div,B=r.span,n=r.a,i=r.br,E=r.p,T=r.ol,G=r.ul,S=r.li,q=r.strong,u=r.em,w=r.img,p=r.form,x=r.label,k=r.input,W=r.textarea,o=r.button,b=r.iframe,d=r.h1,f=r.h2,m=r.h3,g=r.h4,v=r.h5,y=r.h6,D=r.pre,s=r.code,M=r.select,L=r.option,P=r.section,N=r.optgroup,c=r.fieldset,C=r.legend,(h=React.createElement.bind(null,React.Fragment)).type=React.fragment,t=R.package("Forms"),H=PropTypes,U=ReactDOMFactories.table,A=ReactDOMFactories.tbody,V=ReactDOMFactories.tr,O=ReactDOMFactories.td,t("MarkdownInput",{pure:!0,propTypes:{name:H.string,value:H.string},getDefaultProps:function(){return{max_default_height:400}},componentWillUnmount:function(){return this.unmounted=!0},componentDidMount:function(){var t,e,r;if((e=this.input_ref.current.scrollHeight)>(t=this.input_ref.current.clientHeight)&&this.setState({default_height:Math.min(e,this.props.max_default_height)}),this.props.autofocus)return _.defer((r=this,function(){var t;return null!=(t=r.input_ref.current)?t.focus():void 0}))},get_value:function(){var t;return null!=(t=this.input_ref.current)?t.value:void 0},set_value:function(t){return this.input_ref.current.value=t},click_bold_text:function(t){return this.wrap_selection("**","**")},click_italic_text:function(t){return this.wrap_selection("*","*")},click_insert_link:function(t){var e,r,n;return(n=this.get_selected_text(),e=this.input_ref.current,n.match(/^https?:\/\/[^\s]+$/))?(this.wrap_selection("[](",")"),e.selectionStart=e.selectionStart-2,e.selectionEnd=e.selectionStart):(this.wrap_selection("[","](url)"),n.length>0)?(r=e.selectionEnd,e.selectionStart=r+2,e.selectionEnd=r+5):void 0},click_insert_video:function(e){var r;return I.Lightbox.open(t.MarkdownVideoEmbedLightbox({on_submit:(r=this,function(t){return r.insert_line(t)})}))},click_insert_image:function(t){var e;return I.Lightbox.open_remote(I.root_url("dashboard/upload-image"),I.PickImageLightbox,(e=this,function(t){var r;if(I.Lightbox.close(),!e.unmounted&&(r=e.input_ref.current))return e.insert_line("![]("+t+")")}))},click_show_help:function(e){return I.Lightbox.open(t.MarkdownHelpLightbox({}))},get_selected_text:function(){var t;return(t=this.input_ref.current)?t.value.substring(t.selectionStart,t.selectionEnd):""},wrap_selection:function(t,e){var r,n,i,o,s,a,l,u,c;return s=(r=this.input_ref.current).selectionStart,o=r.selectionEnd,l=(c=r.value).substring(0,r.selectionStart),a=c.substring(r.selectionEnd,c.length),u=c.substring(r.selectionStart,r.selectionEnd),r.focus(),i=""+t+(u||"")+e,(n=document.execCommand("insertText",!1,i))||"function"!=typeof r.setRangeText||r.setRangeText(i),r.selectionStart=s+t.length,r.selectionEnd=o+t.length},insert_line:function(t){var e,r;if((e=this.input_ref.current).focus(),!(r=document.execCommand("insertText",!1,t)))return"function"==typeof e.setRangeText&&e.setRangeText(t),e.selectionStart=e.selectionStart+t.length,e.selectionEnd=e.selectionEnd},on_hotkey_keydown:function(t){var e;if(t.metaKey||t.ctrlKey){switch(t.key){case"b":this.click_bold_text(t);break;case"i":this.click_italic_text(t);break;case"k":this.click_insert_link(t);break;case"Enter":"function"==typeof(e=this.props).on_submit_hotkey&&e.on_submit_hotkey();break;default:return}return t.preventDefault()}},render:function(){var t,e;return this.enclose({},G({className:"markdown_toolbar"},S({},o({tabIndex:-1,type:"button",onClick:this.click_show_help,title:"Markdown Help"},R.Icons.Markdown)),S({},o({tabIndex:-1,type:"button",onClick:this.click_bold_text,title:"Bold"},R.Icons.FormatBold)),S({},o({tabIndex:-1,type:"button",onClick:this.click_italic_text,title:"Italic"},R.Icons.FormatItalic)),S({},o({tabIndex:-1,type:"button",title:"Insert link",onClick:this.click_insert_link},R.Icons.InsertLink)),S({},o({tabIndex:-1,type:"button",title:"Insert image",onClick:this.click_insert_image},R.Icons.InsertImage)),S({},o({tabIndex:-1,type:"button",title:"Insert video",onClick:this.click_insert_video},R.Icons.InsertVideo))),W({name:this.props.name,ref:this.input_ref||(this.input_ref=React.createRef()),defaultValue:this.get_default_value(),className:"markdown_textarea",onKeyDown:this.on_hotkey_keydown,placeholder:this.props.placeholder,required:this.props.required,style:(null!=(t=this.state)?t.default_height:void 0)?{height:this.state.default_height+"px"}:void 0,onChange:(e=this,function(t){var r,n;if(n=t.target.value,"function"==typeof(r=e.props).on_change&&r.on_change(n),e.props.remember_key)return e.set_memory||(e.set_memory=_.throttle(function(t){return I.store_memory(this.remember_key(),t)},500)),e.set_memory(n)})}))},get_default_value:function(){var t;if((t=this.props.value||this.props.defaultValue)||this.props.remember_key&&(t="undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem(this.remember_key()):void 0))return t},remember_key:function(){return"inputmemory:"+this.props.remember_key},clear_memory:function(){return I.clear_memory(this.remember_key())}}),R.Icons||(R.Icons={}),F=ReactDOMFactories.path,z=ReactDOMFactories.line,j=ReactDOMFactories.rect,R.Icons.Markdown=React.createElement("svg",{className:classNames("svgicon markdown_icon"),role:"img",version:"1.1",viewBox:"0 0 208 128",fill:"currentColor"},F({d:"M193 128H15a15 15 0 0 1-15-15V15A15 15 0 0 1 15 0h178a15 15 0 0 1 15 15v98a15 15 0 0 1-15 15zM50 98V59l20 25 20-25v39h20V30H90L70 55 50 30H30v68zm134-34h-20V30h-20v34h-20l30 35z"})),a=function(){var t,e,r;return e=arguments[0],t=2<=arguments.length?Y.call(arguments,1):[],React.createElement.apply(React,["svg",{className:classNames("svgicon",e.className),role:"img",version:"1.1",viewBox:"0 0 24 24",width:"24",height:"24",fill:null!=(r=null!=e?e.fill:void 0)?r:"none",stroke:"currentColor",strokeWidth:"3",strokeLinejoin:"round","aria-hidden":!0}].concat(Y.call(t)))},R.Icons.FormatBold=a({className:"icon_format_bold"},F({d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}),F({d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"})),R.Icons.FormatItalic=a({className:"icon_format_italic"},z({x1:"19",y1:"4",x2:"10",y2:"4"}),z({x1:"14",y1:"20",x2:"5",y2:"20"}),z({x1:"15",y1:"4",x2:"9",y2:"20"})),R.Icons.InsertLink=a({className:"icon_insert_link"},F({d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),F({d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})),R.Icons.InsertImage=a({className:"icon_insert_image"},j({x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),React.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),React.createElement("polyline",{points:"21 15 16 10 5 21"})),R.Icons.InsertVideo=a({className:"icon_insert_video"},F({d:"M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"}),React.createElement("polygon",{points:"9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"})),e={youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:\-nocookie)?\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.\-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,sketchfab_old:/https?:\/\/(?:www\.)?sketchfab\.com\/models\/([\w]+)($|\/)/,sketchfab:/https?:\/\/(?:www\.)?sketchfab\.com\/3d-models\/.*?-([^-]+)$/},t("MarkdownVideoEmbedLightbox",{pure:!0,getInitialState:function(){return{is_valid:!1}},componentDidMount:function(){var t;return _.defer((t=this,function(){var e;return null!=(e=t.input_ref.current)?e.focus():void 0}))},generate_youtube_embed_code:function(t){return'<iframe width="560" height="315" src="https://www.youtube.com/embed/'+t+'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'},generate_vimeo_embed_code:function(t){return'<iframe src="https://player.vimeo.com/video/'+t+'" width="560" height="315" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>'},generate_sketchfab_embed_code:function(t){return'<iframe width="560" height="315" src="https://sketchfab.com/models/'+t+'/embed" frameborder="0" allow="autoplay; fullscreen; vr" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>'},parse_input_value:function(){var t,r,n,i,o,s,a;if((s=$.trim((null!=(n=this.input_ref.current)?n.value:void 0)||"")).match(/<iframe/i))return s;for(o in e)if(K.call(e,o)){if(r=e[o],!(t=s.match(r)))continue;switch(o){case"youtube":if(a=(i=t[0].match(/v=([^>"'&]+)/))?i[1]:(i=t[0].match(/embed\/([^>"'&\/]+)/))?i[1]:void 0)return this.generate_youtube_embed_code(a);break;case"vimeo":if(a=t[2])return this.generate_vimeo_embed_code(a);break;case"sketchfab":case"sketchfab_old":if(a=t[1])return this.generate_sketchfab_embed_code(a);break;default:console.log(o,t)}}},render:function(){var t,e;return R.Lightbox({className:classNames(this.enclosing_class_name(),"compact")},f({},"Embed Video"),p({className:"form",onSubmit:this.on_submit||(this.on_submit=(t=this,function(e){var r;if(e.preventDefault(),t.state.is_valid&&t.state.embed_code)return"function"==typeof(r=t.props).on_submit&&r.on_submit(t.state.embed_code),I.Lightbox.close()}))},l({className:"label"},"Youtube/Vimeo/Sketchfab URL or ",s({},"<iframe>")," embed code"),l({className:"input_split"},k({type:"text",required:"required",placeholder:"Please paste a valid URL or embed code",ref:this.input_ref||(this.input_ref=React.createRef()),onChange:this.on_change||(e=this,function(t){var r;return r=e.parse_input_value(),e.setState({embed_code:r,is_valid:!!r})})})," ",o({disabled:!this.state.is_valid,className:classNames("button",{disabled:!this.state.is_valid})},"Insert"))))}}),t("MarkdownHelpLightbox",{pure:!0,render:function(){var t;return t=function(){var t,e;return t=arguments[0],e=2<=arguments.length?Y.call(arguments,1):[],V({},O({className:"format_type"},t),O.apply(null,[{className:"format_example"}].concat(Y.call(e))))},R.Lightbox({className:classNames(this.enclosing_class_name(),"compact")},f({},"Quick Markdown Guide"),E({},"Markdown is a writing format that converts into HTML."),l({className:"table_wrapper"},U({className:"nice_table"},A({},t("Bold","**Bolded text here**"),t("Italic","*Emphasized text here*"),t("Bullet list","* First item",i({}),"* Second item"),t("Link","[Linked text](http://example.com)"),t("Blockquote","> Quoted text here",i({}),"> Can span multiple lines"),t("Code","```",i({}),'print("Hello world")',i({}),"```"),t("Video embeds",u({},"Paste embed code directly"))))),E({},n({href:"https://commonmark.org/help/",target:"_blank"},"Extended tutorial ↗"),". You can also use a subset of HTML directly for advanced formatting."))}})})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M=[].slice;s=(t=ReactDOMFactories).div,F=t.span,e=t.a,r=t.br,T=t.p,C=t.ol,P=t.ul,x=t.li,D=t.strong,a=t.em,y=t.img,u=t.form,w=t.label,b=t.input,j=t.textarea,n=t.button,v=t.iframe,p=t.h1,h=t.h2,d=t.h3,f=t.h4,m=t.h5,g=t.h6,N=t.pre,i=t.code,E=t.select,z=t.option,L=t.section,S=t.optgroup,l=t.fieldset,k=t.legend,(c=React.createElement.bind(null,React.Fragment)).type=React.fragment,R.Icons||(R.Icons={}),o=function(){var t,e,r;return e=arguments[0],t=2<=arguments.length?M.call(arguments,1):[],React.createElement.apply(React,["svg",{className:classNames("svgicon",e.className),role:"img",version:"1.1",viewBox:"0 0 24 24",width:"24",height:"24",fill:null!=(r=null!=e?e.fill:void 0)?r:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round","aria-hidden":!0}].concat(M.call(t)))},R.Icons.TriUp=o({className:"icon_tri_up",fill:"currentColor"},React.createElement("polygon",{points:"2 18 12 6 22 18"})),R.Icons.TriDown=o({className:"icon_tri_down",fill:"currentColor"},React.createElement("polygon",{points:"2 6 12 18 22 6"})),R.Icons.Filter=o({className:"icon_filter"},React.createElement("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})),R.Icons.Edit=o({className:"icon_edit"},React.createElement("path",{d:"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"}),React.createElement("polygon",{points:"18 2 22 6 12 16 8 16 8 12 18 2"})),R.Icons.External=o({className:"icon_external_link"},React.createElement("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),React.createElement("polyline",{points:"15 3 21 3 21 9"}),React.createElement("line",{x1:"10",y1:"14",x2:"21",y2:"3"}))})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M,B;a=(e=ReactDOMFactories).div,D=e.span,r=e.a,n=e.br,N=e.p,S=e.ol,B=e.ul,C=e.li,j=e.strong,l=e.em,b=e.img,c=e.form,k=e.label,w=e.input,P=e.textarea,i=e.button,y=e.iframe,h=e.h1,d=e.h2,f=e.h3,m=e.h4,g=e.h5,v=e.h6,L=e.pre,o=e.code,F=e.select,T=e.option,E=e.section,z=e.optgroup,u=e.fieldset,x=e.legend,(p=React.createElement.bind(null,React.Fragment)).type=React.fragment,t=R.package("Forms"),M=PropTypes,s=0,t("Image",{pure:!0,getInitialState:function(){return{loaded:!1}},render:function(){var t;return b({className:classNames(this.enclosing_class_name(),this.props.className,{image_loading:!this.state.loaded}),src:this.props.src,onLoad:(t=this,function(){var e;return t.setState({loaded:!0}),"function"==typeof(e=t.props).on_load?e.on_load():void 0})})}}),t("Video",{pure:!0,render:function(){return React.createElement("video",{width:200,loop:!0,muted:!0,autoPlay:!0,src:this.props.src})}}),t("ImageUploader",{pure:!0,propTypes:{upload_url:M.string.isRequired,name:M.string.isRequired,thumb_size:M.string,label:M.string,upload:M.object,show_replace:M.bool},getDefaultProps:function(){return{remove_button_classes:["button","outline","small"],replace_button_classes:["button","outline","small"],upload_button_classes:"button"}},getInitialState:function(){return{active_uploads:[],uploads:this.props.upload?[this.props.upload]:this.props.uploads}},push_errors:function(t){var e,r,n,i;return"string"==typeof t&&(t=[t]),r=function(){var r,o,s;for(r=0,s=[],o=t.length;r<o;r++)if("string"==typeof(e=t[r]))s.push(e);else{if(!Array.isArray(e))continue;i=e[0],(n=e[1])?s.push(n.name+" - "+i):s.push(i)}return s}(),this.setState(function(t){return{errors:(t.errors||[]).concat(r)}})},get_progress:function(){var t;return Math.min.apply(Math,this.state.active_uploads.map((t=this,function(t){return t.progress})))},pick_image:function(t){var e,r,n;return this.setState({errors:[]}),I.upload_image({url:this.props.upload_url,accept:this.props.accept,thumb_size:this.props.thumb_size,multiple:this.props.multiple,max_size:this.props.max_size,test_file:(e=this,function(t,e){return $.when(I.test_image_dimensions(t),I.test_image_format(t)).done(function(){return e.resolve()}).fail(function(t){return e.reject(t)})}),on_start_upload:(r=this,function(e,n,i){var o;return o={file:e,upload:n,xhr:i,progress:0},r.setState(function(t){return{active_uploads:t.active_uploads.concat([o]),uploading:!0}}),i.progress(function(t,e,n){var i;return i=Object.assign({},o,{progress:e/n}),r.setState(function(t){var e;return{active_uploads:t.active_uploads.map((e=this,function(t){return t===o?i:t}))}}),o=i}).done(function(e){var i;if(e.errors){r.push_errors(e.errors);return}if(n=e.upload,"function"==typeof t&&t(),n)return"function"==typeof(i=r.props).on_upload&&i.on_upload(n),r.setState(function(t){return{uploads:(t.uploads||[]).concat([n])}})}).always(function(){return r.setState(function(t){var e,r;return{uploading:!!(e=t.active_uploads.filter((r=this,function(t){return t!==o}))).length,active_uploads:e}})})})}).fail((n=this,function(t){return n.push_errors(t)}))},remove_image:function(t){var e,r;if(r=this.state.uploads[t],this.setState(function(t){var e;return{uploads:(function(){var t,n,i,o;for(t=0,i=this.state.uploads,o=[],n=i.length;t<n;t++)(e=i[t])!==r&&o.push(e);return o}).call(this)}}),!this.props.multiple)return"function"==typeof(e=this.props).on_upload?e.on_upload(null):void 0},render_existing_upload:function(e,r){var n,o,s;return n=this.props.multiple?this.props.name+"["+(r+1)+"]":this.props.name,a({className:"existing_upload",key:e.id},w({type:"hidden",name:n,value:e.id}),e.thumb_url?a({className:"preview_image"},e.thumb_url.match(/\.mp4$/)?t.Video({src:e.thumb_url}):t.Image({src:e.thumb_url})):void 0,this.props.children,a({className:"existing_upload_tools"},this.props.show_replace?i({className:classNames("replace_image_btn",this.props.replace_button_classes),type:"button",onClick:(o=this,function(t){return t.preventDefault(),o.pick_image(function(){return o.remove_image(r)})})},"Replace image"):void 0,i({className:classNames("remove_image_btn",this.props.remove_button_classes),type:"button",onClick:(s=this,function(t){return t.preventDefault(),s.remove_image(r)})},"Remove image")))},render:function(){var t,e,r,n,o,l,u;return this.autogen_id="image-uploader-"+s++,t=!!(null!=(e=this.state.uploads)?e.length:void 0),this.enclose({className:classNames(this.props.className,{no_upload:!t,have_upload:!!t})},this.props.label?k({className:"label",htmlFor:this.autogen_id},this.props.label):void 0,(null!=(r=this.state.errors)?r.length:void 0)?R.Forms.FormErrors({errors:this.state.errors,title:"Upload failed"}):void 0,this.props.multiple||(null!=(n=this.state.uploads)?n.length:void 0)?void 0:w({type:"hidden",name:this.props.name,value:""}),this.state.uploading?a({className:"upload_progress"},this.state.active_uploads.length?"Uploading "+(100*(this.get_progress()||0)).toFixed(2)+"%":"Uploading..."):void 0,!this.props.multiple&&(null!=(o=this.state.uploads)?o.length:void 0)?void 0:i({id:this.autogen_id,disabled:!!this.state.uploading,className:classNames(this.props.upload_button_classes,{small:this.props.compact,disabled:!!this.state.uploading}),type:"button",onClick:(u=this,function(t){return t.preventDefault(),u.pick_image()})},this.props.upload_label||(this.props.multiple?"Upload images":"Upload image")),(null!=(l=this.state.uploads)?l.length:void 0)?a({className:"existing_uploads",children:this.state.uploads.map(this.render_existing_upload)}):void 0)}})})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j,P,M;s=(t=ReactDOMFactories).div,F=t.span,e=t.a,r=t.br,T=t.p,C=t.ol,M=t.ul,x=t.li,D=t.strong,a=t.em,y=t.img,u=t.form,w=t.label,b=t.input,j=t.textarea,n=t.button,v=t.iframe,p=t.h1,h=t.h2,d=t.h3,f=t.h4,m=t.h5,g=t.h6,N=t.pre,i=t.code,E=t.select,z=t.option,L=t.section,S=t.optgroup,l=t.fieldset,k=t.legend,(c=React.createElement.bind(null,React.Fragment)).type=React.fragment,R.Icons||(R.Icons={}),o=null,P=PropTypes,R.Icons.Close=function(t){var e,r,n,i,o;return null==t&&(t={}),o=null!=(r=t.width)?r:24,e=null!=(n=t.height)?n:o,React.createElement("svg",{className:"svgicon icon_close",strokeLinecap:"round",stroke:"currentColor",role:"img",version:"1.1",viewBox:"0 0 24 24",strokeWidth:null!=(i=t.stroke_width)?i:"2",width:o,height:e,strokeLinejoin:"round","aria-hidden":!0,fill:"none"},React.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),React.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))},R.component("Lightbox",{is_modal_dialog:function(){var t;return null!=(t=document.getElementById("lightbox_container"))?t.contains(this.container_ref.current):void 0},getInitialState:function(){return{}},componentDidMount:function(){if(this.is_modal_dialog()){if(o)console.warn("A dialog already has the focus trap");else{var t;this.detect_focus=(t=this,function(e){var r;if((r=t.container_ref.current)&&"contains"in r&&!(r===e.target||r.contains(e.target)))return r.focus()}),$(document.body).on("focusin",this.detect_focus),o=this}return this.setState({previously_focused:document.activeElement,is_modal_dialog:!0},function(){var t;return _.defer((t=this,function(){var e;return null!=(e=t.container_ref.current)?e.focus():void 0}))})}},componentWillUnmount:function(){var t;return this.detect_focus&&($(document.body).off("focusin",this.detect_focus),o=null,delete this.detect_focus),null!=(t=this.state.previously_focused)?t.focus():void 0},render:function(){return s({className:classNames("lightbox",this.props.className),style:this.props.style,role:this.state.is_modal_dialog?"dialog":void 0,"aria-modal":this.state.is_modal_dialog?"true":void 0,tabIndex:this.state.is_modal_dialog?-1:void 0,ref:this.container_ref||(this.container_ref=React.createRef())},!1!==this.props.close?n({className:"close_button",type:"button","aria-label":"Close Dialog"},R.Icons.Close({width:18})):void 0,this.props.children)}}),R.component("ErrorLightbox",{propTypes:{title:P.string,errors:P.array.isRequired},render:function(){var t;return R.Lightbox({className:classNames(this.enclosing_class_name(),"compact")},h({},this.props.title||"Your request could not be completed"),R.Forms.FormErrors({title:!1,errors:this.props.errors}),T({className:"buttons"},n({className:"button",type:"button",onClick:(t=this,function(){return I.Lightbox.close()})},"Close")))}})})}).call(this),(function(){I.libs.react.done(function(){var t,e,r,n,i,o,s,a,l,u,c,p,h,d,f,m,g,v,y,b,w,k,x,C,S,z,T,N,L,E,F,D,j;o=(t=ReactDOMFactories).div,E=t.span,e=t.a,r=t.br,z=t.p,x=t.ol,j=t.ul,k=t.li,F=t.strong,s=t.em,v=t.img,l=t.form,b=t.label,y=t.input,D=t.textarea,n=t.button,g=t.iframe,c=t.h1,p=t.h2,h=t.h3,d=t.h4,f=t.h5,m=t.h6,T=t.pre,i=t.code,L=t.select,S=t.option,N=t.section,C=t.optgroup,a=t.fieldset,w=t.legend,(u=React.createElement.bind(null,React.Fragment)).type=React.fragment,R.component("SlideDown",{getInitialState:function(){return{}},getDefaultProps:function(){return{duration:200,delay:1}},componentDidMount:function(){var t,e;return t=ReactDOM.findDOMNode(this),this.timer=window.setTimeout((e=this,function(){return e.setState({height:t.scrollHeight||!1}),e.timer=window.setTimeout(function(){return e.setState({animated:!0})},e.props.duration+50),e.wrapper_ref.current.scrollTop=0}),this.props.delay)},componentWillUnmount:function(){if(this.timer)return window.clearTimeout(this.timer),delete this.timer},render:function(){var t;return o({style:t=!1===this.state.height?null:this.state.height?this.state.animated?null:{height:this.state.height+"px",overflow:"hidden",transition:"height "+this.props.duration/1e3+"s ease"}:{height:0,overflow:"scroll",transition:"height 0.2s ease"},className:this.props.className,ref:this.wrapper_ref||(this.wrapper_ref=React.createRef())},this.props.children)}})})}).call(this);