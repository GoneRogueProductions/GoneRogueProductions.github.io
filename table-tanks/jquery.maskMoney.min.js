!function(e){"use strict";e.browser||(e.browser={},e.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),e.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var t={destroy:function(){return e(this).off(".maskMoney"),e.browser.msie&&(this.onpaste=null),this},applyMask:function(t){var n=e(this).data("settings");return a(t,n)},mask:function(t){return this.each(function(){var n=e(this);return"number"==typeof t&&n.val(t),n.trigger("mask")})},unmasked:function(){return this.map(function(){var t,n=e(this).val()||"0",a=-1!==n.indexOf("-");return e(n.split(/\D/).reverse()).each(function(e,n){if(n)return t=n,!1}),n=(n=n.replace(/\D/g,"")).replace(RegExp(t+"$"),"."+t),a&&(n="-"+n),parseFloat(n)})},init:function(t){return t=e.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1,doubleClickSelection:!0,allowEmpty:!1},t),this.each(function(){var r,i,o=e(this);function l(){var e,t,n,a,r,i=o.get(0),l=0,s=0;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(l=i.selectionStart,s=i.selectionEnd):(t=document.selection.createRange())&&t.parentElement()===i&&(a=i.value.length,e=i.value.replace(/\r\n/g,"\n"),(n=i.createTextRange()).moveToBookmark(t.getBookmark()),(r=i.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?l=s=a:(l=-n.moveStart("character",-a),l+=e.slice(0,l).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?s=a:(s=-n.moveEnd("character",-a),s+=e.slice(0,s).split("\n").length-1))),{start:l,end:s}}function s(e){var t,n,i=o.val().length;o.val(a(o.val(),r)),t=o.val().length,r.reverse||(e-=i-t),n=e,!r.formatOnBlur&&o.each(function(e,t){if(t.setSelectionRange)t.focus(),t.setSelectionRange(n,n);else if(t.createTextRange){var a=t.createTextRange();a.collapse(!0),a.moveEnd("character",n),a.moveStart("character",n),a.select()}})}function c(){var e=o.val();(!r.allowEmpty||""!==e)&&(r.precision>0&&0>e.indexOf(r.decimal)&&(e+=r.decimal+Array(r.precision+1).join(0)),o.val(a(e,r)))}function u(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function f(t){var n,a,i,s,c,f,p,d,g=(t=t||window.event).which||t.charCode||t.keyCode,m=r.decimal.charCodeAt(0);if(void 0===g)return!1;if((g<48||g>57)&&(g!==m||!r.reverse))return function t(n,a){if(45===n){var i;return o.val((i=o.val(),r.allowNegative?""!==i&&"-"===i.charAt(0)?i.replace("-",""):"-"+i:i)),!1}return 43===n?(o.val(o.val().replace("-","")),!1):13===n||9===n||!!e.browser.mozilla&&(37===n||39===n)&&0===a.charCode||(u(a),!0)}(g,t);if(i=!(o.val().length>=o.attr("maxlength")&&o.attr("maxlength")>=0),c=(s=l()).start,f=s.end,p=!!(s.start!==s.end&&o.val().substring(c,f).match(/\d/)),d="0"===o.val().substring(0,1),!i&&!p&&!d)return!1;return!(g===m&&(n=o.val().length,a=l(),(0!==a.start||a.end!==n)&&o.val().indexOf(r.decimal)>-1))&&(!!r.formatOnBlur||(u(t),v(t),!1))}function v(e){var t,n,a,r,i=(e=e||window.event).which||e.charCode||e.keyCode,c="";i>=48&&i<=57&&(c=String.fromCharCode(i)),n=(t=l()).start,a=t.end,r=o.val(),o.val(r.substring(0,n)+c+r.substring(a,r.length)),s(n+1)}function p(){setTimeout(function(){c()},0)}function d(){return(parseFloat("0")/Math.pow(10,r.precision)).toFixed(r.precision).replace(RegExp("\\.","g"),r.decimal)}r=e.extend({},t),r=e.extend(r,o.data()),o.data("settings",r),o.off(".maskMoney"),o.on("keypress.maskMoney",f),o.on("keydown.maskMoney",function e(t){var n,a,i,c,f,v=(t=t||window.event).which||t.charCode||t.keyCode;return void 0!==v&&(a=(n=l()).start,i=n.end,8!==v&&46!==v&&63272!==v||(u(t),c=o.val(),a===i&&(8===v?""===r.suffix?a-=1:(f=c.split("").reverse().join("").search(/\d/),i=(a=c.length-f-1)+1):i+=1),o.val(c.substring(0,a)+c.substring(i,c.length)),s(a),!1))}),o.on("blur.maskMoney",function t(a){if(e.browser.msie&&f(a),r.formatOnBlur&&o.val()!==i&&v(a),""===o.val()&&r.allowEmpty)o.val("");else if(""===o.val()||o.val()===n(d(),r))r.allowZero?r.affixesStay?o.val(n(d(),r)):o.val(d()):o.val("");else if(!r.affixesStay){var l=o.val().replace(r.prefix,"").replace(r.suffix,"");o.val(l)}o.val()!==i&&o.change()}),o.on("focus.maskMoney",function e(){i=o.val(),c();var t,n=o.get(0);r.selectAllOnFocus?n.select():n.createTextRange&&((t=n.createTextRange()).collapse(!1),t.select())}),o.on("click.maskMoney",function e(){var t,n=o.get(0);!r.selectAllOnFocus&&(n.setSelectionRange?(t=o.val().length,n.setSelectionRange(t,t)):o.val(o.val()))}),o.on("dblclick.maskMoney",function e(){var t,n,a=o.get(0);a.setSelectionRange?(n=o.val().length,t=r.doubleClickSelection?0:n,a.setSelectionRange(t,n)):o.val(o.val())}),o.on("cut.maskMoney",p),o.on("paste.maskMoney",p),o.on("mask.maskMoney",c)})}};function n(e,t){var n="";return e.indexOf("-")>-1&&(e=e.replace("-",""),n="-"),e.indexOf(t.prefix)>-1&&(e=e.replace(t.prefix,"")),e.indexOf(t.suffix)>-1&&(e=e.replace(t.suffix,"")),n+t.prefix+e+t.suffix}function a(e,t){var a,i,o,l,s,c,u;return t.allowEmpty&&""===e?"":t.reverse?function e(t,a){var i,o=t.indexOf("-")>-1&&a.allowNegative?"-":"",l=t.replace(a.prefix,"").replace(a.suffix,""),s=l.split(a.decimal)[0],c="";if(""===s&&(s="0"),i=r(s,o,a),a.precision>0){var u=l.split(a.decimal);u.length>1&&(c=u[1]),i+=a.decimal+c;var f=Number.parseFloat(s+"."+c).toFixed(a.precision).toString().split(a.decimal)[1];i=i.split(a.decimal)[0]+"."+f}return n(i,a)}(e,t):(a=e,i=t,c=a.indexOf("-")>-1&&i.allowNegative?"-":"",u=a.replace(/[^0-9]/g,""),o=r(u.slice(0,u.length-i.precision),c,i),i.precision>0&&(l=u.slice(u.length-i.precision),s=Array(i.precision+1-l.length).join(0),o+=i.decimal+s+l),n(o,i))}function r(e,t,n){return""===(e=(e=e.replace(/^0*/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,n.thousands))&&(e="0"),t+e}e.fn.maskMoney=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.maskMoney"):t.init.apply(this,arguments)}}(window.jQuery||window.Zepto);