(()=>{var Oe=Object.create,pe=Object.defineProperty,Fe=Object.getOwnPropertyDescriptor,he=Object.getOwnPropertyNames,qe=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty,Ue=(t,e)=>function(){return e||(0,t[he(t)[0]])((e={exports:{}}).exports,e),e.exports},We=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of he(e))!Ae.call(t,i)&&i!==r&&pe(t,i,{get:()=>e[i],enumerable:!(n=Fe(e,i))||n.enumerable});return t},_e=(t,e,r)=>(r=t!=null?Oe(qe(t)):{},We(e||!t||!t.__esModule?pe(r,"default",{value:t,enumerable:!0}):r,t)),ge=Ue({"coffee/bundle/_react.js"(){var t,e,r,n={}.hasOwnProperty,i=[].slice;window.R||(t={},e=function(o,s){var a;for(a in o)if(n.call(o,a)&&o[a]!==s[a])return!0;for(a in s)if(n.call(s,a)&&!(a in o))return!0;return!1},r={},window.R=function(o,s,a,u){var l,c,p,h,v;return a==null&&(a=R),u==null&&(u=""),a[o]?(I.in_dev&&console.warn("Already declared, using existing:",o),a[o]):(s.trigger=function(){var g;g=$(ReactDOM.findDOMNode(this)),R.trigger.apply(R,[g].concat(i.call(arguments)))},s.dispatch=function(){var g;g=$(ReactDOM.findDOMNode(this)),R.dispatch.apply(R,[g].concat(i.call(arguments)))},s.container=function(){return $(ReactDOM.findDOMNode(this))},s.extend_props=function(){var g;return g=1<=arguments.length?i.call(arguments,0):[],$.extend.apply($,[{},this.props].concat(i.call(g)))},s.tt=function(g,y){var x;return y==null&&(y=t),(x=I.i18n.fetch_key_sync(g))&&_.isString(x)?x:(r[g]||(r[g]=I.i18n.react_class(g)),React.createElement(r[g],y))},s.t=function(g,y){return I.i18n.fetch_key_sync(g)?I.i18n.t_sync(g,y):(I.i18n.fetch_key(g).done(function(x){return function(){if(x.isMounted())return x.forceUpdate()}}(this)),"\u2026")},c=_.once(function(){return(""+u+o).replace(/[A-Z]/g,"_$&").replace(/\./g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").toLowerCase()+"_widget"}),s.enclosing_class_name=c,s.enclose=function(){var g,y,x;return x=arguments[0],g=2<=arguments.length?i.call(arguments,1):[],y=x.component||"div",delete x.component,React.createElement.apply(React,[y,$.extend({},x,{className:classNames(c(),x.className)})].concat(i.call(g)))},s.displayName=""+u+o,s.pure&&(s.shouldComponentUpdate=function(g,y){return e(this.props||t,g)||e(this.state||t,y)}),p=s.getDefaultProps,delete s.getDefaultProps,v=s.propTypes,delete s.propTypes,l=createReactClass(s),p&&(l.defaultProps=p()),v&&(l.propTypes=v),h=React.createElement.bind(null,l),h.type=l,a[o]=h)},R.scope_event_name=function(o){return"itch:"+o},R.trigger=function(){var o,s,a;return a=arguments[0],s=arguments[1],o=3<=arguments.length?i.call(arguments,2):[],a.trigger(R.scope_event_name(s),i.call(o))},R.dispatch=function(o,s,a){var u,l,c;typeof s=="object"&&(a=s,s=!1),c=[];for(u in a)n.call(a,u)&&(l=a[u],s&&(u=s+":"+u),c.push(o.on(R.scope_event_name(u),l)));return c},R.component=function(){return R.apply(null,arguments)},R.is_different=e,R.package=function(o){var s;return s=R[o]||(R[o]=function(a,u){return u.Package=s,R.component(a,u,s,o+".")}),s.component=function(){return s.apply(null,arguments)},s},R.render=function(o,s){var a;return window.ReactDOM?(a=typeof o=="string"?document.querySelector(o):o,ReactDOM.render(s(),a)):I.libs.react.done(function(){return R.render(o,s)})})}}),J,me,ve,Be={}.hasOwnProperty,ne=[].slice;me=10,J="inputmemory_keys",ve=1,window.I={get_worker:function(){var t;return t=$.Deferred(),I.get_worker=function(){return t},t.resolve(new Worker("/static/worker.min.js")),t},solve_challenge:function(t){return I.get_worker().then(function(e){var r,n,i;return r=ve++,e.postMessage([r,"solve_challenge",t]),n=$.Deferred(),e.addEventListener("message",i=function(o){return function(s){var a,u,l;if(u=s.data,a=u[0],l=u[1],a===r)return e.removeEventListener("message",i),n.resolve(l)}}(this)),n})},libs:{react:$.Deferred(function(t){if(typeof React!="undefined"&&React!==null)return t.resolve(React)}),selectize:$.Deferred(function(t){var e;if(typeof $!="undefined"&&$!==null&&(e=$.fn)!=null&&e.selectize)return t.resolve($.fn.selectize)}),redactor:$.Deferred(function(t){var e;if(typeof $!="undefined"&&$!==null&&(e=$.fn)!=null&&e.redactor)return t.resolve($.fn.redactor)})},setup_page:function(){return I.setup_register_referrers($(document.body)),_.defer(function(t){return function(){return I.setup_affiliate_code()}}(this))},root_url:function(){var t;return t=null,function(e){return t||(t=$("body").data("host")||"",t!==""&&(t=window.location.protocol+"//"+t,window.location.port&&window.location.port!=="80"&&(t+=":"+window.location.port))),t+"/"+e}}(),page_name:function(){return $(document.body).data("page_name")||"unknown"},sort_keys:function(t){var e,r;return r=[],e=function(n){var i,o,s;o=[];for(i in n)Be.call(n,i)&&(s=n[i],r.push(i),typeof s=="object"?o.push(e(s)):o.push(void 0));return o},e(t),r.sort()},get_csrf:function(){return I._csrf_token||(I._csrf_token=$("meta[name='csrf_token']").attr("value"))},with_csrf:function(t){var e;return t==null&&(t={}),e={csrf_token:I.get_csrf()},typeof t=="string"?t+"&"+$.param(e):$.extend(t,e)},add_params:function(t,e){var r;return r=$.param(e),t.match(/\?/)?t+"&"+r:t+"?"+r},flash:function(t,e){return e==null&&(e="notice"),I.flasher||(I.flasher=new I.Flasher),t.match(/^error:/)&&(t=t.replace(/^error:/,"Error: "),e="error"),I.flasher.show(e,t)},slugify:function(t,e){return t=t.replace(/\s+/g,"-"),t=e!=null&&e.for_tags?t.replace(/[^\w_.-]/g,"").replace(/^[_.-]+/,"").replace(/[_.-]+$/,""):t.replace(/[^\w_-]/g,""),t.toLowerCase()},truncate:function(t,e,r){return e==null&&(e=30),r==null&&(r="..."),t?t.length>e+r.length?""+t.slice(0,e)+r:t:""},number_format:function(t,e,r,n){var i,o,s;return r==null&&(r="."),n==null&&(n=","),isNaN(t)||t===null?"":(t=t.toFixed(~~e),s=t.split("."),o=s[0],i=s[1]?r+s[1]:"",o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+n)+i)},format_bytes:function(){var t;return t=[["gb",Math.pow(1024,3)],["mb",Math.pow(1024,2)],["kb",1024]],function(e){var r,n,i,o,s;for(r=0,i=t.length;r<i;r++)if(s=t[r],n=s[0],o=s[1],e>=o)return""+I.number_format(e/o)+n;return I.number_format(e)+" bytes"}}(),ecommerce_event:function(t){return window.ga?(ga("ecommerce:addTransaction",t.transaction),ga("ecommerce:addItem",t.item),ga("ecommerce:send")):console.log("ecommerce event:",t)},event:function(t,e,r,n,i){var o;return i==null&&(i=!0),o={hitType:"event",eventCategory:t,eventAction:e,eventLabel:r,eventValue:n},i||(o.nonInteraction=1),I.event_with_opts(o)},event_with_opts:function(t){try{return typeof ga!="undefined"&&ga!==null?ga("send",t):(console.log("event:",t),typeof t.hitCallback=="function"?t.hitCallback():void 0)}catch(e){}},event2:function(){var t;t=1<=arguments.length?ne.call(arguments,0):[]},parse_money:function(t){var e;return e=t&&parseInt(t.replace(/[^\d]/g,""),10),e||0},currency_symbols:{USD:"$",GBP:"\xA3",EUR:"\u20AC",JPY:"\xA5"},currency_formats:{USD:{prefix:"$"},GBP:{prefix:"\xA3"},JPY:{prefix:"\xA5"},EUR:{suffix:"\u20AC"}},format_money:function(t,e){var r,n;return e==null&&(e="USD"),t<0?"-"+I.format_money(-t,e):(n=I.currency_symbols[e]||"$",e==="JPY"?n+t:(r=I.number_format(t/100,2),e==="EUR"?""+r+n:""+n+r))},money_input:function(t,e){var r,n;return e==null&&(e={}),t=$(t),r=e.currency||t.data("currency"),n=I.currency_formats[r]||{prefix:"$"},t.maskMoney($.extend({affixesStay:!0,precision:r==="JPY"?0:2},n,e))},plural:function(t,e){return e===1?e+" "+t:e+" "+t+"s"},add_recaptcha_if_necessary:function(t,e){if(e[0]==="recaptcha")return t.data("adding_recaptcha")||(t.data("adding_recaptcha",!0),I.with_recaptcha(function(){var r;return r=t.find(".g-recaptcha"),I.event("recaptcha","show",I.page_name()),grecaptcha.render(r[0],{sitekey:r.data("sitekey")})})),t.set_form_errors(["Please fill out the CAPTCHA to continue"]),!0},with_recaptcha:function(t){var e;return window.grecaptcha?t():I.recaptcha_deferred?I.recaptcha_deferred.done(t):(I.recaptcha_deferred=$.Deferred().done(t),window._itch_recaptcha_loaded=function(){return I.recaptcha_deferred.resolve()},e="https://www.google.com/recaptcha/api.js?onload=_itch_recaptcha_loaded&render=explicit",$('<script type="text/javascript">').attr("src",e).appendTo("head"))},wait_for_object:function(t,e,r){var n,i,o;return i=1,n=10,o=function(){return t[e]?typeof r=="function"?r():void 0:(i+=n,i=Math.min(500,i),setTimeout(o,i))},o()},with_selectize:function(t){return I.libs.selectize.done(t)},get_template:function(t){return _.template($("#"+t+"_tpl").html())},lazy_template:function(t,e){return function(){var r,n;return r=1<=arguments.length?ne.call(arguments,0):[],n=I.get_template(e),t.prototype.template=n,n.apply(null,r)}},setup_sticky_bar:function(t){var e,r,n;return n=$(window),e=$(document.body),t=$(t),r=!1,n.on("scroll",function(i){if(n.scrollTop()>t.offset().top+t.outerHeight()){if(!r)return e.addClass("show_sticky_bar"),r=!0}else if(r)return e.removeClass("show_sticky_bar"),r=!1})},setup_selectize:function(t){return t.find(".selectize_input").each(function(e,r){var n,i,o,s,a,u,l;if(n=$(r),!n.hasClass("selectized"))return a={plugins:[],persist:!1},n.is("select")&&(i={},n.find("option").each(function(c,p){var h;return h=$(p),i[h.val()]=h.data("extra")}),l=function(c,p){var h,v;return h=p(c.text),(v=i[c.value])&&(h=h+" <span class='sub'>\u2014 "+v+"</span>"),"<div class='option'>"+h+"</div>"},a.render={item:l,option:l}),(u=n.data("placeholder"))&&(a.placeholder=u),n.hasClass("dropdown")&&(a.maxItems=1),(s=n.data("options"))&&(n.hasClass("options_object")?(a.options=s,a.searchField=["text","keywords"]):a.options=s.map(function(c){return{value:c[0],text:c[1]}}),a.plugins.push("remove_button"),a.delimiter=",",a.persist=!1),(o=n.data("optgroups"))&&(a.optgroups=o),n.selectize(a)})},format_filesize:function(t,e){var r,n,i,o,s;for(e==null&&(e=".file_size_value"),o=t.find(e),s=[],n=0,i=o.length;n<i;n++)r=o[n],r=$(r),s.push(r.html(I.format_bytes(parseInt(r.html()))));return s},adjust_font_size_to_fit:function(t,e){var r,n,i;if(e==null&&(e=16),!!t.length){for(n=t.css("font-size"),n=parseInt(n.match(/\d+/),10),r=t[0],i=[];r.offsetWidth<r.scrollWidth&&(n-=2,!(n<e));)i.push(t.css("font-size",n+"px"));return i}},slug_input:function(t,e){var r;if(r=/[a-z_0-9_-]/g,t.on("keypress",function(n){var i;if(n.keyCode>=32&&(i=String.fromCharCode(n.keyCode),!i.match(r)))return!1}),e&&e.length)return t.on("change",function(n){var i;if(i=I.slugify(e.val()),t.val().match(/^\s*$/)&&i!=="")return t.val(i)}),e.on("change",function(n){if(t.val().match(/^\s*$/))return t.val(I.slugify($(n.currentTarget).val()))})},deferred_links:function(t,e,r){return r||(r=I.delegate_tracking),t.on("mouseup",e,function(n){var i;if(n.which===2)return i=$(n.currentTarget),r(i,n)}),t.on("click",e,function(n){var i,o,s,a;if(n.which===1&&(a=$(n.currentTarget),o=n.metaKey||n.ctrlKey||n.shiftKey||a.attr("target")==="_blank",i=null,o||(i=function(){if(i)return i=null,window.location=a.attr("href")},setTimeout(function(){return typeof i=="function"?i():void 0},200)),(s=r(a,n))!=null&&s.done(i),!o))return!1})},delegate_tracking:function(t){var e;return e=[],t.trigger("i:delegate_tracking",[function(r){return e.push(r)}]),$.when.apply($,e)},ga_tracker:function(t,e,r,n){var i;return i=function(o){var s,a,u,l,c;return s={hitType:"event",eventCategory:(a=o.data("category"))!=null?a:t,eventAction:(u=o.data("action"))!=null?u:e,eventLabel:(l=o.data("label"))!=null?l:r,eventValue:(c=o.data("value"))!=null?c:n},$.Deferred(function(p){return s.hitCallback=function(){return p.resolve()},I.event_with_opts(s)})}},tracked_links:function(){var t,e,r,n,i,o,s;return r=arguments[0],i=2<=arguments.length?ne.call(arguments,1):[],e=i[0],t=i[1],n=i[2],s=i[3],o=I.ga_tracker(e,t,n,s),I.deferred_links(r,"a[data-label]",o),r.on("i:track_link",function(a,u){var l;return u&&(l=u[0]),I.ga_tracker(e,t,l!=null?l:n,s)($(a.target))})},set_cookie:function(t,e,r){return r==null&&(r={}),I.in_dev&&console.log("set cookie:",[t,e],r),Cookies.set(t,e,$.extend({path:"/",domain:"."+$(document.body).data("host")},r))},set_register_referrer:function(t){var e;if(e=I.page_name(),e!=null&&I.set_cookie("ref:register:page_params",e),t!=null)return I.set_cookie("ref:register:action",t)},setup_register_referrers:function(t){if(!I.current_user)return t.on("mouseup","[data-register_action]",function(e){var r;return r=$(e.currentTarget).data("register_action"),I.set_register_referrer(r)})},setup_affiliate_code:function(t,e){var r,n;if(e==null&&(e=!1),t==null&&(t=(n=window.location.search.match(/\bac=([\w\d]+(?:\-[\.:_\w\d]+)?)/))!=null?n[1]:void 0),!!t&&!(!e&&t===Cookies.get("acode")))return I.set_cookie("acode",t,{expires:1}),document.referrer&&I.set_cookie("acode:ref",document.referrer.substring(0,180),{expires:1}),r=window.location.href.replace(/\?.*$/,"").substring(0,180),I.set_cookie("acode:land",r,{expires:1})},bind_checkbox_to_input:function(t,e,r){var n;return n=function(){var i;return i=t.prop("checked"),e.prop("disabled",i),typeof r=="function"?r(i):void 0},t.on("change",n),n()},add_facebook:function(t){var e,r,n;if(!window.FB&&(I.add_facebook=function(){},$('<div id="fb-root"></div>').appendTo(document.body),r="facebook-jssdk",!document.getElementById(r)))return t!=null&&(window.fbAsyncInit=t),e=document.getElementsByTagName("script")[0],n=document.createElement("script"),n.id=r,n.src="//connect.facebook.net/en_GB/sdk.js#xfbml=1&appId=537395183072744&version=v2.0",e.parentNode.insertBefore(n,e)},add_twitter:function(){var t,e,r;if(e="twitter-wjs",!document.getElementById(e))return I.add_twitter=function(){},t=document.getElementsByTagName("script")[0],r=document.createElement("script"),r.id="twitter-wjs",r.src="//platform.twitter.com/widgets.js",t.parentNode.insertBefore(r,t)},add_react:function(){var t,e;return t=$.Deferred(),window.ReactDOM?(t.resolve(),t):(I.add_react=function(){return t},I.libs.react.done(function(){return t.resolve()}),e=$("#lib_react_src"),e.replaceWith($('<script type="text/javascript">').attr("src",e.data("src"))),t)},has_follow_button:function(t,e){var r,n,i,o,s,a,u;return e==null&&(e={}),t=$(t),i=(s=e.cls)!=null?s:"follow_button_widget",r=(a=e.animate_follow)!=null?a:"animate_bounce",n=(u=e.animate_unfollow)!=null?u:"animate_drop_down",o={},o[i]=function(l){var c,p,h,v;if(!I.current_user)return"continue";if(!l.is(".loading"))return l.removeClass(r+" "+n),h=$.Deferred(function(g){return setTimeout(function(){return g.resolve()},500)}),p=l.is(".is_following"),v=p?(_.defer(function(){return l.addClass(n)}),l.data("unfollow_url")):(_.defer(function(){return l.addClass(r)}),l.data("follow_url")),l.addClass("loading").trigger("i:track_link",["follow_btn"]),c=l.data("follow_data")||{},$.when($.post(v,I.with_csrf(c)),h).done(function(g){var y;if(y=g[0],l.removeClass("loading "+r+" "+n),y.errors){I.flash(y.errors.join(", "));return}return l.toggleClass("is_following",y.following).trigger("i:follow_updated",[{user_id:l.data("user_id"),following:y.following,btn:l}])})},t.dispatch("click",o),$(document.body).on("i:follow_updated",function(l,c){var p,h,v;return v=c.user_id,h=c.following,p=c.btn,t.find("."+i+"[data-user_id="+v+"]").not(p).toggleClass("is_following",h)})},is_mobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},is_ios:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},strip_css:function(t){return t.replace(/<\s*\/\s*style\s*>/i,"")},request_fullscreen:function(t,e){var r,n,i;return r=t.requestFullscreen?(t.requestFullscreen(),!0):t.msRequestFullscreen?(t.msRequestFullscreen(),!0):t.mozRequestFullScreen?(t.mozRequestFullScreen(),!0):t.webkitRequestFullscreen?(t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0):!1,r&&e&&(n=window.screen)!=null&&(i=n.orientation)!=null&&typeof i.lock=="function"&&i.lock(e),r},is_fullscreen:function(){return!(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement)},exit_fullscreen:function(){if(document.exitFullscreen)return document.exitFullscreen();if(document.msExitFullscreen)return document.msExitFullscreen();if(document.mozCancelFullScreen)return document.mozCancelFullScreen();if(document.webkitExitFullscreen)return document.webkitExitFullscreen()},toggle_fullscreen:function(t,e){return I.is_fullscreen()?(I.exit_fullscreen(),!1):I.request_fullscreen(t,e)?!0:"failed"},setup_dirty_warning:function(t,e){return e||(e=function(){return t.data("dirty")}),t.data("dirty",!1),$(window).on("beforeunload",function(){var r;if(r=e(),!!r)switch(typeof r){case"string":return r;default:return"You've made modifications to this page."}}),t.on("i:after_submit",function(){return t.data("dirty",!1)}),_.defer(function(){return t.on("change","input, select, textarea",function(r){return t.data("dirty",!0)}),t.on("keydown, mousedown",".redactor-editor",function(){return t.data("dirty",!0)})})},remote_submit:function(t,e,r){var n,i;return r==null&&(r={}),t.trigger("i:before_submit"),r.loading_lock&&(i=t.serializeArray(),n=t.addClass("loading").find("button, input[type='submit']").prop("disabled",!0).addClass("disabled")),$.when(e).then(function(o){var s;return i||(i=t.serializeArray()),o&&(i=i.concat(o)),$.ajax({data:i,type:(s=t.attr("method"))!=null?s:"POST",dataType:"json",url:t.attr("action"),xhrFields:{withCredentials:!0},error:function(a){var u;return u=function(){try{return JSON.parse(a.responseText)}catch(l){}}(),u!=null&&u.errors?I.flash(u.errors.join(", ")):I.flash("We seem to be having server problems right now! Please try again later.")},complete:function(){return r.loading_lock&&(n.prop("disabled",!1).removeClass("disabled"),t.removeClass("loading")),t.trigger("i:after_submit")}}).then(null,function(a){try{return JSON.parse(a.responseText)}catch(u){throw a}})})},is_middle_click:function(t){return t.which===2||t.metaKey||t.ctrlKey},escape_regex:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},move:function(t,e,r){var n,i,o,s;if(i=t.indexOf(e),i===-1)throw"Failed to find object in array";if(s=i+r,s<0||s>=t.length)throw"Movement is outside of array ("+s+") [0, "+(t.length-1)+"]";return n=function(){var a,u,l;for(l=[],a=0,u=t.length;a<u;a++)o=t[a],o!==e&&l.push(o);return l}(),n.splice(s,0,e),n},format_integer:function(t){return t>1e7?Math.floor(t/1e6)+"m":t>=1e6?Math.floor(t/1e5)/10+"m":t>1e4?Math.floor(t/1e3)+"k":t>=1e3?Math.floor(t/100)/10+"k":""+t},store_memory:function(t,e){var r,n,i,o;if(window.localStorage){if(i=function(){try{return JSON.parse(localStorage.getItem(J))}catch(s){}}(),i||(i=[]),i[0]!==t){for(n=function(){var s,a,u;for(u=[],s=0,a=i.length;s<a;s++)r=i[s],t!==r&&u.push(r);return u}(),i=[t].concat(n);i.length>me;)o=i.pop(),typeof localStorage!="undefined"&&localStorage!==null&&localStorage.removeItem(o);localStorage.setItem(J,JSON.stringify(i))}return localStorage.setItem(t,e)}},clear_memory:function(t){var e,r;if(window.localStorage){r=function(){try{return JSON.parse(localStorage.getItem(J))}catch(n){}}(),r&&localStorage.setItem(J,JSON.stringify(function(){var n,i,o;for(o=[],n=0,i=r.length;n<i;n++)e=r[n],t!==e&&o.push(e);return o}()));try{return localStorage.removeItem(t)}catch(n){}}}},$(function(){var t;if((t=window.location.hash.match(/\bflash=([^&]*)/))&&(I.flash(t[1]),window.location.hash=window.location.hash.replace(/\bflash=([^&]*)/,"")),I.ie)return $(document.body).addClass("ie")}),I.Flasher=function(){t.prototype.duration=1e4,t.prototype.animation_duration=250,t.prototype.clipping="-7px";function t(){$(document).on("click",".global_flash",function(e){return function(){return e.dismiss()}}(this))}return t.prototype.dismiss=function(){var e;if(e=this.current_flash)return this.timeout&&(clearTimeout(this.timeout),this.timeout=null),e.css({"margin-top":"-"+(e.outerHeight()+4)+"px"}),setTimeout(function(r){return function(){return e.remove()}}(this),this.animation_duration*2)},t.prototype.show=function(e,r){var n;return this.dismiss(),n=$("<div class='global_flash "+e+"' role='alert' aria-live='polite'>").text(r).appendTo("body"),n.css({"margin-left":"-"+n.width()/2+"px","margin-top":"-"+(n.outerHeight()+4)+"px"}),this.timeout=setTimeout(function(i){return function(){return n.addClass("animated"),n.css({"margin-top":i.clipping}),setTimeout(function(){return i.dismiss()},i.duration)}}(this),100),this.current_flash=n},t}(),_.templateSettings={escape:/\{\{(?![&])(.+?)\}\}/g,interpolate:/\{\{&(.+?)\}\}/g,evaluate:/<%([\s\S]+?)%>/g},$.easing.smoothstep=function(t){return t*t*t*(t*(t*6-15)+10)};var K,Y=K=window.dayjs;window._dayjs_setup||(K.extend(window.dayjs_plugin_duration),K.extend(window.dayjs_plugin_calendar),K.extend(window.dayjs_plugin_advancedFormat),K.extend(window.dayjs_plugin_relativeTime),window._dayjs_setup=!0);var ie,Ge=[].slice;ie=function(t){var e;return(e=typeof t=="string"&&t.match(/(^\d{4}\-\d{1,2}\-\d{1,2}) (\d{1,2}:\d{1,2}:\d{1,2})$/))?e[1]+"T"+e[2]+"Z":t};var we=function(t){return Y(ie(t)).toDate()},ye=function(){var t,e,r,n;switch(n=arguments[0],e=arguments[1],t=3<=arguments.length?Ge.call(arguments,2):[],e==null&&(e="fromNow"),n=ie(n),e){case"fromNow":return Y(n).fromNow();case"calendar":return Y(n).calendar(null,{sameElse:"MMMM Do YYYY"});case"format":return(r=Y(n)).format.apply(r,t);default:throw new Error("unknown method for format_timestamp: "+e)}},be;$.fn.dispatch=function(t,e){return this.on(t,function(r){return function(n){var i,o,s,a;for(s in e)if(o=e[s],i=$(n.target).closest("."+s),!!i.length)return i.is(".disabled")?!1:i.is("a")&&n.ctrlKey||(a=o(i,n),a==="continue")?void 0:!1;return null}}(this)),this},$.fn.exists=function(){return this.length>0?this:!1},$.fn.format_timestamps=function(t){var e,r,n,i,o;for(t==null&&(t="calendar"),o=this.find(".date_format"),r=function(s){var a,u,l;return a=s.data("format"),u=s.html(),l=a?ye(u,"format",a):ye(u,t),s.html(l).attr("title",u+" UTC")},n=0,i=o.length;n<i;n++)e=o[n],r($(e));return this},$.fn.has_tooltips=function(t){var e,r,n,i,o,s;if(t==null&&(t={}),!I.is_mobile())return o=function(){var a;return a=$('<div class="tooltip_drop"></div>'),$(document.body).append(a),o=function(){return a},a},s=_.template('<div class="tooltip">{{ label }}</div>'),i=function(a,u){var l,c,p,h;return u==null&&(u=!1),l=a.data("tooltip_el"),l||(l=$(s({label:a.attr("aria-label")||a.data("tooltip")})),a.data("tooltip_el",l)),l.removeClass("visible"),o().empty().append(l),p=a.offset(),c=l.outerHeight(),h=l.outerWidth(),l.css({position:"absolute",top:t.below?p.top+a.outerHeight()+10:p.top-c-10,left:Math.floor(p.left+(a.outerWidth()-h)/2)}),l.toggleClass("below",!!t.below),u?l.addClass("visible"):setTimeout(function(v){return function(){return l.addClass("visible")}}(this),10)},r=function(a){return function(u){var l,c;if(c=$(u.currentTarget),l=c.data("tooltip_el"),c.removeData("tooltip_el"),!!l&&l.is(":visible"))return i(c,!0)}}(this),n=function(a){return function(u){var l;if(l=$(u.currentTarget),!l.closest(".redactor-box").length)return i(l)}}(this),e=function(a){return function(u){var l,c;if(c=$(u.currentTarget),l=c.data("tooltip_el"))return l.remove()}}(this),this.is("[data-tooltip]")?(this.on("i:refresh_tooltip",r),this.on("mouseenter focus",n),this.on("mouseleave blur i:hide_tooltip",e)):(this.on("i:refresh_tooltip","[data-tooltip], [aria-label]",r),this.on("i:clear_tooltips",function(){return o().empty()}),this.on("mouseenter focus","[data-tooltip], [aria-label]",n),this.on("mouseleave blur i:hide_tooltip","[data-tooltip], [aria-label]",e)),this},$.fn.inline_edit=function(t){var e,r,n;if(t==null&&(t={}),this.is(".inline_editing")){this.data("finished_editing")();return}return this.addClass("inline_editing"),r=$('<input type="text" class="inline_edit_input" />').attr("placeholder",this.data("placeholder")).val((typeof t.get_val=="function"?t.get_val(this):void 0)||this.text()).insertAfter(this.hide()).select(),e=function(i){return function(){return r.remove(),i.show(),$(document).off("click.inline_editing"),i.removeClass("inline_editing")}}(this),this.data("finished_editing",e),n=function(i){return function(){return r.prop("disabled",!0),t.set_val?t.set_val(i,r.val(),e):(i.text(r.val()),e())}}(this),$(document).on("click.edit_title",function(i){return function(o){if(!$(o.target).closest(".inline_edit_input").length)return n()}}(this)),r.on("keydown",function(i){return function(o){switch(o.keyCode){case 9:return _.defer(function(){return n()});case 13:return n();case 27:return e()}}}(this))},I.support_passive_scroll=function(){var t,e;e=!1;try{t=Object.defineProperty({},"passive",{get:function(r){return function(){return e=!0}}(this)}),window.addEventListener("test",null,t)}catch(r){}return e},I.support_intersection_observer=function(){return"IntersectionObserver"in window},be=function(t,e){var r,n,i,o,s,a,u,l;for(t.removeClass("lazy_images"),n=t.find("[data-background_image]").addBack("[data-background_image]"),o=function(){var c,p,h;for(h=[],c=0,p=n.length;c<p;c++)r=n[c],h.push(function(v){var g;if(v=$(v),g=v.data("background_image"),v.css({backgroundImage:"url("+g+")"}),e)return $.Deferred(function(y){return function(x){return $("<img />").attr("src",g).on("load",function(){return x.resolve()})}}(this))}(r));return h}(),l=t.find("img[data-lazy_src]").addBack("img[data-lazy_src]"),i=function(c){var p,h;if(c=$(c),p=c.data("lazy_src"),c.attr("src",p),(h=c.data("lazy_srcset"))&&c.attr("srcset",h),e)return $.Deferred(function(v){return function(g){return c.on("load",function(){return g.resolve()})}}(this))},a=0,u=l.length;a<u;a++)s=l[a],i(s);if(e)return o.length===1?o[0]:$.when.apply($,o)},$.fn.lazy_images=function(t){var e,r,n,i,o,s,a,u,l,c,p,h,v,g,y,x;if(p=this.data("lazy_images"))return p();if(u=t!=null&&t.elements?function(){var k,z,C,f;for(C=t.elements,f=[],k=0,z=C.length;k<z;k++)n=C[k],f.push($(n));return f}():(h=(t!=null?t.selector:void 0)||".lazy_images",function(){var k,z,C,f;for(C=this.find(h),f=[],k=0,z=C.length;k<z;k++)n=C[k],f.push($(n));return f}.call(this)),e=(c=t!=null?t.show_images:void 0)!=null?c:be,I.support_intersection_observer()){for(i=function(k){var z,C,f,d,m,b;for(b=[],f=0,d=k.length;f<d;f++)C=k[f],C.isIntersecting?(n=C.target,s.unobserve(n),n=$(n),m=t!=null?t.show_item:void 0,z=e(n,!!m),b.push(typeof m=="function"?m(n,z):void 0)):b.push(void 0);return b},s=new IntersectionObserver(i,{}),a=0,l=u.length;a<l;a++)n=u[a],s.observe(n[0]);return function(){return s.disconnect()}}return x=$(window),v=t!=null?t.target:void 0,o=t!=null?t.horizontal:void 0,y=null,r=function(k){return function(){var z,C,f,d,m,b,j,D,T;for(z=function(){if(v){if(o)return v.outerWidth()+v.position().left;throw new Error("not yet")}else return x.scrollTop()+x.height()}(),f=0,d=b=0,j=u.length;b<j;d=++b)if(m=u[d],!!m){if(!document.body.contains(m[0])){u[d]=null,f+=1;continue}T=function(){if(v){if(o)return m.position().left;throw new Error("not yet")}else return m.offset().top}(),m[0].offsetParent&&T<z&&(D=t!=null?t.show_item:void 0,C=e(m,!!D),typeof D=="function"&&D(m,C),f+=1,u[d]=null)}if(f>0)return u=function(){var E,N,P;for(P=[],E=0,N=u.length;E<N;E++)n=u[E],n&&P.push(n);return P}()}}(this),g=_.throttle(r,100),v?(v.on("scroll",g),x.on("resize",g),y=function(){return v.off("scroll",g),x.off("resize","throttled")}):I.support_passive_scroll()?(window.addEventListener("scroll",g,{passive:!0}),x.on("resize i:reshape",g),y=function(){return window.removeEventListener("scroll",g,{passive:!0}),x.off("resize",g)}):(x.on("scroll resize i:reshape",g),y=function(){return x.off("scroll resize i:reshape",g)}),this.data("lazy_images",function(k){return function(){return u=t!=null&&t.elements?function(){var z,C,f,d;for(f=t.elements,d=[],z=0,C=f.length;z<C;z++)n=f[z],d.push($(n));return d}():(h=(t!=null?t.selector:void 0)||".lazy_images",function(){var z,C,f,d;for(f=this.find(h),d=[],z=0,C=f.length;z<C;z++)n=f[z],d.push($(n));return d}.call(k)),r()}}(this)),r(),y},$.fn.max_height=function(t){var e,r,n;return t==null&&(t=0),n=$(window),e=this.outerHeight(!0)-this.height(),r=function(i){return function(){return i.css("min-height",n.height()-e-t+"px")}}(this),n.on("resize",r),r()},$.fn.remote_link=function(t){return this.on("click","[data-remote]",function(e){return function(r){var n,i,o,s,a;if(r.preventDefault(),i=$(r.currentTarget),!i.is(".loading")&&(s=i.data("method")||"POST",a=I.with_csrf($.extend({},i.data("params"))),o=i.data("href")||i.attr("href"),!((n=i.data("confirm"))&&!confirm(n))))return i.addClass("loading").prop("disabled",!0),$.ajax({type:s,url:o,data:a,xhrFields:{withCredentials:!0}}).done(function(u){return i.removeClass("loading").prop("disabled",!1),typeof t=="function"?t(u,i):void 0}),null}}(this))},$.fn.remote_submit=function(t,e,r){var n;return n=null,this.on("click","button[name], input[type='submit'][name]",function(i){return function(o){var s;return s=$(o.currentTarget),n!=null&&n.remove(),n=$("<input type='hidden' />").attr("name",s.attr("name")).val(s.attr("value")).prependTo(i)}}(this)),this.on("submit",function(i){return function(o,s){var a;if(o.preventDefault(),a=$(o.currentTarget),!(e&&!(typeof e=="function"&&e(a))))return I.remote_submit(a,r,{loading_lock:!0}).done(function(u){return a.data("dirty",!1),s!=null?s(u,a):t(u,a)}),null}}(this))},$.fn.remote_table=function(){var t,e,r,n;return r=this.data("max_page"),t=function(i){return function(){return i.data("page")||1}}(this),n={},e=function(i){return function(o){var s,a;if(!i.is(".loading")&&1<=o&&o<=r)return s=i.find("table"),i.addClass("loading").data("page",o).toggleClass("first_page",o===1).toggleClass("last_page",o===r).find(".current_page").text(o),a=n[o]||(n[o]=$.get(i.data("remote_url")+"?"+$.param({page:o}))),a.done(function(u){return i.removeClass("loading"),s.html(u.content)})}}(this),this.dispatch("click",{next_page_btn:function(i){return function(){return e(t()+1)}}(this),prev_page_btn:function(i){return function(){return e(t()-1)}}(this)})},$.fn.set_form_errors=function(t,e,r){var n,i,o,s,a,u,l,c;if(e==null&&(e=!0),r==null&&(r="Errors"),this.find(".form_errors").remove(),a=!!(t!=null&&t.length),this.toggleClass("has_errors",a),a){for(o=$(_.template(`<div class="form_errors">
  <div>{{ msg }}:</div>
  <ul></ul>
</div>`)({msg:r})),s=o.find("ul"),u=0,l=t.length;u<l;u++)i=t[u],s.append($("<li></li>").text(i));this.prepend(o),e&&(c=this.closest(".lightbox"),c.length||this.offset().top>$(window).height()/2?typeof(n=this[0]).scrollIntoView=="function"&&n.scrollIntoView():$("html, body").animate({scrollTop:0},"fast"))}return this},$.fn.swap_with=function(t){var e,r,n,i,o,s,a,u;if(t=$(t),!!(this.length&&t.length))return r=this.offset(),i=t.offset(),u=this.prop("tagName"),s=t.prop("tagName"),a=$("<"+u+"></"+u+">").insertAfter(this),o=$("<"+s+"></"+s+">").insertAfter(t),a.after(t),o.after(this),e=this.offset(),n=t.offset(),o.replaceWith(this.detach().css({position:"relative",top:r.top-e.top+"px",left:r.left-e.left+"px"})),a.replaceWith(t.detach().css({position:"relative",top:i.top-n.top+"px",left:i.left-n.left+"px"})),_.defer(function(l){return function(){return l.css({top:"",left:""}),t.css({top:"",left:""})}}(this))},$.fn.track_input=function(t,e){var r,n;return r=this.find(t),n=function(i){return function(){var o,s,a;return a=function(){var u,l,c;for(c=[],u=0,l=r.length;u<l;u++)s=r[u],c.push(e+"_"+$(s).attr("value"));return c}(),i.removeClass(a.join(" ")),o=r.serializeArray().map(function(u){return e+"_"+u.value}),i.addClass(o.join(" "))}}(this),r.on("change",function(i){return n()}),n()};var wt=_e(ge()),He,w=He=window.$,O=[].slice,Ye=function(t,e){for(var r in e)Ve.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},Ve={}.hasOwnProperty;I.Lightbox&&console.warn("I.Lightbox is being double declared");var Je=I.Lightbox||(I.Lightbox=function(){t.include_dependencies=function(e){var r;return e?(r=[],e.redactor&&!w.fn.redactor&&(w("head").append(e.redactor),r.push(I.libs.redactor)),e.selectize&&!w.fn.selectize&&(w("head").append(e.selectize),r.push(I.libs.selectize)),r):[]},t.lightbox_container=function(){return this._container||(this._container=w("#lightbox_container").exists()||w('<div id="lightbox_container"></div>').appendTo("body"))},t.shroud_container=function(){return this._shroud||(this._shroud=w("#lightbox_shroud").exists()||w('<div id="lightbox_shroud"></div>').appendTo("body"))},t.show_shroud=function(){var e;if(!this.shroud_visible)return this._shroud||(e=this.shroud_container(),this.lightbox_container().on("click",function(r){return function(n){if(!w(n.target).closest(".lightbox").length)return w(n.target).attr("href")==="javascript:void(0)"?void 0:r.close()}}(this)),e.on("click",function(r){return function(){return r.close()}}(this)),w(document.body).on("keydown",function(r){return function(n){return n.keyCode===27?(n.preventDefault(),n.stopPropagation(),r.close()):r.on_keydown(n)}}(this)),w(window).on("resize",function(r){return function(n){return r.on_resize(n)}}(this))),this.shroud_visible=!0,this.shroud_container().addClass("invisible").show(),_.defer(function(r){return function(){return r.shroud_container().removeClass("invisible")}}(this))},t.hide_shroud=function(){return this.shroud_visible=!1,this.shroud_container().hide()},t.open_loading=function(){return this.open_tpl("loading_lightbox",I.Lightbox)},t.open_remote_react=function(e,r){return this.open_loading(),w.when(I.add_react(),w.ajax({dataType:"json",url:e,data:{props:!0},xhrFields:{withCredentials:!0},error:function(n){return function(i,o,s){var a,u,l;return l=function(){try{return JSON.parse(i.responseText)}catch(c){}}(),a=(u=l!=null?l.errors:void 0)!=null?u:["Something went wrong. Please try again later and contact support if it persists."],R.ErrorLightbox?I.Lightbox.open(R.ErrorLightbox({errors:a})):(alert(a.join(",")),n.close())}}(this)})).done(function(n){return function(i,o){var s,a;if(a=o[0],a.errors){R.ErrorLightbox?I.Lightbox.open(R.ErrorLightbox(a)):(alert(a.errors.join(",")),n.close());return}return s=I.Lightbox.include_dependencies(a._dependencies),w.when.apply(w,[r(a)].concat(O.call(s))).then(function(u){return u?I.Lightbox.open(u):n.close()})}}(this))},t.open_remote=function(){var e,r,n;return n=arguments[0],e=arguments[1],r=3<=arguments.length?O.call(arguments,2):[],e==null&&(e=I.Lightbox),this.open_loading(),w.ajax({dataType:"json",url:n,data:{lightbox:!0},xhrFields:{withCredentials:!0},success:function(i){return function(o){if(o.errors){alert(o.errors.join(",")),i.close();return}return i.open.apply(i,[o.content,e].concat(O.call(r)))}}(this),error:function(i){return function(o,s,a){return alert("Something went wrong. Please try again later and contact support if it persists."),i.close()}}(this)})},t.open_tpl=function(){var e,r,n;if(n=arguments[0],e=2<=arguments.length?O.call(arguments,1):[],r=w("#"+n+"_tpl"),!r.length)throw"missing template for lightbox: "+n;return this.open.apply(this,[r.html()].concat(O.call(e)))},t.open_tpl_with_params=function(){var e,r,n,i,o;if(o=arguments[0],i=arguments[1],e=3<=arguments.length?O.call(arguments,2):[],r=w("#"+o+"_tpl"),!r.length)throw"missing template for lightbox: "+o;return n=_.template(r.html())(i),this.open.apply(this,[n].concat(O.call(e)))},t.open=function(){var e,r,n,i,o,s;return n=arguments[0],e=arguments[1],r=3<=arguments.length?O.call(arguments,2):[],e==null&&(e=I.Lightbox),this.current_lightbox&&(this.current_lightbox.close(),this.current_lightbox=null),s=!1,n.$$typeof?(s=!0,i=new I.ReactLightbox(n,this)):(typeof n=="string"&&(n=w.trim(n)),o=w(n),(i=o.data("object"))||(s=!0,i=function(a,u,l){l.prototype=a.prototype;var c=new l,p=a.apply(c,u);return Object(p)===p?p:c}(e,[o,this].concat(O.call(r)),function(){}),o.data("object",i))),w(document.body).addClass("lightbox_open"),this.show_shroud(),i.show(s),this.current_lightbox=i,i},t.close=function(){var e;if(!(this.current_lightbox&&!this.current_lightbox.is_closable())&&!(this.current_lightbox&&this.current_lightbox.el.is(".has_changes")&&!confirm("You've have unsaved changes in this dialog. Are you sure you want to close it?")))return this.hide_shroud(),(e=this.current_lightbox)!=null&&e.close(),this.current_lightbox=null,w(document.body).removeClass("lightbox_open")},t.on_keydown=function(e){var r,n;return(r=this.current_lightbox)!=null&&(n=r.el)!=null?n.trigger("i:lightbox_keydown",e):void 0},t.on_resize=function(e){var r,n;return(r=this.current_lightbox)!=null&&(n=r.el)!=null?n.trigger("i:lightbox_resize",e):void 0},t.prototype.lightbox_hidden=function(e){};function t(){var e,r,n;e=arguments[0],r=arguments[1],n=3<=arguments.length?O.call(arguments,2):[],this.parent=r,this.el=w(e),this.el.on("click",".close_button, .close_btn",function(i){return function(o){return I.Lightbox.close(),!1}}(this)),this.init.apply(this,n)}return t.prototype.init=function(){},t.prototype.first_show=function(){},t.prototype.with_selectize=function(e){var r;if(!w.fn.selectize){if(r=this.el.data().selectize,!r)throw"missing selectize include in lightbox";w("head").append(r)}return I.with_selectize(e)},t.prototype.with_redactor=function(e){var r;if(!w.fn.redactor){if(r=this.el.data().redactor,!r)throw"missing redactor include in lightbox";w("head").append(r)}return I.libs.redactor.done(e)},t.prototype.show=function(e){if(this.el.appendTo(this.parent.lightbox_container()).addClass("animated").show().trigger("i:lightbox_open"),this.position(),e)return this.first_show()},t.prototype.close=function(){return this.el.removeClass("animated").hide().trigger("i:lightbox_close").remove()},t.prototype.position=function(){var e;return e=this.parent.lightbox_container().css("position")==="fixed"?"":w(window).scrollTop()+"px",this.el.css({top:e})},t.prototype.closable=!0,t.prototype.is_closable=function(){return this.closable},t}()),yt=I.ReactLightbox||(I.ReactLightbox=function(t){Ye(e,t);function e(){var r,n,i,o,s,a;r=arguments[0],i=arguments[1],s=3<=arguments.length?O.call(arguments,2):[],a=w('<div class="react_lightbox"></div>').appendTo(i.lightbox_container()),o=ReactDOM.render(r,a[0]),n=ReactDOM.findDOMNode(o),e.__super__.constructor.apply(this,[n,i].concat(O.call(s)))}return e.prototype.show=function(r){return this.el.addClass("animated"),this.position()},e.prototype.close=function(){var r;return this.el.trigger("i:lightbox_close"),r=this.el.parent(),ReactDOM.unmountComponentAtNode(r[0]),r.remove()},e}(I.Lightbox)),Ke=function(t,e){return function(){return t.apply(e,arguments)}};I.GameCarousel=function(){t.prototype.edge_threshold=5,t.prototype.margin=20,t.prototype.inner_padding=10,t.prototype.paddle_margin_bottom=30,t.prototype.cell_class=".game_cell",t.prototype.add_image_loading=function(){return this.el.lazy_images({show_item:function(e){return function(r){return r.trigger("i:impression"),r.find(".image_loading").addBack(".image_loading").removeClass("image_loading")}}(this)})};function t(e,r){this.add_image_loading=Ke(this.add_image_loading,this),this.el=$(e),$.extend(this,r),this.scroll_outer=this.el.find(".scrolling_outer"),this.scroll_inner=this.el.find(".scrolling_inner"),this.paddles=this.el.find(".paddle_next, .paddle_prev"),I.is_mobile()?(this.el.find(".scrollbar_outer").remove(),this.paddles.remove()):this.setup_scrollbar(),new I.GameCells(this.el),_.defer(function(n){return function(){return n.add_image_loading()}}(this)),this.el.dispatch("click",{paddle_next:function(n){return function(i){return n.scroll_to(n.cell_offset(n.current_cell()+3)),i.trigger("i:track_link")}}(this),paddle_prev:function(n){return function(i){return n.scroll_to(n.cell_offset(n.current_cell()-3)),i.trigger("i:track_link")}}(this)}),this.update_height(),$(window).on("resize",_.debounce(function(n){return function(){return n.update_scrollbar()}}(this),100)),this.el.on("i:carousel:update_scrollbar",function(n){return function(){return n.update_scrollbar()}}(this)),_.defer(function(n){return function(){return n.el.addClass("ready"),n.update_height()}}(this))}return t.prototype.tallest_child=function(){var e,r,n,i,o,s,a,u;for(a=null,u=null,s=this.scroll_inner.children(),n=i=0,o=s.length;i<o;n=++i)e=s[n],e=$(e),a?(r=e.outerHeight(!0),r>u&&(a=e,u=r)):(a=e,u=e.outerHeight(!0));return a},t.prototype.update_height=function(){var e,r;return r=this.tallest_child(),e=r.outerHeight(!0),e+=this.inner_padding*2,this.scroll_outer.css({height:e+"px"}),this.paddles.css({height:e-this.paddle_margin_bottom+"px"}),this.update_scrollbar()},t.prototype.setup_scrollbar=function(){return this.have_scrollbar=!0,this.scrollbar_outer=this.el.find(".scrollbar_outer"),this.scrollbar_inner=this.el.find(".scrollbar_inner"),this.scroll_inner.on("scroll",function(e){return function(){return e.update_scrollbar()}}(this)),this.scrollbar_inner.draggable({move:function(e){return function(r,n){if(e.unit_scroll)return e.scroll_inner[0].scrollLeft+=r*e.unit_scroll}}(this)}),this.update_scrollbar()},t.prototype.current_cell=function(){var e,r,n,i,o,s;for(r=this.el.find(this.cell_class),n=Math.floor(r.width()/2),i=o=0,s=r.length;o<s;i=++o)if(e=r[i],$(e).position().left+n>=0)return i;return 0},t.prototype.cell_offset=function(e){var r,n,i;return e=Math.max(0,e),r=this.el.find(this.cell_class+":eq("+e+")"),n=this.max_scroll(),i=r.length?r.position().left+this.scroll_pos()-this.margin:n,Math.min(i,n)},t.prototype.scroll_to=function(e){var r,n;if(!this.scroll_inner.is(":animated"))return r=this.scroll_pos(),n=Math.abs(r-e),this.scroll_inner.animate({scrollLeft:e},n/2)},t.prototype.scroll_pos=function(){return this.scroll_inner[0].scrollLeft},t.prototype.max_scroll=function(){return this.scroll_inner[0].scrollWidth-this.scroll_outer.innerWidth()},t.prototype.update_scrollbar=function(){var e,r,n,i;if(this.have_scrollbar)return n=this.scroll_outer.innerWidth(),r=this.scroll_inner[0].scrollWidth,e=r-n>this.edge_threshold,this.el.toggleClass("no_scrollbar",!e),e?(i=this.scroll_pos(),this.scrollbar_inner.css({width:100*n/r+"%",left:100*i/r+"%"}),this.unit_scroll=r/this.scroll_outer.width(),this.el.toggleClass("on_left",i<=this.edge_threshold),this.el.toggleClass("on_right",i>=this.max_scroll()-this.edge_threshold)):this.el.removeClass("on_left on_right")},t}(),I.ContentWarning=function(){function t(e,r){this.opts=r,this.el=$(e),this.setup_forms()}return t.prototype.setup_forms=function(){var e;return e=this.el.find("form"),e.remote_submit(function(r){return function(n){if(n.errors){e.set_form_errors(n.errors);return}return r.el.addClass("hidden"),setTimeout(function(){return r.el.remove()},300),e.set_form_errors([])}}(this))},t}();var Xe=function(t,e,r){var n,i,o,s,a,u,l,c,p;for(e==null&&(e=null),r==null&&(r=!0),typeof t=="number"&&(t=Y.duration(t)),l=[["y","years","a year"],["m","months","a month"],["d","days","a day"],["h","hours","an hour"],["m","minutes","a minute"],["s","seconds","a second"]],a=[],i=0,s=l.length;i<s&&(u=l[i],!(e&&a.length===e));i++)o=u[0],n=u[1],c=u[2],p=t[n](),p>0&&(p>1?n==="seconds"&&r?a.push("a few seconds"):a.push(p+" "+n):a.push(c));return a.length>1&&(a[a.length-1]="and "+a[a.length-1]),a.join(", ")},Qe=function(t,e){return function(){return t.apply(e,arguments)}},Ze=function(t,e){for(var r in e)et.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},et={}.hasOwnProperty;I.Countdown=function(){t.prototype.max_blocks=4;function t(e,r,n){this.date=r,this.opts=n!=null?n:{},this.opts.max_blocks&&(this.max_blocks=this.opts.max_blocks),this.el=$(e),this.update_countdown(),window.setInterval(function(i){return function(){return i.update_countdown()}}(this),1e3)}return t.prototype.update_countdown=function(){var e,r,n,i,o,s,a,u,l,c,p,h,v,g,y,x,k,z;for(p=["years","months","days","hours","minutes","seconds"],e=Y.duration(we(this.date)-new Date),r=!0,k=function(){var C,f,d;for(d=[],C=0,f=p.length;C<f;C++)l=p[C],z=e[l](),!(z===0&&r)&&(z>0&&(r=!1),d.push([l,z]));return d}(),k=k.slice(0,this.max_blocks),v={},n=0,a=k.length;n<a;n++)h=k[n],l=h[0],x=h[1],v[l]=x;for(g=[],i=0,u=p.length;i<u;i++)l=p[i],c=this.el.find("[data-name='"+l+"']"),z=v[l]||0,y=v[l]==null,y||(o=c.find(".block_label"),s=o.text(),o.text(s.replace(/s$/,"")+(z===1?"":"s"))),g.push(c.toggleClass("hidden",y).find(".block_value").text(z));return g},t}(),I.TimestampCountdown=function(t){Ze(e,t);function e(){return this.update_countdown=Qe(this.update_countdown,this),e.__super__.constructor.apply(this,arguments)}return e.prototype.update_countdown=function(){var r;return r=we(this.date)-new Date,r<0&&(r=-r),this.el.text(Xe(r,1,!1))},e}(I.Countdown),$.fn.draggable=function(t){var e,r,n,i,o,s,a,u;return t==null&&(t={}),u="ontouchstart"in document,t.mobile===!1&&(u=!1),e=$(document.body),o=$("html"),s=0,a=0,i=function(l){return function(c){return e.removeClass("dragging"),l.removeClass("dragging"),o.off("mousemove touchmove",r),typeof t.stop=="function"?t.stop():void 0}}(this),r=function(l){return function(c,p,h){var v,g;return v=p-s,g=h-a,s+=v,a+=g,typeof t.move=="function"?t.move(v,g):void 0}}(this),n=function(l){return function(c,p,h){if(!e.is(".dragging")&&!(typeof t.skip_drag=="function"&&t.skip_drag(c)))return e.addClass("dragging"),l.addClass("dragging"),s=p,a=h,typeof t.start=="function"&&t.start(),!0}}(this),u?this.on("touchstart",function(l){return function(c){var p,h,v;p=c.originalEvent.targetTouches[0],h=p.pageX,v=p.pageY,n(c,h,v)&&(o.one("touchend",i),r=function(g){return function(y){var x;return x=y.originalEvent.targetTouches[0],h=x.pageX,v=x.pageY,g(y,h,v)}}(r),o.on("touchmove",r))}}(this)):this.on("mousedown",function(l){return function(c){if(n(c,c.pageX,c.pageY))return o.one("mouseup",i),r=function(p){return function(h){return p(h,h.pageX,h.pageY)}}(r),o.on("mousemove",r)}}(this))};var tt=function(t,e){for(var r in e)rt.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},rt={}.hasOwnProperty;I.FeedbackLightbox=function(t){tt(e,t);function e(){return e.__super__.constructor.apply(this,arguments)}return e.prototype.init=function(){return this.el.find("form").remote_submit(function(r){return function(n){if(n.errors){alert(n.errors.join(", "));return}return r.el.addClass("is_complete")}}(this))},e}(I.Lightbox),I.FeedbackWidget=function(){function t(e){this.el=$(e),this.el.on("click",function(r){return function(n){var i;return i=$(n.target).data("url")+"?"+$.param({url:window.location.href}),I.Lightbox.open_remote(i,I.FeedbackLightbox)}}(this))}return t}(),I.FilterPickers=function(){t.prototype.label_padding=10;function t(e,r){var n,i;this.opts=r!=null?r:{},this.el=$(e),n=this.el.find(".filter_picker_widget"),this.opts.label_padding&&(this.label_padding=this.opts.label_padding),i=function(o){return function(){return n.removeClass("open popup_visible").find(".filter_options").css({marginTop:""})}}(this),$(window).on("click",function(o){return function(s){if(!$(s.target).closest(".filter_picker_widget").length)return i()}}(this)),this.el.on("i:close_filter_pickers",i),this.el.on("click",".filter_picker_widget .filter_value",function(o){return function(s){var a,u,l;return s.preventDefault(),u=$(s.currentTarget).closest(".filter_picker_widget"),u.trigger("i:track_link"),n.not(u).removeClass("open popup_visible"),u.toggleClass("open"),a=u.find(".filter_value").height(),u.find(".filter_options").css({marginTop:a+o.label_padding*2,minWidth:u.width()+30+"px"}),l=$(window).width()-u.position().left+u.width(),u.toggleClass("popup_left",l<200),_.defer(function(){return u.toggleClass("popup_visible",u.is(".open"))})}}(this))}return t}();var S=window.I;S.Lightbox||console.warn("I.Lightbox is being depended on but is missing from the page");var G=S.Lightbox,nt=function(t,e){for(var r in e)it.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},it={}.hasOwnProperty,ot=function(t){nt(e,t);function e(){return e.__super__.constructor.apply(this,arguments)}return e.prototype.init=function(r){return this.el.dispatch("click",{tab_btn:function(n){return function(i){var o;return o=i.data("tab"),n.el.find(".tab_content").hide().filter("[data-tab="+o+"]").show(),n.el.find(".tab_btn").removeClass("selected").filter(i).addClass("selected")}}(this),pick_image_btn:function(n){return function(i){return typeof r=="function"?r(i.data("url")):void 0}}(this),upload_image_btn:function(n){return function(i){return S.upload_image({url:S.root_url("dashboard/upload-image"),thumb_size:"original"}).progress(function(){if(!i.prop("disabled"))return i.prop("disabled",!0).addClass("disabled"),i.data("original_text",i.text()),i.text("Uploading...")}).fail(function(){return i.prop("disabled",!1).removeClass("disabled"),i.text(i.data("original_text"))}).done(function(o){var s,a;return i.prop("disabled",!1).removeClass("disabled"),i.text(i.data("original_text")),o.success?typeof r=="function"?r(o.upload.thumb_url):void 0:(s=((a=o.errors)!=null?a[0]:void 0)||"Image upload failed",S.flash(s,"error"))})}}(this)})},e}(G),xe=null,st={plugins:["source","table","alignment","video","addimage"],toolbarFixed:!1,buttons:["format","bold","italic","deleted","lists","link"],minHeight:250,linkSize:80},at=function(t,e){var r,n;if(e==null&&(e={}),!window.location.href.match(/\bredactor=0\b/)&&!S.in_test){if(!w.fn.redactor){console.warn("tried to create redactor text element without redactor on page",t[0]);return}e=w.extend({},st,e),e.source===!1&&(delete e.source,e.plugins=function(){var i,o,s,a;for(s=e.plugins,a=[],i=0,o=s.length;i<o;i++)n=s[i],n!=="source"&&a.push(n);return a}()),t.closest(".lightbox_widget").exists()&&e.plugins&&(e.plugins=function(){var i,o,s,a;if(n!=="addimage"){for(s=e.plugins,a=[],i=0,o=s.length;i<o;i++)n=s[i],a.push(n);return a}}());try{return t.redactor(e)}catch(i){return r=i,S.event("error","redactor","invalid_content"),t.parent().replaceWith(t).end().val("").redactor(e)}}};w.Redactor?xe=w.Redactor:S.libs.redactor.done(function(){return xe=w.Redactor,w.Redactor.prototype.addimage=function(){return{langs:{en:{}},init:function(){var t;return t=this.button.addAfter("image","image","Add image"),this.button.setIcon(t,'<i class="re-icon-image"></i>'),this.button.addCallback(t,this.addimage.show)},show:function(){return G.open_remote(S.root_url("dashboard/upload-image"),ot,function(t){return function(e){var r;return S.Lightbox.close(),r=w("<img>").attr("src",e)[0].outerHTML,t.placeholder.hide(),t.buffer.set(),t.insert.html(r)}}(this))}}}});var ut=function(t,e){for(var r in e)lt.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},lt={}.hasOwnProperty,ke=S.CollectionLightbox=function(t){ut(e,t);function e(){return e.__super__.constructor.apply(this,arguments)}return e.prototype.init=function(){var r;return S.has_follow_button(this.el),S.event2("view add to collection lightbox"),this.el.find("input[type='radio']:first").prop("checked",!0),this.el.on("click change",".collection_option",function(n){return function(i){var o;return o=$(i.currentTarget),o.find("input[type='radio']").prop("checked",!0)}}(this)),r=this.el.find("form").remote_submit(function(n){return function(i){if(i.errors){if(S.add_recaptcha_if_necessary(r,i.errors))return;r.set_form_errors(i.errors);return}return n.el.addClass("is_complete"),n.el.find(".after_submit .collection_name").text(i.title).attr("href",i.url)}}(this)),this.with_redactor(function(n){return function(){return at(n.el.find("textarea"),{minHeight:40,source:!1,buttons:["bold","italic","deleted","lists","link"]})}}(this)),this.with_selectize(function(n){return function(){return n.el.find("select.collection_input").selectize()}}(this))},e}(G),ct=function(t,e){return function(){return t.apply(e,arguments)}},ft=I.GamePopups=function(){t.prototype.trigger_selector=".game_thumb",t.prototype.popup_selector=".popup_details",t.prototype.hover_delay=250,t.prototype.close_timeout=200,t.prototype.x_offset=0;function t(e,r){var n;r==null&&(r={}),this.deferred_for_el=ct(this.deferred_for_el,this),!I.is_mobile()&&(this.el=w(e),w.extend(this,r),n=w(document.body),this.el.on("mouseenter mouseleave",this.trigger_selector,function(i){return function(o){if(e=w(o.currentTarget),!e.closest(".jam_cell").length&&!e.closest(".disable_hover").length)return o.type==="mouseenter"?i.enter(e):i.leave(e)}}(this)),n.on("i:hide_popups",function(i){return function(o,s){return i.close_popup()}}(this)),n.on("i:hide_other_popups",function(i){return function(o,s){if(s!==i)return i.close_popup()}}(this)))}return t.prototype.deferred_for_el=function(e){var r,n,i;if(r=e.data("i:popup_defer"),!r){if(n=e.closest("[data-game_id]").data("game_id"),r=w.Deferred(),e.data("i:popup_defer",r),!n)return;i=I.subdomain?"/-/game/popup/"+n:"/game/popup/"+n,w.get(i,function(o){return function(s){var a;if(!(_.isObject(s)&&s.errors))return a=w(s),a.data("object_id",n),I.tracked_links(a,"popups",I.page_name(),"click"),a.find("a").on("click",function(){var u;if(u=a.data("trigger_el"))return u.trigger("i:track_link")}),r.resolve(a)}}(this))}return r},t.prototype.enter=function(e){var r,n;return e.data("i:inside",!0),n=_.debounce(function(i){return function(){if(e.data("i:inside"))return i.deferred_for_el(e).then(function(o){return i.show_popup(e,o)})}}(this),this.hover_delay),r=_.debounce(function(i){return function(){var o;if(e.data("i:inside"))return o=new Date,i.deferred_for_el(e)}}(this),this.hover_delay/2),e.on("mousemove.hover_manager",function(){return n(),r()})},t.prototype.leave=function(e){return e.data("i:inside",!1),e.off("mousemove.hover_manager")},t.prototype.show_popup=function(e,r){var n,i,o,s,a,u,l,c;if(typeof(n=document.body).contains=="function"&&n.contains(e[0])&&this.current_popup!==r){for(this.el.trigger("i:hide_other_popups",[this]),(u=this.current_popup)!=null&&u.stop().remove(),this.current_popup=r.css({left:"0px",top:"0px"}).removeClass("visible"),c=r.find(".popup_screenshot").removeClass("visible"),w(document.body).append(r),this.position_popup(e,r),_.defer(function(p){return function(){return r.addClass("visible")}}(this)),r.data("trigger_el",e),i=function(p){return function(h){return setTimeout(function(){return h.addClass("visible")},o*100)}}(this),o=s=0,a=c.length;s<a;o=++s)l=c[o],i(w(l));return r.hide().css({opacity:""}).fadeIn("fast"),this.watch_for_popup_close()}},t.prototype.watch_for_popup_close=function(){var e,r;return r=this.trigger_selector+", "+this.popup_selector,e=null,w(document.body).on("click.hover_manager",function(n){return function(i){var o;if(o=w(i.target),!o.closest(r).length)return n.close_popup()}}(this)),w(window).on("mousemove.hover_manager",_.throttle(function(n){return function(i){var o;if(o=w(i.target).closest(r),o.length){e&&(window.clearTimeout(e),e=null);return}if(!e)return e=window.setTimeout(function(){return n.close_popup()},n.close_timeout)}}(this),50))},t.prototype.position_popup=function(e,r){var n,i,o,s,a,u,l;return o=e.offset(),l=r.outerWidth(!0),n=r.outerHeight(!0),r.removeClass("on_right"),s=e.outerHeight(),a=e.outerWidth(),u=o.top+(s-n)/2,i=o.left-l,i<0?(i=o.left+a,i+=this.x_offset,r.addClass("on_right")):i-=this.x_offset,r.css({top:Math.floor(u)+"px",left:Math.floor(i)+"px"})},t.prototype.close_popup=function(){var e;return w(window).off("mousemove.hover_manager"),w(document.body).off("click.hover_manager"),(e=this.current_popup)!=null&&e.stop(!0).remove(),this.current_popup=null},t}(),bt=I.GamePopup=function(){function t(e){this.el=w(e),this.el.dispatch("click",{watch_trailer_btn:function(r){return I.event("grid",I.page_name(),"watch_trailer"),I.Lightbox.open_remote(r.data("lightbox_url"))}})}return t}(),xt=I.WatchTrailerLightbox=function(){function t(e){this.el=w(e),this.el.dispatch("click",{add_to_collection_btn:function(r){return function(n){return I.event("grid","trailer","add_to_collection"),I.current_user?I.Lightbox.open_remote(n.attr("href"),ke):"continue"}}(this)})}return t}(),H=window._,oe=[].slice,se=S.ConversionTracker||(S.ConversionTracker=function(){function t(){}return t.types={impression:1,click:2,purchase:3,download:4,join:5},t.buffer=[],t.find_click=function(e){var r,n,i,o,s,a;for(a=new RegExp(":"+e+"$"),r=this.get_cookie(),i=0,s=r.length;i<s;i++)if(o=r[i],n=H.isArray(o)?o[0]:o,n.match(a))return o},t.strip_click=function(e){var r,n,i,o,s,a;return s=new RegExp(":"+e+"$"),r=this.get_cookie(),a=0,o=function(){var u,l,c;for(c=[],u=0,l=r.length;u<l;u++){if(i=r[u],n=H.isArray(i)?i[0]:i,n.match(s)){a+=1;continue}c.push(i)}return c}(),o.length===r.length?0:(this.write_cookie(o),a)},t.after_click_action=function(e,r){var n,i,o,s;if(n=this.find_click(r),!!n)return s=null,o=H.isArray(n)?(s=n[1],n[0]):n,i=o.replace(/^\d+/,this.types[e]),this.strip_click(r),this.push(i,s),!0},t.download=function(e){return this.after_click_action("download",e)},t.purchase=function(e){return this.after_click_action("purchase",e)},t.join=function(e){return this.after_click_action("join",e)},t.click=function(e){var r,n,i,o,s,a;i=this.types.click+":"+e,o=(a=this.get_active_splits())?[i,a]:i,this.push(i);try{for(n=function(){var u,l,c,p;for(c=this.get_cookie(),p=[],u=0,l=c.length;u<l;u++)r=c[u],s=H.isArray(r)?r[0]:r,s!==i&&p.push(r);return p}.call(this),n.push(o);n.length>100;)n.shift();return this.write_cookie(n),!0}catch(u){}},t.write_cookie=function(e){return S.set_cookie("itchio_ca",JSON.stringify(e),{expires:1})},t.get_cookie=function(){var e;if(e=window.Cookies.get("itchio_ca"),e)try{return JSON.parse(e)||[]}catch(r){try{return JSON.parse(decodeURIComponent(e))||[]}catch(n){return[]}}else return[]},t.flush_later=function(){return this.flush_later=H.throttle(this.flush_now,2e3,{leading:!1}),$(window).on("beforeunload",function(e){return function(){e.flush_now()}}(this)),this.flush_later()},t.encode_buffer=function(e){var r,n,i,o,s,a,u,l,c,p,h,v,g,y,x;for(e==null&&(e=oe.call(this.buffer)),e.sort(),h=[],u=null,a=null,s=null,i=0,l=e.length;i<l;i++)n=e[i],g=n.match(/^(\d+):(\d+):(\d+):(\d+)$/),r=g[0],x=g[1],y=g[2],p=g[3],c=g[4],x&&(x!==u&&(h.push("t"+x),u=x),y!==a&&(h.push("s"+y),a=y),p!==s&&(h.push("o"+p),s=p),o=(+c).toString(36),v=String.fromCharCode("A".charCodeAt(0)+o.length),h.push(""+v+o));return h.join("")},t.get_active_splits=function(){return S.active_splits},t.flush_url=function(e){var r,n,i;return i=this.encode_buffer(),r=[{name:"x",value:i}],(n=e||this.get_active_splits())&&r.push({name:"s",value:n.join(",")}),S.root_url("ca.gif")+"?"+$.param(r)},t.flush_now_beacon=function(e){var r;if(navigator.sendBeacon==null)return this.flush_now(e);if(this.buffer.length)if(S.in_dev&&console.debug.apply(console,["ca(beacon)"].concat(oe.call(H.compact([this.buffer,e])))),r=this.flush_url(e),navigator.sendBeacon(r))this.buffer=[];else return this.flush_now();return $.when()},t.flush_now=function(e){var r;return this.buffer.length?(S.in_dev&&console.debug.apply(console,["ca"].concat(oe.call(H.compact([this.buffer,e])))),r=this.flush_url(e),this.buffer=[],$.Deferred(function(n){return function(i){var o,s;return s=new Image,s.src=r,o=function(){return i.resolve()},s.onerror=o,s.onload=o}}(this))):$.when()},t.push=function(e,r){var n;return this.buffer=function(){var i,o,s,a;for(s=this.buffer,a=[],i=0,o=s.length;i<o;i++)n=s[i],n!==e&&a.push(n);return a}.call(this),this.buffer.push(e),this.buffer.length>50||r?this.flush_now(r):this.flush_later()},t}()),Ie,$e,Q=function(t,e){return function(){return t.apply(e,arguments)}};Ie=0,$e=function(){return"game_grid_"+Ie++},I.GameGridSizer=function(){t.prototype.container_selector=!1,t.prototype.expected_size=315,t.prototype.aspect_ratio=315/250,t.prototype.cell_margin=10,t.prototype.min_columns=1,t.initialize=_.once(function(){var e,r,n;return e=w(document.body),r=_.debounce(function(){return e.addClass("disable_hover")},200,!0),n=_.debounce(function(){return e.removeClass("disable_hover")},200),w(window).on("scroll resize",function(){r(),n()})});function t(e){e==null&&(e={}),w.extend(this,e),this.size_callbacks=[],this.constructor.initialize(),w(window).on("resize",_.debounce(function(r){return function(){return r.resize_cells()}}(this),200)),this.resize_cells(),I.in_test||_.defer(function(r){return function(){return r.resize_cells()}}(this))}return t.prototype.get_cell_margin=function(){return typeof this.cell_margin=="function"?this.cell_margin():this.cell_margin},t.prototype.get_expected_size=function(){return typeof this.expected_size=="function"?this.expected_size():this.expected_size},t.prototype.on_size=function(e){return this.size_callbacks.push(e)},t.prototype.available_width=function(){var e,r,n,i;return this.el?(e=(i=this.el[0])!=null?i.getBoundingClientRect().width:void 0,n=e-Math.floor(e),r=Math.floor(this.el.width()),n>0&&(r-=1),r):w(window).width()},t.prototype.resize_cells=function(){var e,r,n,i,o,s,a,u,l,c,p,h,v,g;for(i=this.get_expected_size(),r=this.get_cell_margin(),h=i+r,c=this.available_width()+r,l=c/h,p=Math.ceil(l),p<this.min_columns&&(p=this.min_columns),u=c/p-r,a=u/this.aspect_ratio,u=Math.floor(u),a=Math.floor(a),this.cells_per_row=p,this._style&&(this._style.remove(),this._style=null),n="",this.container_selector&&(n+=this.container_selector+` {
  --itchio_grid_gap: `+r+`px;
  --itchio_grid_cell_width: `+u+`px;
  --itchio_grid_cell_columns: `+p+`;
  grid-template-columns: repeat(`+p+", "+u+`px);
}`),n!==""&&(this._style=w("<style itchio-grid-sizer type='text/css'>"+n+"</style>").appendTo(w("head"))),v=this.size_callbacks,g=[],o=0,s=v.length;o<s;o++)e=v[o],g.push(e(this,u,a));return g},t}(),I.GameCells=function(){function t(e){this.setup_game_tools=Q(this.setup_game_tools,this),this.el=w(e),this.setup_game_tools(),this.setup_gifs()}return t.prototype.setup_game_tools=function(){return this.el.dispatch("click",{add_to_collection_btn:function(e){return function(r){return I.event("grid",I.page_name(),"add_to_collection"),I.current_user?Je.open_remote(r.attr("href"),ke):"continue"}}(this)})},t.prototype.setup_gifs=function(){return this.el.on("mouseenter",".game_cell",function(e){return function(r){var n,i;if(n=w(r.currentTarget),!n.data("grid_hovered")&&(n.data("grid_hovered",!0),i=n.find(".gif_overlay"),!!i.length))return i.css("background-image","url("+i.data("gif")+")")}}(this))},t}(),I.GameGrid=function(){function t(e,r){var n,i,o,s,a;if(r==null&&(r={}),this.refresh_images=Q(this.refresh_images,this),this.add_image_loading=Q(this.add_image_loading,this),this.setup_conversion_tracking=Q(this.setup_conversion_tracking,this),this.el=w(e),w.extend(this,r),this.setup_lazy_images(),this.show_popups!==!1&&new ft(this.el),new I.GameCells(this.el),!this.sizer&&this.sizer!==!1){for(n=["container_selector","expected_size","min_columns","cell_margin"],this.el[0]&&!this.el[0].id&&(this.el[0].id=$e()),a={el:this.el,container_selector:"#"+this.el[0].id},o=0,s=n.length;o<s;o++)i=n[o],i in r&&(a[i]=r[i]);this.sizer=new I.GameGridSizer(a),this.sizer.on_size(function(u){return function(){return u.el.trigger("i:grid_resize"),u.el.lazy_images()}}(this))}}return t.prototype.setup_lazy_images=function(){return _.defer(function(e){return function(){return e.add_image_loading()}}(this))},t.prototype.setup_conversion_tracking=function(e){return this.el.on("i:impression",function(r){return function(n){var i,o;if(i=w(n.target).closest("[data-game_id]"),o=i.data("game_id"),!!o)return se.push("1:"+e+":1:"+o)}}(this)),this.el.on("i:delegate_tracking",function(r){return function(n,i){var o;if(o=w(n.target).closest("[data-game_id]").data("game_id"),!!o)return se.click(e+":1:"+o),i(se.flush_now())}}(this))},t.prototype.add_image_loading=function(){return this.el.lazy_images({show_item:function(e){return function(r){return r.trigger("i:impression"),r.find(".image_loading").addBack(".image_loading").removeClass("image_loading")}}(this)})},t.prototype.refresh_images=function(){var e;return typeof(e=this.el.data("lazy_images"))=="function"?e():void 0},t}();var ae=function(t,e){return function(){return t.apply(e,arguments)}},dt=S.HoverManager=function(){t.prototype.default_opts={timeout:1e3,enter_timeout:150,fade_timeout:400,show:function(){},hide:function(){},after_fade:function(){}};function t(e){this._clear_enter_timeout=ae(this._clear_enter_timeout,this),this._clear_fade_timeout=ae(this._clear_fade_timeout,this),this._clear_leave_timeout=ae(this._clear_leave_timeout,this),this.opts=$.extend({},this.default_opts,e),this.open=!1}return t.prototype.enter=function(){if(!this.enter_timeout)return this._clear_leave_timeout(),this._clear_fade_timeout(),this.enter_timeout=window.setTimeout(function(e){return function(){var r;return delete e.enter_timeout,e.open||typeof(r=e.opts).show=="function"&&r.show(),e.open=!0}}(this),this.opts.enter_timeout)},t.prototype.leave=function(){if(!this.leave_timeout)return this._clear_enter_timeout(),this.leave_timeout=window.setTimeout(function(e){return function(){return delete e.leave_timeout,e.hide()}}(this),this.opts.timeout)},t.prototype.hide=function(){var e;return this._clear_enter_timeout(),this._clear_leave_timeout(),this.open&&typeof(e=this.opts).hide=="function"&&e.hide(),this.open=!1,this.hiding=!0,this.fade_timeout=window.setTimeout(function(r){return function(){var n;return typeof(n=r.opts).after_fade=="function"&&n.after_fade(),r.hiding=!1}}(this),this.opts.fade_timeout)},t.prototype.show=function(){var e;return typeof(e=this.opts).show=="function"?e.show():void 0},t.prototype._clear_leave_timeout=function(){if(this.leave_timeout)return window.clearTimeout(this.leave_timeout),delete this.leave_timeout},t.prototype._clear_fade_timeout=function(){if(this.fade_timeout)return window.clearTimeout(this.fade_timeout),delete this.fade_timeout},t.prototype._clear_enter_timeout=function(){if(this.enter_timeout)return window.clearTimeout(this.enter_timeout),delete this.enter_timeout},t}(),pt=function(t,e){return function(){return t.apply(e,arguments)}};I.Header=function(){t.prototype.track_category="header";function t(e){this.setup_browse_menu=pt(this.setup_browse_menu,this),this.el=w(e),I.tracked_links(this.el,this.track_category,"click"),this.el.on("click",".menu_tick",function(r){return function(n){var i,o,s;if(!w(n.target).closest(".drop_menu").length)return s=w(n.currentTarget),o=s.closest(".drop_menu_wrap").toggleClass("open"),i=w(document.body),o.is(".open")?(s.trigger("i:track_link"),i.on("click.drop_menu",function(a){if(!w(a.target).closest(o).length)return o.removeClass("open"),i.off("click.drop_menu")})):i.off("click.drop_menu")}}(this)),this.setup_browse_menu()}return t.prototype.setup_browse_menu=function(){var e;return e=this.el.find(".browse_btn"),this.browse_menu=new dt({timeout:750,enter_timeout:100,show:function(r){return function(){return r.el.addClass("hover_menu_open"),e.addClass("open"),setTimeout(function(){return r.el.addClass("hover_menu_visible")},0)}}(this),hide:function(r){return function(){return e.removeClass("open"),r.el.removeClass("hover_menu_visible")}}(this),after_fade:function(r){return function(){return r.el.removeClass("hover_menu_open")}}(this)}),w(document.body).on("click",function(r){return function(n){var i;i=w(n.target).closest(".browse_btn, .header_dropdown"),!i.length&&r.browse_menu.hide()}}(this)),this.el.on("mouseenter mouseleave",".browse_btn, .header_dropdown",function(r){return function(n){return n.type==="mouseenter"?r.browse_menu.enter():r.browse_menu.leave()}}(this))},t}();var Z,ue,B,Ce,le,ce,ee,Re,q,Te=[].slice,ze={}.hasOwnProperty;q={},ee={},Z="en",B=(Re=window.itchio_locale)!=null?Re:Z,Ce=window.requestAnimationFrame||_.defer,le=function(t,e,r){var n,i,o,s,a,u,l;for(o=0,s=e.length;o<s;o++)if(a=e[o],_.isString(a))t.push(a);else if(a[0]==="v")l=r[a[1]],l||console.warn("i18n: failed to find value for variable "+a[1]),t.push(l);else if(a[0]==="t"){if(i=r[a[1]],typeof i!="function")throw new Error("i18n: tried to interpolate tag without function: "+a[1]);n=a[2],u=[],le(u,n||[],r),t.push(i(u.join("")))}else throw new Error("i18n: unknown interpolation node: "+JSON.stringify(a));return t},ce=function(t,e){var r,n,i,o;return _.isString(t)?t:(n=function(){var s,a,u;for(u=[],s=0,a=t.length;s<a;s++)if(i=t[s],_.isString(i))u.push(i);else if(i[0]==="v")o=e[i[1]],o||console.warn("i18n: failed to find value for variable "+i[1]),u.push(o);else if(i[0]==="t"){if(r=e[i[1]],typeof r!="function")throw new Error("i18n: tried to interpolate tag without function: "+i[1]);u.push(r(ce(i[2],e)))}else throw new Error("i18n: unknown interpolation node: "+JSON.stringify(i));return u}(),n.length>1?React.createElement.apply(React,[React.Fragment,{}].concat(Te.call(n))):n.length===0?null:n)},ue=function(){t._cache={},t.for_locale=function(e){var r;return(r=this._cache)[e]||(r[e]=new t(e))};function t(e){this.locale=e,this.last_fetch=null,this.next_fetch=null}return t.prototype.fetch=function(e,r){return this.next_fetch?(this.next_fetch=this.next_fetch.concat(e),this.last_fetch):(this.next_fetch=e,this.last_fetch=$.Deferred(function(n){return function(i){return Ce(function(){var o,s;if(!window.itchio_translations_url){console.error("missing translations url: itchio_translations_url");return}return o=n.next_fetch,s=$.get(window.itchio_translations_url,{locale:n.locale,prefixes:n.next_fetch.join(",")}),n.next_fetch=null,s.done(function(a){var u,l;for(u in a)ze.call(a,u)&&(l=a[u],!r[u]&&(r[u]=l));return i.resolve()})})}}(this)))},t}(),I.i18n={Preloader:ue,get_translations:function(){return q},get_cache:function(){return ee},get_locale:function(){return B},locale_is_english:function(){return B==="en"},insert:function(t){var e,r,n;r=[];for(e in t)ze.call(t,e)&&(n=t[e],!q[e]&&r.push(q[e]=n));return r},set_locale:function(t){return B=t,q={},ee={}},render_string:function(t,e,r){var n;if(_.isString(e))return r&&console.warn("i18n: provided variables to translation string with no interpolation: "+t),e;if(n=[],!r)throw new Error("i18n: tried to interpolate "+t+" without variables");return le(n,e,r),n.join("")},t:function(t,e){return I.i18n.fetch_key(t).then(function(r){return function(n){return I.i18n.render_string(t,n,e)}}(this))},t_sync:function(t,e){var r;if(r=I.i18n.fetch_key_sync(t),!r)throw new Error("i18n: failed to fetch key sync: "+t);return I.i18n.render_string(t,r,e)},fetch_key_sync:function(t){return B==="debug"?"[["+t+"]]":q[t]},fetch_key:function(t){var e,r;if(B==="debug")return $.when("[["+t+"]]");if(e=t.split("."),e.pop(),!e.length)throw new Error("i18n: empty prefix");return r=e.join("."),I.i18n.preload(r).then(function(n){return function(){var i;if(i=q[t],i)return i;if(B===Z)throw new Error("i18n: failed to find key: "+t);return I.i18n.preload(r,Z).then(function(){if(i=q[t],!i)throw new Error("i18n: failed to find key: "+t);return i})}}(this))},preload:function(t,e){var r,n,i,o,s,a,u;if(e==null&&(e=B),e!=="debug"){if(r=ee,_.isString(t)&&(t=[t]),u=function(){var l,c,p;for(p=[],l=0,c=t.length;l<c;l++)a=t[l],r[e]||(r[e]={}),!r[e][a]&&p.push(a);return p}(),n=function(){var l,c,p,h;for(h=[],l=0,c=t.length;l<c;l++)a=t[l],((p=r[e][a])!=null?p.state():void 0)==="pending"&&h.push(r[e][a]);return h}(),!u.length)return $.when.apply($,n);for(i=ue.for_locale(e).fetch(u,q),o=0,s=u.length;o<s;o++)a=u[o],r[e][a]||(r[e][a]=i);return n.length?$.when.apply($,[i].concat(Te.call(n))):i}},react_class:function(t){return createReactClass({displayName:"i18n:"+t,getInitialState:function(){var e;return e=function(){var r;return(r=I.i18n.fetch_key_sync(t))?{text:r}:null},e.isReactClassApproved=!0,e}(),componentWillUnmount:function(){return this.unmounted=!0},componentDidMount:function(){if(!(this.state&&this.state.text))return I.i18n.fetch_key(t).done(function(e){return function(r){if(!e.unmounted)return e.setState({text:r})}}(this))},render:function(){return this.state?_.isString(this.state.text)?this.state.text:ce(this.state.text,this.props):"\u2026"}})}};var kt=_e(ge()),M=window.React,je=window.ReactDOM,V=window.ReactDOMFactories,ht=window.ReactTransitionGroup,L=window.PropTypes,F=window.classNames,A=window.R;M||S.libs.react.done(function(){return M=window.React,je=window.ReactDOM,V=window.ReactDOMFactories,ht=window.ReactTransitionGroup,L=window.PropTypes,F=window.classNames,A=window.R});var te=null;S.libs.react.done(function(){var t,e;return t=V,e=t.img,te=function(r){var n,i,o,s,a;return r==null&&(r={}),a=(i=r.width)!=null?i:24,n=(o=r.height)!=null?o:a,M.createElement("svg",{className:"svgicon icon_close",strokeLinecap:"round",stroke:"currentColor",role:"img",version:"1.1",viewBox:"0 0 24 24",strokeWidth:(s=r.stroke_width)!=null?s:"2",width:a,height:n,strokeLinejoin:"round","aria-hidden":!0,fill:"none"},M.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),M.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))},te=M.createElement.bind(null,M.memo(te))});var Se=null,_t=null;I.libs.react.done(function(){var t,e,r,n,i,o,s,a;return t=V,e=t.a,i=t.div,r=t.button,s=t.label,o=t.h2,a=t.p,n=null,Se=A.component("Lightbox",{is_modal_dialog:function(){var u;return u=document.getElementById("lightbox_container"),u!=null?u.contains(this.container_ref.current):void 0},getInitialState:function(){return{}},componentDidMount:function(){if(this.is_modal_dialog())return n?console.warn("A dialog already has the focus trap"):(this.detect_focus=function(u){return function(l){var c;if(c=u.container_ref.current,c&&"contains"in c&&!(c===l.target||c.contains(l.target)))return c.focus()}}(this),$(document.body).on("focusin",this.detect_focus),n=this),this.setState({previously_focused:document.activeElement,is_modal_dialog:!0},function(){return _.defer(function(u){return function(){var l;return(l=u.container_ref.current)!=null?l.focus():void 0}}(this))})},componentWillUnmount:function(){var u;return this.detect_focus&&($(document.body).off("focusin",this.detect_focus),n=null,delete this.detect_focus),(u=this.state.previously_focused)!=null?u.focus():void 0},render:function(){return i({className:classNames("lightbox",this.props.className),style:this.props.style,role:this.state.is_modal_dialog?"dialog":void 0,"aria-modal":this.state.is_modal_dialog?"true":void 0,tabIndex:this.state.is_modal_dialog?-1:void 0,ref:this.container_ref||(this.container_ref=React.createRef())},this.props.close!==!1?r({className:"close_button",type:"button","aria-label":"Close Dialog"},te({width:18})):void 0,this.props.children)}}),_t=A.component("ErrorLightbox",{propTypes:{title:L.string,errors:L.array.isRequired},render:function(){return A.Lightbox({className:classNames(this.enclosing_class_name(),"compact")},o({},this.props.title||"Your request could not be completed"),A.Forms.FormErrors({title:!1,errors:this.props.errors}),a({className:"buttons"},r({className:"button",type:"button",onClick:function(u){return function(){return I.Lightbox.close()}}(this)},"Close")))}})});var Le;Le=function(t){var e,r,n,i,o,s,a,u,l,c,p,h,v,g,y;return l=ReactDOMFactories.table,h=ReactDOMFactories.thead,c=ReactDOMFactories.tbody,y=ReactDOMFactories.tr,p=ReactDOMFactories.td,e=ReactDOMFactories.abbr,n=ReactDOMFactories.details,u=ReactDOMFactories.summary,i=ReactDOMFactories.div,o=ReactDOMFactories.h2,r=ReactDOMFactories.code,a=ReactDOMFactories.pre,s=ReactDOMFactories.p,v=t.query_log.length,g=t.query_log.reduce(function(x,k){return x+k[1]},0),Se({className:"compact perf_query_log_widget",style:{width:"100%",maxWidth:"800px"}},o({},"Query log"),s({style:{margin:"0 10px"}},"Queries: ",r({},v),", Time: ",r({},(g*1e3).toFixed(2)+"ms")),i({style:{padding:"10px"}},l({className:"nice_table",style:{width:"100%"}},h({},y({},p({},"Query"),p({},"Timing"))),c({},t.query_log.map(function(x){return function(k,z){var C,f,d;return C=k[0],d=k[1],f=d*1e3,y({key:z},p({},n({},u({},r({style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"600px"}},C)),a({style:{whiteSpace:"pre-wrap"}},C))),p({},r({style:{fontWeight:f>10?"bold":void 0,color:f>100?"white":f>50?"red":void 0,backgroundColor:f>100?"red":void 0}},f.toFixed(2)+"ms")))}}(this))))))},I.PerfPanel=function(){function t(e){var r;e.layout_time||(e.layout_time=0),e.view_time||(e.view_time=0),e.db_time||(e.db_time=0),e.db_count||(e.db_count=0),r=_.template(`<div class="perf_panel">
  <div class="stat_row">
    <strong>Queries:</strong> {{ db_count }}
  </div>

  <div class="stat_row">
    <strong>Query time:</strong> {{ Math.floor(db_time * 1000) }}ms
  </div>

  <div class="stat_row">
    <strong>View time:</strong> {{ Math.floor((view_time + layout_time) * 1000) }}ms
  </div>

  <div class="stat_row">
    <strong>Rest:</strong> {{ Math.floor((total_time - (view_time + layout_time + db_time)) * 1000) }}ms
  </div>

</div>`),this.data=e,this.el=$(r(e)).appendTo(document.body),this.el.on("click",function(n){return function(){return n.render_queries()}}(this))}return t.prototype.render_queries=function(){var e,r,n;if(this.data.query_log)return r=function(){var i,o,s,a,u;for(s=this.data.query_log,u=[],i=0,o=s.length;i<o;i++)a=s[i],e=a[0],n=a[1],u.push({query:e,time:n*1e3});return u}.call(this),console.table(r),I.add_react().done(function(i){return function(){if(typeof R!="undefined"&&R!==null&&R.Lightbox)return I.Lightbox.open(Le({query_log:i.data.query_log}))}}(this))},t}(),I.SaleList=function(){function t(e){this.el=$(e),this.el.lazy_images({})}return t}();var re,Me,X=function(t,e){return function(){return t.apply(e,arguments)}},fe=[].slice,De=function(t,e){for(var r in e)gt.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},gt={}.hasOwnProperty;I.prepare_upload=function(t,e,r,n){return $.ajax({url:t+"/upload/prepare",type:"post",data:I.with_csrf(e),success:function(i){return function(o){return o.errors?typeof n=="function"?n(o.errors.join(",")):void 0:typeof r=="function"?r(o):void 0}}(this),error:function(i){return function(o){return typeof n=="function"?n("Server error"):void 0}}(this)})},Me=function(t){var e,r,n,i,o;return e=new DataView(t,0,5),n=e.getUint8(0,!0),i=e.getUint8(1,!0),r=n.toString(16)+i.toString(16),o={8950:"image/png",4749:"image/gif","424d":"image/bmp",ffd8:"image/jpeg"},o[r]},re="You selected an image type we don't recognize. It's possible it has the wrong file extension for the format it is saved as. Please use an image editing program to convert it to a PNG, JPEG, or GIF.",I.test_image_format=function(t){return $.Deferred(function(e){return function(r){var n;return window.FileReader?(n=new FileReader,n.readAsArrayBuffer(t),n.onerror=function(){return r.reject("Failed to read image from disk")},n.onload=function(){var i;return i=Me(n.result),i==="image/bmp"?r.reject("You selected a BMP file that has a wrong extension. Please use an image editing program to convert it to a PNG, JPEG, or GIF."):i?r.resolve():r.reject(re)}):r.resolve()}}(this))},I.image_dimensions=function(t){return $.Deferred(function(e){var r,n;return n=typeof URL!="undefined"&&URL!==null&&typeof URL.createObjectURL=="function"?URL.createObjectURL(t):void 0,n?(r=new Image,r.src=n,r.onload=function(){return e.resolve([r.width,r.height])},r.onerror=function(){return e.reject(re)}):e.reject(re)})},I.video_dimensions=function(t){return $.Deferred(function(e){var r,n;return n=document.createElement("video"),r=typeof URL!="undefined"&&URL!==null&&typeof URL.createObjectURL=="function"?URL.createObjectURL(t):void 0,r?(n.src=r,n.onloadedmetadata=function(){return e.resolve([n.videoWidth,n.videoHeight])},n.onerror=function(){return e.reject("Invalid video file")}):e.reject("Invalid video file")})},I.test_image_dimensions=function(t,e,r){return e==null&&(e=3840),r==null&&(r=2160),I.image_dimensions(t).then(function(n){return function(i){var o,s;return s=i[0],o=i[1],$.Deferred(function(a){return s>e||o>r?a.reject("Image is greater than the maximum dimensions of "+e+"x"+r+" (you selected a "+s+"x"+o+" image)"):a.resolve()})}}(this))},I.Upload=function(){t.prototype.error_message="There was a problem completing your upload. Try again. If the problem persists contact support.",t.prototype.label="file",t.prototype.kind="upload";function t(e,r,n){this.editor=e,this.file=r,this.opts=n,this.start_xhr_upload=X(this.start_xhr_upload,this),this.decrement=X(this.decrement,this),this.increment=X(this.increment,this),this.save_upload=X(this.save_upload,this)}return t.prototype.upload_params=function(){return{kind:this.kind,filename:this.file.name}},t.prototype.save_upload=function(e){throw"override `save_upload`"},t.prototype.increment=function(){var e,r;if((e=this.constructor).active_uploads||(e.active_uploads=0),this.constructor.active_uploads++,this.constructor.active_uploads===1)return typeof(r=this.opts).start_uploading=="function"?r.start_uploading():void 0},t.prototype.decrement=function(){var e;if(this.constructor.active_uploads--,this.constructor.active_uploads===0)return typeof(e=this.opts).stop_uploading=="function"?e.stop_uploading():void 0},t.prototype.start_xhr_upload=function(e){var r,n,i,o,s;if(!this.upload_data)throw"missing upload data";this.increment(),r=new FormData,i=this.upload_data.post_params;for(n in i)o=i[n],r.append(n,o);return r.append("file",this.file),s=new XMLHttpRequest,s.upload.addEventListener("progress",function(a){return function(u){if(u.lengthComputable)return typeof a.progress=="function"?a.progress(u.loaded,u.total):void 0}}(this)),s.upload.addEventListener("error",function(a){return function(u){return I.event("upload","xhr error",a.kind)}}(this)),s.upload.addEventListener("abort",function(a){return function(u){return I.event("upload","xhr abort",a.kind)}}(this)),s.addEventListener("readystatechange",function(a){return function(u){var l;if(s.readyState===4){if(a.decrement(),Math.floor(s.status/100)===2)return I.event("upload","save",a.kind),typeof a.save_upload=="function"?a.save_upload(a.opts.finish_upload):void 0;if(l="Failed upload.",s.responseXML)try{l=s.responseXML.querySelector("Error Message").innerHTML}catch(c){u=c}else l=s.responseText;return I.event("upload_error","server error "+s.status+": "+l,a.kind),e("error: "+l)}}}(this)),s.open("POST",this.upload_data.action),s.send(r)},t.prototype.start_upload=function(e,r){var n;if(!this.upload_data)return n=function(i){return function(o){return i.error_message=o,typeof i.cancel_upload=="function"&&i.cancel_upload.apply(i,[i].concat(fe.call(arguments))),typeof r=="function"?r.apply(null,[i].concat(fe.call(arguments))):void 0}}(this),this.editor.prepare_upload(function(i){return function(){return I.prepare_upload(i.editor.upload_prefix(),i.upload_params(),function(o){return i.upload_data=o,typeof i.have_upload_data=="function"&&i.have_upload_data(),i.start_xhr_upload(n)},n)}}(this),n)},t}();var It=I.ImageUpload=function(t){De(e,t);function e(){return this.save_url=X(this.save_url,this),e.__super__.constructor.apply(this,arguments)}return e.prototype.success_params={},e.prototype.kind="image",e.prototype.label="image",e.prototype.save_url=function(){return this.editor.upload_prefix()+"/image/success/"+this.upload_data.upload_id},e.prototype.save_upload=function(r){if(this.upload_data)return $.ajax({url:this.save_url()+"?"+$.param(this.success_params),type:"post",data:I.with_csrf(),success:function(n){return function(i){var o;if(o=n.success_params.type||n.kind,i.errors){I.event("upload_error",o,i.errors.join(", ")),n.cancel_upload?n.cancel_upload():alert(n.error_message);return}return r.apply(null,[n].concat(fe.call(arguments)))}}(this)})},e.delete_image=function(r,n,i){return $.ajax({url:r.upload_prefix()+"/image/delete/"+n,type:"post",data:I.with_csrf(),success:i})},e}(I.Upload);I.pick_files=function(t){var e;return t==null&&(t={}),e=t.input?$(t.input):($("input.pick_files_input").remove(),$("<input type='file' class='pick_files_input' />").hide().insertAfter("body")),$.Deferred(function(r){return function(n){return t.multiple&&e.attr("multiple",!0),t.accept&&e.attr("accept",t.accept),e.on("change",function(i){var o,s,a,u,l,c,p;for(l=function(){var h,v,g,y;for(g=i.target.files,y=[],h=0,v=g.length;h<v;h++)a=g[h],y.push(a);return y}(),s=[],typeof t.on_pick_files=="function"&&t.on_pick_files(l),c=0,p=l.length;c<p;c++)u=l[c],t.max_size&&u.size>t.max_size&&s.push(["You selected an image greater than the max size "+I.format_bytes(t.max_size)+" (you selected a "+I.format_bytes(u.size)+" file)",u]);if(s.length){n.reject(s,l);return}return t.test_file?(o=l.map(function(h){return $.Deferred(function(v){return t.test_file(h,v),setTimeout(function(){if(n.state()==="pending")return v.reject("Timed out checking file, are you sure it was an image file?")},1e3)}).catch(function(v){throw[v,h]})}),$.when.apply($,o).done(function(h){return n.resolve(l)}).fail(function(h){return n.reject([h])})):n.resolve(l)}),e.click()}}(this))},I.xhr_upload=function(t,e){return $.Deferred(function(r){return function(n){var i,o,s,a,u;i=new FormData,s=e.post_params;for(o in s)a=s[o],i.append(o,a);return i.append("file",t),u=new XMLHttpRequest,u.upload.addEventListener("progress",function(l){if(l.lengthComputable)return n.notify("progress",l.loaded,l.total)}),u.upload.addEventListener("error",function(l){return n.reject("xhr error")}),u.upload.addEventListener("abort",function(l){return n.reject("xhr aborted")}),u.addEventListener("readystatechange",function(l){var c;if(u.readyState===4){if(Math.floor(u.status/100)===2)return n.resolve();if(c="Failed upload.",u.responseXML)try{c=u.responseXML.querySelector("Error Message").innerHTML}catch(p){l=p}else c=u.responseText;return n.reject(c)}}),u.open("POST",e.action),u.send(i)}}(this))},I.upload_image=function(t){return t==null&&(t={}),t.accept||(t.accept="image/png,image/jpeg,image/gif"),t.file_params=function(e){return e.type==="video/mp4"?I.video_dimensions(e).then(function(r){return function(n){var i,o;return o=n[0],i=n[1],{width:o,height:i}}}(this)):I.image_dimensions(e).then(function(r){return function(n){var i,o;return o=n[0],i=n[1],{width:o,height:i}}}(this))},I.upload_file(t)},I.upload_file=function(t){var e,r,n,i,o,s;if(t==null&&(t={}),!t.url)throw new Error("missing url for upload image");return e=t.accept,r=t.max_size,n=t.multiple,i=t.on_pick_files,o=t.on_start_upload,s=t.test_file,I.pick_files({accept:e,max_size:r,multiple:n,test_file:s,on_pick_files:i}).then(function(a){return function(u){var l,c;if(!n&&u.length>1)throw"Got multiple files for single upload";return c=function(){var p,h,v,g;for(v=u.slice(0,6),g=[],p=0,h=v.length;p<h;p++)l=v[p],g.push(function(y){var x;return x=t.file_params?t.file_params(y):{},$.when(x).then(function(k){return function(z){return $.ajax({url:t.url,type:"post",xhrFields:{withCredentials:!0},data:I.with_csrf($.extend({filename:y.name,thumb_size:t.thumb_size,action:"prepare"},z))}).then(function(C){var f;return C.errors?$.Deferred().reject(C.errors):(f=I.xhr_upload(y,C).then(function(){return $.ajax({url:C.success_url,type:"post",xhrFields:{withCredentials:!0},data:I.with_csrf()})}),typeof o=="function"&&o(y,C,f),f)})}}(this))}(l));return g}(),n?$.when.apply($,c):c[0]}}(this))},I.make_upload_button=function(t,e,r,n){var i,o;return n==null&&(n={}),i=null,o=e.data("max_size"),e.on("click",function(s){return function(a){var u,l;return i&&i.remove(),i=$("<input type='file' multiple />").hide().insertAfter(e),(u=e.data("accept"))&&i.attr("accept",u),l=r.prototype.kind,I.event("upload","open",l),i.on("change",function(){var c,p,h,v,g,y;for(g=i[0].files,y=[],h=0,v=g.length;h<v;h++){if(c=g[h],o!=null&&c.size>o){I.flash(c.name+" is greater than max size of "+I.format_bytes(o),"error");continue}p=new r(t,c,n),n.cancel_upload&&(p.cancel_upload=n.cancel_upload),p.start_upload(),typeof n.queue_upload=="function"&&n.queue_upload(p),y.push(I.event("upload","start",l))}return y}),i.insertAfter(e),i.click()}}(this))},I.make_fake_upload_button=function(t,e,r,n){return n==null&&(n={}),e.on("click",function(i){var o;return o=new r(t,{size:851520,name:"The file that I am uploading.zip",type:".zip"},n),o.save_upload=function(s){return o.after_save(),typeof s=="function"?s(this):void 0},o.start_upload=function(s,a){var u,l;return o.upload_data={upload_id:-1},typeof o.have_upload_data=="function"&&o.have_upload_data(),l=0,u=function(){return l+=Math.floor(Math.random()*2e4)+500,l>=o.file.size?typeof o.save_upload=="function"?o.save_upload(n.finish_upload):void 0:(o.progress(l,o.file.size),setTimeout(u,50))},u()},typeof n.queue_upload=="function"&&n.queue_upload(o),o.start_upload()})},I.make_popup_upload_button=function(t,e,r,n){var i,o,s;if(!t.upload_prefix)throw"Upload button parent must have `upload_prefix` method";return o=0,s=function(a){return o+=a,o===0?typeof n.stop_uploading=="function"?n.stop_uploading():void 0:typeof n.start_uploading=="function"?n.start_uploading():void 0},i=function(a){var u,l,c,p,h,v,g;return a.preventDefault(),h=r.prototype.kind,h==="image"&&(h=((l=r.prototype.success_params)!=null?l.type:void 0)||h),v=t.upload_prefix()+("/upload?type="+h),(p=(c=r.prototype.success_params)!=null?c.thumb_size:void 0)&&(v+="&thumb_size="+p),u=G.open_tpl("upload_lightbox",I.UploadLightbox,v,r.prototype.label),g=null,I.event("upload","open",h),u.el.on("i:lightbox_close",function(y){return function(){return $(document).off("i:upload_popup_msg")}}(this)),$(document).on("i:upload_popup_msg",function(y){return function(x,k){switch(k.type){case"save_upload":if(!g)throw"no uploader";return $(document).off("i:upload_popup_msg"),I.event("upload","save",h),s(-1),typeof n.finish_upload=="function"&&n.finish_upload(g,k.data),typeof g.after_save=="function"&&g.after_save(),g=null,u.closable=!0,G.close();case"start_upload":if(g)throw"upload already started";return I.event("upload","start",h),u.closable=!1,u.el.addClass("not_closable"),g=new r(t,{size:k.size,name:k.name},{}),g.upload_data=k.data,typeof g.have_upload_data=="function"&&g.have_upload_data(),typeof n.queue_upload=="function"&&n.queue_upload(g),s(1),typeof g.progress=="function"&&g.progress(1,1),g.start_upload=function(){},g.save_upload=function(){}}}}(this))},e.on("click",function(a){return function(u){return t.prepare_upload?t.prepare_upload(function(){return i(u)}):i(u)}}(this))},I.prepare_download=function(t,e,r){return r==null&&(r={}),I.proxy_downloads&&(r.proxy=!0),$.when($.ajax({url:"/"+t+"/file/"+e+"?"+$.param(r),type:"post",data:I.with_csrf()}),I.add_react()).then(function(n){return function(i){var o,s;return s=i[0],s.errors?(o=s.errors.join(","),I.event("game_download","error",o),G.open(R.ErrorLightbox({errors:s.errors})),$.Deferred().reject(s)):s}}(this))},I.start_download=function(t){return t.url?(_.defer(function(e){return function(){var r,n;if(t.external){window.open(t.url);return}return r=window.location.protocol.match(/^https\b/i),n=r&&!t.url.match(/^https\b/i),n?window.location=t.url:I.is_ios()?window.open(t.url):$('<iframe frameborder="0" style="width: 0; height: 0; visibility: hidden;"></iframe>').attr("src",t.url).appendTo(document.body)}}(this)),!0):!1},I.UploadLightbox=function(t){De(e,t);function e(){return e.__super__.constructor.apply(this,arguments)}return e.prototype.init=function(r,n){if(this.iframe=this.el.find("iframe").attr("src",r),n)return this.el.find(".label").text(n)},e}(G),I.VideoEmbed=function(){function t(e){this.el=$(e),this.el.lazy_images({selector:".video_drop",show_item:function(r){return function(n){return n.replaceWith(n.data("template"))}}(this)})}return t}(),I.libs.react.done(function(){var t,e,r,n,i,o,s;return t=V,r=t.button,o=t.span,n=t.img,e=t.a,i=t.label,s=PropTypes,R("FollowButton",{propTypes:{following:s.bool,show_name:s.bool,name:s.string,login_url:s.string,user_id:s.number,follow_data:s.object,follow_url:s.string.isRequired,unfollow_url:s.string.isRequired},getInitialState:function(){return{following:this.props.following}},getDefaultProps:function(){return{show_name:!0}},componentDidUpdate:function(a,u){if(!u.animate_class&&this.state.animate_class)return this.timer&&(window.clearTimeout(this.timer),delete this.timer),this.timer=setTimeout(function(l){return function(){return l.setState({animate_class:null})}}(this),500)},componentWillUnmount:function(){if(this.timer)return window.clearTimeout(this.timer),delete this.timer},render:function(){var a;return a=this.state.following?this.state.hovering?this.props.show_name?this.tt("misc.follow_button.unfollow_username",{username:this.props.name}):this.tt("misc.follow_button.unfollow"):React.createElement(React.Fragment,{},o({className:"icon icon-checkmark","aria-hidden":!0,role:"img"}),this.props.show_name?this.tt("misc.follow_button.following_username",{username:this.props.name}):this.tt("misc.follow_button.following")):React.createElement(React.Fragment,{},o({className:"icon icon-plus","aria-hidden":!0,role:"img"}),this.props.show_name?this.tt("misc.follow_button.follow_username",{username:this.props.name}):this.tt("misc.follow_button.follow")),this.enclose({component:this.props.login_url?"a":"button",href:this.props.login_url,"data-label":"follow_btn",className:classNames("button",{is_following:this.state.following,disabled:this.state.loading},this.state.animate_class,this.props.className),onMouseEnter:function(u){return function(){return u.setState({hovering:!0})}}(this),onMouseLeave:function(u){return function(){return u.setState({hovering:!1})}}(this),target:this.props.target,onClick:function(u){return function(l){var c,p;if(!u.props.login_url&&!u.state.loading)return l.preventDefault(),c=$(l.target),u.setState({loading:!0,animate_class:null}),u.container().trigger("i:track_link"),p=u.state.following?u.props.unfollow_url:u.props.follow_url,$.post(p,I.with_csrf(u.props.follow_data),function(h){if(h.errors){I.flash(h.errors.join(", ")),u.setState({loading:!1});return}return c.trigger("i:follow_updated",[{user_id:u.props.user_id,following:h.following,btn:c}]),u.setState({following:h.following,animate_class:h.following?"animate_bounce":"animate_drop_down",loading:!1},function(){var v;return typeof(v=u.props).on_follow_change=="function"?v.on_follow_change(u.state.following):void 0})})}}(this)},a)}})});var Ee=null;S.libs.react.done(function(){var t,e;return t=V,e=t.div,Ee=A.component("SlideDown",{getInitialState:function(){return{}},getDefaultProps:function(){return{duration:200,delay:1}},componentDidMount:function(){return this.timer=window.setTimeout(function(r){return function(){var n;return n=r.wrapper_ref.current,r.setState({height:n.scrollHeight||!1}),r.timer=window.setTimeout(function(){return r.setState({animated:!0})},r.props.duration+50),n.scrollTop=0}}(this),this.props.delay)},componentWillUnmount:function(){if(this.timer)return window.clearTimeout(this.timer),delete this.timer},render:function(){var r;return r=this.state.height===!1?null:this.state.height?this.state.animated?null:{height:this.state.height+"px",overflow:"hidden",transition:"height "+this.props.duration/1e3+"s ease"}:{height:0,overflow:"scroll",transition:"height 0.2s ease"},e({style:r,className:this.props.className,ref:this.wrapper_ref||(this.wrapper_ref=M.createRef())},this.props.children)}})});var mt=[].slice,vt=null;I.libs.react.done(function(){var t,e,r,n,i,o,s,a,u,l,c,p,h,v,g,y,x,k,z,C;return r=V,l=r.input,u=r.img,o=r.div,c=r.label,k=r.span,g=r.p,v=r.option,h=r.optgroup,x=r.select,C=r.ul,p=r.li,n=r.button,y=r.section,s=r.form,z=r.strong,a=r.fragment,a=M.createElement.bind(null,M.Fragment),a.type=M.fragment,i=function(f){return function(){return A.component.apply(A,arguments)}}(this),i("CSRF",{pure:!0,render:function(){return l({type:"hidden",name:"csrf_token",value:$("meta[name=csrf_token]").attr("value")})}}),t=function(f){return M.createElement("svg",{className:"svgicon icon_down_tick2",strokeLinecap:"round",stroke:"currentColor",role:"img",version:"1.1",viewBox:"0 0 24 24",strokeWidth:"2",width:"22",height:"22",strokeLinejoin:"round","aria-hidden":!0,fill:"none"},M.createElement("polyline",{points:"6 9 12 15 18 9"}))},t=M.createElement.bind(null,M.memo(t)),e=A.package("Forms"),e("InputRow",{pure:!0,propTypes:{title:L.string,sub:L.any},render:function(){var f;return f=M.createElement(M.Fragment,{},o({className:"label",key:"label"},this.props.title,this.props.sub?k({className:"sub"}," \u2014 ",this.props.sub):void 0),this.props.children),this.props.multi||(f=c({children:f})),o({className:F("input_row",this.props.className),id:this.props.id},f)}}),e("TextInputRow",{pure:!0,propTypes:{title:L.string,sub:L.any,name:L.string.isRequired,value:L.any},focus:function(){return this.input_ref.current.focus()},get_input_el:function(){return this.input_ref.current},get_value:function(){return this.input_ref.current.value},componentDidMount:function(){var f;if(this.props.money_input){if(!this.props.currency)throw new Error("missing currency");I.money_input(this.input_ref.current,{currency:this.props.currency})}if(this.props.slug_input&&I.slug_input($(this.input_ref.current)),this.props.integer_input)return f=/[0-9]/g,$(this.input_ref.current).on("keypress",function(d){return function(m){var b;if(m.keyCode>=32&&(b=String.fromCharCode(m.keyCode),!b.match(f)))return!1}}(this))},render:function(){var f;return f=[o({className:"label",key:"label"},this.props.title,this.props.sub?k({className:"sub"}," \u2014 ",this.props.sub):void 0),l({type:"text",key:"input",name:this.props.name,ref:this.input_ref||(this.input_ref=M.createRef()),value:this.props.value,defaultValue:this.props.defaultValue,onChange:this.props.onChange,onKeyUp:this.props.onKeyUp,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onClick:this.props.onClick,readOnly:this.props.readonly,className:F({has_error:this.props.has_error}),required:this.props.required,placeholder:this.props.placeholder,disabled:this.props.disabled,pattern:this.props.pattern}),this.props.error_message?g({key:"error",className:"input_error"},this.props.error_message):void 0],this.props.multi||(f=c({children:f})),o({className:F("input_row",this.props.className)},f)}}),e("SimpleSelect",{pure:!0,propTypes:{options:L.array.isRequired,name:L.string},getInitialState:function(){return{value:this.props.defaultValue?this.props.defaultValue:void 0}},render:function(){var f,d,m,b,j;return d=this.current_option(),j=this.props.render_current_option,j||(j=function(D){return function(T){return T.short_name||T.name}}(this)),f=[],m=null,b=function(){if(m)return f.push(h.apply(null,[{label:m.label,key:"group-"+f.length}].concat(mt.call(m.children)))),m=null},this.props.options.map(function(D){return function(T,E){var N;return N=v({key:""+E,value:T.value},T.name),T.group?((m!=null?m.label:void 0)!==T.group&&b(),m||(m={label:T.group,children:[]}),m.children.push(N)):(b(),f.push(N))}}(this)),b(),this.enclose({className:F({focused:this.state.focused,disabled:this.props.disabled,has_value:d!==this.props.options[0]})},o({className:"selected_option"},k({className:"selected_option_name"},j(d)),t({})),x({ref:this.select_ref||(this.select_ref=M.createRef()),disabled:this.props.disabled,value:d.value,name:this.props.name,onFocus:function(D){return function(T){return D.setState({focused:!0})}}(this),onBlur:function(D){return function(T){return D.setState({focused:!1})}}(this),onChange:this.on_change,children:f}))},on_change:function(f){var d;return d=f.target.value,this.props.onChange?d===this.props.value?void 0:this.props.onChange(d):d===this.state.value?void 0:this.setState({value:d})},find_option:function(f){var d,m,b,j;for(j=this.props.options,d=0,m=j.length;d<m;d++)if(b=j[d],b.value===f)return b},current_option:function(){var f,d;return d=this.props.value||this.state.value,f=d!=null?this.find_option(d):void 0,f||this.props.options[0]}}),e("Select",{propTypes:{name:L.string.isRequired,value:L.any,options:L.array.isRequired},componentDidMount:function(){var f,d;if(this.props.selectize&&(d=this.props.selectize===!0?{}:this.props.selectize,f=$(this.input_ref.current),f.selectize(d),this.props.onChange))return f.on("change",function(m){return function(b){return m.props.onChange(b)}}(this))},render:function(){return x({ref:this.input_ref||(this.input_ref=M.createRef()),name:this.props.name,onChange:this.props.onChange,value:this.props.value,defaultValue:this.props.defaultValue,children:this.props.options.map(function(f){return function(d){var m,b;return b=d[0],m=d[1],v({key:b,value:b},m||b)}}(this))})}}),e("RadioButtons",{propTypes:{name:L.string.isRequired,value:L.any,options:L.array.isRequired},getValue:function(){var f,d,m,b,j,D;for(b=this.container().find("input").serializeArray(),f=0,d=b.length;f<d;f++)return j=b[f],m=j.name,D=j.value,D},render:function(){return C({className:"radio_list",children:this.props.options.map(function(f){return function(d,m){var b,j,D,T;return T=d[0],b=d[1],D=d[2],j=d[3],p({key:T!=null?T:m,className:F({disabled:j!=null?j.disabled:void 0})},c({},l($.extend({type:"radio",name:f.props.name,value:T,defaultChecked:f.props.defaultValue?T===f.props.defaultValue:void 0,checked:f.props.value!=null?T===f.props.value:void 0,onChange:f.props.onChange},j)),k({className:"radio_label"},b),D?k({className:"sub"}," \u2014 ",D):void 0))}}(this))})}}),e("Slider",{pure:!0,propTypes:{min:L.number,max:L.number,value:L.number,onChange:L.func,disabled:L.bool},getInitialState:function(){return{}},on_change:function(f){return f=Math.round(f),this.props.onChange?this.props.value===f?void 0:this.props.onChange(f):this.state.value===f?void 0:this.setState({value:f})},start_drag:function(f,d){var m,b,j,D;if(!this.props.disabled)return D=this.track_ref.current.clientWidth,b=this.current_value(),this.setState({dragging:!0}),m=function(T){return function(E){var N,P,U,W;if(E.preventDefault(),E.buttons===0){j();return}if(U=E.pageX,W=E.pageX,N=U-f,P=N/D*(T.props.max-T.props.min)+b,P=Math.min(T.props.max,Math.max(T.props.min,P)),P!==T.current_value())return T.on_change(P)}}(this),j=function(T){return function(E){return E!=null&&E.preventDefault(),T.setState({dragging:!1}),document.body.removeEventListener("mousemove",m),document.body.removeEventListener("mouseup",j),delete T.up_listener}}(this),document.body.addEventListener("mousemove",m),document.body.addEventListener("mouseup",j),this.up_listener=j},current_value:function(){return"value"in this.state?this.state.value||this.props.min:this.props.value||this.props.min},percent:function(){return(this.current_value()-this.props.min)/(this.props.max-this.props.min)},componentWillUnmount:function(){if(this.up_listener)return this.up_listener()},render:function(){var f;return f={left:this.percent()*100+"%"},this.enclose({className:F("slider_input",{disabled:this.props.disabled}),onClick:function(d){return function(m){var b,j;if(!d.props.disabled&&m.target!==d.slider_nub_ref.current&&(j=d.track_ref.current.getBoundingClientRect(),g=Math.min(j.width,Math.max(0,m.pageX-j.left))/j.width,b=d.props.min+g*(d.props.max-d.props.min),b=Math.min(d.props.max,Math.max(d.props.min,b)),b!==d.current_value()))return d.on_change(b)}}(this)},this.props.name?l({type:"hidden",name:this.props.name,value:this.current_value()}):void 0,o({ref:this.track_ref||(this.track_ref=M.createRef()),className:"slider_track"},o({className:"slider_fill",style:{width:this.percent()*100+"%"}}),this.state.focused&&this.props.show_tooltip?o({style:f,className:"value_tooltip"},this.current_value()):void 0,n({type:"button",ref:this.slider_nub_ref||(this.slider_nub_ref=M.createRef()),className:F("slider_nub",{disabled:this.props.disabled}),onFocus:function(d){return function(){return d.setState({focused:!0})}}(this),onBlur:function(d){return function(){return d.setState({focused:!1})}}(this),onMouseDown:function(d){return function(m){return d.start_drag(m.pageX,m.pageY)}}(this),onKeyDown:function(d){return function(m){switch(m.keyCode){case 37:d.on_change(Math.max(d.props.min,d.current_value()-1));break;case 39:d.on_change(Math.min(d.props.max,d.current_value()+1));break;default:return}return m.preventDefault()}}(this),style:f})))}}),e("FilterPicker",{pure:!0,componentWillUnmount:function(){return $(window).off("click",this.window_click_listener)},getDefaultProps:function(){return{label_padding:3}},getInitialState:function(){return{open:!1}},close_picker:function(){if(this.state.open)return this.setState({open:!1,popup_visible:!1}),$(window).off("click",this.window_click_listener)},open_picker:function(){var f,d;return f=this.open_button_ref.current,d=f.getBoundingClientRect(),this.window_click_listener&&$(window).off("click",this.window_click_listener),this.window_click_listener=function(m){return function(b){if(i=$(b.target).closest(m.container()),!i.length)return m.close_picker()}}(this),$(window).on("click",this.window_click_listener),this.setState({open:!0,top:-this.props.label_padding,left:-this.props.label_padding,height:d.height+this.props.label_padding*2},function(m){return function(){return m.filter_popup_ref.current.focus(),_.defer(function(){if(m.window_click_listener&&m.state.open)return m.setState({popup_visible:!0})})}}(this))},render:function(){return this.enclose({className:F("filter_picker_widget",{open:this.state.open,popup_visible:this.state.popup_visible}),onKeyDown:this.state.open?function(f){return function(d){if(d.keyCode===27)return f.close_picker()}}(this):void 0},n({type:"button",className:"filter_value",ref:this.open_button_ref||(this.open_button_ref=M.createRef()),onClick:this.state.open?this.close_picker:this.open_picker},k({className:"value_label"},this.props.label),t({})),o({tabIndex:-1,ref:this.filter_popup_ref||(this.filter_popup_ref=M.createRef()),className:"filter_popup",style:{top:(this.state.top||0)+"px",left:(this.state.left||0)+"px"}},o({style:{marginTop:(this.state.height||0)+"px"},className:"filter_options"},this.props.render_children?this.state.open?this.props.render_children():void 0:this.props.children)))}}),e("StarPicker",{pure:!0,getDefaultProps:function(){return{total_stars:5,star_filled:"icon-star",star_empty:"icon-star2"}},getInitialState:function(){return{}},set_value:function(f){var d;return this.props.set_value?this.props.set_value(f):this.setState({value:f}),typeof(d=this.props).on_change=="function"?d.on_change(f):void 0},render:function(){var f,d,m,b,j,D,T;return T=(m=(b=(j=this.props.value)!=null?j:this.state.value)!=null?b:this.props.defaultValue)!=null?m:0,f=this.state.preview_value||T,D=function(){var E,N,P;for(P=[],d=E=1,N=this.props.total_stars;1<=N?E<=N:E>=N;d=1<=N?++E:--E)P.push(function(U){return function(W){var Ne,Pe,de;return Ne=W>f?"star icon "+U.props.star_empty:"star icon "+U.props.star_filled,Pe=T===W,de=W+" Star"+(W===1?"":"s"),n({key:"star-"+W,type:"button",title:de,role:"radio","aria-describedby":U.props["aria-describedby"],"aria-label":de,"aria-checked":Pe?"true":"false",onMouseEnter:function(){return U.setState({preview_value:W})},onMouseLeave:function(){return U.setState({preview_value:null})},onClick:function(){return U.set_value(W)}},k({className:Ne}))}}(this)(d));return P}.call(this),this.enclose({"aria-labelledby":this.props["aria-labelledby"],role:"radiogroup",className:F(this.props.className,{interactive:!0,previewing:this.state.preview_value!=null,has_value:T>0})},this.props.name?l({type:"hidden",name:this.props.name,value:T>0?T:""}):void 0,D)}}),e("EditableInput",{getInitialState:function(){return{value:null,edit_value:null}},componentDidUpdate:function(f){var d;if(d=this.state.value?this.state.value:this.props.value,this.props.value!==d)return this.setState({value:this.props.value,edit_value:null})},confirm_edit:function(){if(this.state.edit_value)return this.setValue(this.state.edit_value)},cancel_edit:function(){return this.setState({edit_value:null})},setValue:function(f){var d;return this.setState({value:f,edit_value:null}),typeof(d=this.props).onUpdate=="function"?d.onUpdate(f):void 0},render:function(){var f;return l({type:(f=this.props.type)!=null?f:"text",className:this.props.className,name:this.props.name,title:this.props.title,readOnly:this.props.readonly,required:this.props.required,placeholder:this.props.placeholder,disabled:this.props.disabled,pattern:this.props.pattern,value:this.state.edit_value!==null?this.state.edit_value:this.state.value!==null?this.state.value:this.props.value,onKeyDown:function(d){return function(m){if(m.keyCode===27&&(d.cancel_edit(),m.stopPropagation()),m.keyCode===13)return d.confirm_edit(),m.stopPropagation()}}(this),onFocus:function(d){return function(m){return m.target.select()}}(this),onBlur:function(d){return function(m){return d.confirm_edit()}}(this),onChange:function(d){return function(m){return d.setState({edit_value:m.target.value})}}(this)})}}),e("FocusButton",{pure:!0,getInitialState:function(){return{focused:!1}},componentWillUnmount:function(){var f;if(this.state.focused)return typeof(f=this.props).on_decrement_focus=="function"?f.on_decrement_focus():void 0},on_focus:function(){var f;return this.setState({focused:!0}),typeof(f=this.props).on_increment_focus=="function"?f.on_increment_focus():void 0},on_blur:function(){var f;return this.setState({focused:!1}),typeof(f=this.props).on_decrement_focus=="function"?f.on_decrement_focus():void 0},render:function(){var f;return f=$.extend({onFocus:this.on_focus,onBlur:this.on_blur},this.props),delete f.on_increment_focus,delete f.on_decrement_focus,n(f)}}),vt=e("FormErrors",{pure:!0,getDefaultProps:function(){return{animated:!1,scroll_into_view:!1}},propTypes:{title:L.string,errors:L.array.isRequired},render:function(){var f;return f=this.props.animated?Ee:y,f({className:F(this.enclosing_class_name(),"form_errors"),role:"alert"},o({ref:this.props.scroll_into_view?function(d){if(d)return typeof d.scrollIntoView=="function"?d.scrollIntoView():void 0}:void 0},this.props.title!==!1?g({},z({},this.props.title||this.tt("misc.forms.form_errors"))):void 0,C({},this.props.errors.map(function(d){return function(m){var b;return b=m==="recaptcha"?"Please complete the CAPTCHA to continue":m,p({key:m},b)}}(this))),this.props.children))}}),e("RecaptchaInput",{propTypes:{sitekey:L.string.isRequired},componentDidMount:function(){return I.with_recaptcha(function(f){return function(){var d;return I.event("recaptcha","show",I.page_name()),d=je.findDOMNode(f),grecaptcha.render(d,{sitekey:f.props.sitekey})}}(this))},render:function(){return o({className:"g-recaptcha"})}}),e("SubmitChallenge",{pure:!0,getInitialState:function(){return{}},solve_deferred:function(){var f,d;return this.props.challenge===this.state.challenge?this.state.deferred:(f=$.Deferred(),d=+new Date,this.setState({challenge:this.props.challenge,solution:null,duration:null,busy:!0,deferred:f}),I.solve_challenge(this.props.challenge).then(function(m){return function(b){return m.setState({busy:!1,duration:new Date-d,solution:b})}}(this)),f)},render:function(){var f;return f=this.state.solution||"",a({},l({type:"hidden",name:"challenge",value:this.props.challenge}),l({key:f,type:"hidden",name:"challenge_response",value:f,ref:function(d){return function(m){var b;if(m&&d.state.solution)return(b=d.state.deferred)!=null?b.resolve():void 0}}(this)}))}})}),I.libs.react.done(function(){})})();
